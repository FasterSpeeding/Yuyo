<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 8.0.0" />
    <title>yuyo API documentation</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%2244.5%202.5%2015%2015%22%3E%3Cpath%20d%3D%22M49.351%2021.041c-.233-.721-.546-2.408-.772-4.076-.042-.09-.067-.187-.046-.288-.166-1.347-.277-2.625-.241-3.351-1.378-1.008-2.271-2.586-2.271-4.362%200-.976.272-1.935.788-2.774.057-.094.122-.18.184-.268-.033-.167-.052-.339-.052-.516%200-1.477%201.202-2.679%202.679-2.679.791%200%201.496.352%201.987.9a6.3%206.3%200%200%201%201.001.029c.492-.564%201.207-.929%202.012-.929%201.477%200%202.679%201.202%202.679%202.679a2.65%202.65%200%200%201-.269%201.148c.383.747.595%201.572.595%202.41%200%202.311-1.507%204.29-3.635%205.107.037.699.147%202.27.423%203.294l.137.461c.156%202.136-4.612%205.166-5.199%203.215zm.127-4.919a4.78%204.78%200%200%200%20.775-.584c-.172-.115-.505-.254-.88-.378zm.331%202.302l.828-.502c-.202-.143-.576-.328-.984-.49zm.45%202.157l.701-.403c-.214-.115-.536-.249-.891-.376l.19.779zM49.13%204.141c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm.735-.389a1.15%201.15%200%200%201%20.314.783%201.16%201.16%200%200%201-1.162%201.162c-.457%200-.842-.27-1.032-.653-.026.117-.042.238-.042.362a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.843-.626-1.535-1.436-1.654zm3.076%201.654a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.037-.009-.072-.011-.109-.21.3-.541.508-.935.508a1.16%201.16%200%200%201-1.162-1.162%201.14%201.14%200%200%201%20.474-.912c-.015%200-.03-.005-.045-.005-.926.001-1.679.754-1.679%201.68zm1.861-1.265c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm1.823%204.823c0-.52-.103-1.035-.288-1.52-.466.394-1.06.64-1.717.64-1.144%200-2.116-.725-2.499-1.738-.383%201.012-1.355%201.738-2.499%201.738-.867%200-1.631-.421-2.121-1.062-.307.605-.478%201.267-.478%201.942%200%202.486%202.153%204.51%204.801%204.51s4.801-2.023%204.801-4.51zm-3.032%209.156l-.146-.492c-.276-1.02-.395-2.457-.444-3.268a6.11%206.11%200%200%201-1.18.115%206.01%206.01%200%200%201-2.536-.562l.006.175c.802.215%201.848.612%202.021%201.25.079.295-.021.601-.274.837l-.598.501c.667.304%201.243.698%201.311%201.179.02.144.022.507-.393.787l-.564.365c1.285.521%201.361.96%201.381%201.126.018.142.011.496-.427.746l-.854.489c.064-1.19%201.985-2.585%202.697-3.248zM49.34%209.925c0-.667%201-.667%201%200%200%20.653.818%201.205%201.787%201.205s1.787-.552%201.787-1.205c0-.667%201-.667%201%200%200%201.216-1.25%202.205-2.787%202.205s-2.787-.989-2.787-2.205zm-.887-7.633c-.093.077-.205.114-.317.114a.5.5%200%200%201-.318-.886L49.183.397a.5.5%200%200%201%20.703.068.5.5%200%200%201-.069.703zm7.661-.065c-.086%200-.173-.022-.253-.068l-1.523-.893c-.575-.337-.069-1.2.506-.863l1.523.892a.5.5%200%200%201%20.179.685c-.094.158-.261.247-.432.247z%22%20fill%3D%22%233bb300%22/%3E%3C/svg%3E"/>


<style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style>/*! pygments syntax highlighting */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.pdoc .hll{background-color:#ffffcc}.pdoc{background:#f8f8f8;}.pdoc .c{color:#408080; font-style:italic}.pdoc .err{border:1px solid #FF0000}.pdoc .k{color:#008000; font-weight:bold}.pdoc .o{color:#666666}.pdoc .ch{color:#408080; font-style:italic}.pdoc .cm{color:#408080; font-style:italic}.pdoc .cp{color:#BC7A00}.pdoc .cpf{color:#408080; font-style:italic}.pdoc .c1{color:#408080; font-style:italic}.pdoc .cs{color:#408080; font-style:italic}.pdoc .gd{color:#A00000}.pdoc .ge{font-style:italic}.pdoc .gr{color:#FF0000}.pdoc .gh{color:#000080; font-weight:bold}.pdoc .gi{color:#00A000}.pdoc .go{color:#888888}.pdoc .gp{color:#000080; font-weight:bold}.pdoc .gs{font-weight:bold}.pdoc .gu{color:#800080; font-weight:bold}.pdoc .gt{color:#0044DD}.pdoc .kc{color:#008000; font-weight:bold}.pdoc .kd{color:#008000; font-weight:bold}.pdoc .kn{color:#008000; font-weight:bold}.pdoc .kp{color:#008000}.pdoc .kr{color:#008000; font-weight:bold}.pdoc .kt{color:#B00040}.pdoc .m{color:#666666}.pdoc .s{color:#BA2121}.pdoc .na{color:#7D9029}.pdoc .nb{color:#008000}.pdoc .nc{color:#0000FF; font-weight:bold}.pdoc .no{color:#880000}.pdoc .nd{color:#AA22FF}.pdoc .ni{color:#999999; font-weight:bold}.pdoc .ne{color:#D2413A; font-weight:bold}.pdoc .nf{color:#0000FF}.pdoc .nl{color:#A0A000}.pdoc .nn{color:#0000FF; font-weight:bold}.pdoc .nt{color:#008000; font-weight:bold}.pdoc .nv{color:#19177C}.pdoc .ow{color:#AA22FF; font-weight:bold}.pdoc .w{color:#bbbbbb}.pdoc .mb{color:#666666}.pdoc .mf{color:#666666}.pdoc .mh{color:#666666}.pdoc .mi{color:#666666}.pdoc .mo{color:#666666}.pdoc .sa{color:#BA2121}.pdoc .sb{color:#BA2121}.pdoc .sc{color:#BA2121}.pdoc .dl{color:#BA2121}.pdoc .sd{color:#BA2121; font-style:italic}.pdoc .s2{color:#BA2121}.pdoc .se{color:#BB6622; font-weight:bold}.pdoc .sh{color:#BA2121}.pdoc .si{color:#BB6688; font-weight:bold}.pdoc .sx{color:#008000}.pdoc .sr{color:#BB6688}.pdoc .s1{color:#BA2121}.pdoc .ss{color:#19177C}.pdoc .bp{color:#008000}.pdoc .fm{color:#0000FF}.pdoc .vc{color:#19177C}.pdoc .vg{color:#19177C}.pdoc .vi{color:#19177C}.pdoc .vm{color:#19177C}.pdoc .il{color:#666666}</style>
<style>/*! pdoc */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f7f7f7;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}body{background-color:var(--pdoc-background);}html, body{width:100%;height:100%;}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}.git-button{display:none !important;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}#navtoggle{display:none;}}#togglestate{display:none;}nav.pdoc{--pad:1.75rem;--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav.pdoc > div > ul > li{padding-left:0;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{--shift:-40px;text-align:right;margin-top:var(--shift);margin-bottom:calc(0px - var(--shift));clear:both;filter:opacity(1);}.pdoc details:not([open]){height:0;overflow:visible;}.pdoc details > summary{font-size:.75rem;cursor:pointer;color:var(--muted);border-width:0;padding:0 .7em;display:inline-block;display:inline list-item;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc details > div{margin-top:calc(0px - var(--shift) / 2);text-align:left;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:3rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{display:block;color:var(--text);margin:1rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}</style>
</head>
<body>        <nav class="pdoc">
            <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
            <input id="togglestate" type="checkbox">
            <div>
                        <a class="pdoc-button module-list-button" href="index.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                            &nbsp;
                            Module Index
                        </a>


                        <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                               pattern=".+" required>


                    <h2>Submodules</h2>
                    <ul>
                            <li><a href="yuyo/asgi.html">yuyo.asgi</a></li>
                            <li><a href="yuyo/backoff.html">yuyo.backoff</a></li>
                            <li><a href="yuyo/components.html">yuyo.components</a></li>
                            <li><a href="yuyo/reactions.html">yuyo.reactions</a></li>
                            <li><a href="yuyo/pagination.html">yuyo.pagination</a></li>
                    </ul>

                    <h2>API Documentation</h2>
                        <ul class="memberlist">
            <li>
                    <a class="variable" href="#__author__">__author__</a>
            </li>
            <li>
                    <a class="variable" href="#__ci__">__ci__</a>
            </li>
            <li>
                    <a class="variable" href="#__copyright__">__copyright__</a>
            </li>
            <li>
                    <a class="variable" href="#__docs__">__docs__</a>
            </li>
            <li>
                    <a class="variable" href="#__email__">__email__</a>
            </li>
            <li>
                    <a class="variable" href="#__issue_tracker__">__issue_tracker__</a>
            </li>
            <li>
                    <a class="variable" href="#__license__">__license__</a>
            </li>
            <li>
                    <a class="variable" href="#__url__">__url__</a>
            </li>
            <li>
                    <a class="variable" href="#__version__">__version__</a>
            </li>
            <li>
                    <a class="module" href="#asgi">asgi</a>
            </li>
            <li>
                    <a class="class" href="#AsgiAdapter">AsgiAdapter</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AsgiAdapter.__init__">AsgiAdapter</a>
                        </li>
                        <li>
                                <a class="variable" href="#AsgiAdapter.server">server</a>
                        </li>
                        <li>
                                <a class="function" href="#AsgiAdapter.add_shutdown_callback">add_shutdown_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#AsgiAdapter.add_startup_callback">add_startup_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#AsgiAdapter.process_lifespan_event">process_lifespan_event</a>
                        </li>
                        <li>
                                <a class="function" href="#AsgiAdapter.process_request">process_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="module" href="#backoff">backoff</a>
            </li>
            <li>
                    <a class="class" href="#Backoff">Backoff</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Backoff.__init__">Backoff</a>
                        </li>
                        <li>
                                <a class="variable" href="#Backoff.is_depleted">is_depleted</a>
                        </li>
                        <li>
                                <a class="function" href="#Backoff.backoff">backoff</a>
                        </li>
                        <li>
                                <a class="function" href="#Backoff.finish">finish</a>
                        </li>
                        <li>
                                <a class="function" href="#Backoff.reset">reset</a>
                        </li>
                        <li>
                                <a class="function" href="#Backoff.set_next_backoff">set_next_backoff</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ErrorManager">ErrorManager</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ErrorManager.__init__">ErrorManager</a>
                        </li>
                        <li>
                                <a class="function" href="#ErrorManager.clear_rules">clear_rules</a>
                        </li>
                        <li>
                                <a class="function" href="#ErrorManager.with_rule">with_rule</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="module" href="#components">components</a>
            </li>
            <li>
                    <a class="class" href="#AbstractComponentExecutor">AbstractComponentExecutor</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#AbstractComponentExecutor.custom_ids">custom_ids</a>
                        </li>
                        <li>
                                <a class="variable" href="#AbstractComponentExecutor.has_expired">has_expired</a>
                        </li>
                        <li>
                                <a class="function" href="#AbstractComponentExecutor.execute">execute</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ActionRowExecutor">ActionRowExecutor</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ActionRowExecutor.__init__">ActionRowExecutor</a>
                        </li>
                        <li>
                                <a class="variable" href="#ActionRowExecutor.components">components</a>
                        </li>
                        <li>
                                <a class="function" href="#ActionRowExecutor.add_component">add_component</a>
                        </li>
                        <li>
                                <a class="function" href="#ActionRowExecutor.add_button">add_button</a>
                        </li>
                        <li>
                                <a class="function" href="#ActionRowExecutor.add_select_menu">add_select_menu</a>
                        </li>
                        <li>
                                <a class="function" href="#ActionRowExecutor.build">build</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#as_child_executor">as_child_executor</a>
            </li>
            <li>
                    <a class="function" href="#as_component_callback">as_component_callback</a>
            </li>
            <li>
                    <a class="class" href="#ChildActionRowExecutor">ChildActionRowExecutor</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ChildActionRowExecutor.__init__">ChildActionRowExecutor</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildActionRowExecutor.add_to_parent">add_to_parent</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ComponentClient">ComponentClient</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ComponentClient.__init__">ComponentClient</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentClient.from_gateway_bot">from_gateway_bot</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentClient.from_rest_bot">from_rest_bot</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentClient.close">close</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentClient.open">open</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentClient.on_gateway_event">on_gateway_event</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentClient.on_rest_request">on_rest_request</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentClient.add_executor">add_executor</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ComponentContext">ComponentContext</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ComponentContext.__init__">ComponentContext</a>
                        </li>
                        <li>
                                <a class="variable" href="#ComponentContext.has_been_deferred">has_been_deferred</a>
                        </li>
                        <li>
                                <a class="variable" href="#ComponentContext.has_responded">has_responded</a>
                        </li>
                        <li>
                                <a class="variable" href="#ComponentContext.interaction">interaction</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentContext.defer">defer</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentContext.create_followup">create_followup</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentContext.create_initial_response">create_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentContext.delete_initial_response">delete_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentContext.delete_last_response">delete_last_response</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentContext.edit_initial_response">edit_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentContext.edit_last_response">edit_last_response</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentContext.fetch_initial_response">fetch_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentContext.fetch_last_response">fetch_last_response</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentContext.respond">respond</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ComponentExecutor">ComponentExecutor</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ComponentExecutor.__init__">ComponentExecutor</a>
                        </li>
                        <li>
                                <a class="variable" href="#ComponentExecutor.callbacks">callbacks</a>
                        </li>
                        <li>
                                <a class="variable" href="#ComponentExecutor.custom_ids">custom_ids</a>
                        </li>
                        <li>
                                <a class="variable" href="#ComponentExecutor.has_expired">has_expired</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentExecutor.execute">execute</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentExecutor.add_callback">add_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentExecutor.with_callback">with_callback</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ComponentPaginator">ComponentPaginator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ComponentPaginator.__init__">ComponentPaginator</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentPaginator.builder">builder</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentPaginator.execute">execute</a>
                        </li>
                        <li>
                                <a class="function" href="#ComponentPaginator.get_next_entry">get_next_entry</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#InteractiveButtonBuilder">InteractiveButtonBuilder</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#InteractiveButtonBuilder.__init__">InteractiveButtonBuilder</a>
                        </li>
                        <li>
                                <a class="variable" href="#InteractiveButtonBuilder.callback">callback</a>
                        </li>
                        <li>
                                <a class="function" href="#InteractiveButtonBuilder.add_to_container">add_to_container</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MultiComponentExecutor">MultiComponentExecutor</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MultiComponentExecutor.__init__">MultiComponentExecutor</a>
                        </li>
                        <li>
                                <a class="variable" href="#MultiComponentExecutor.builders">builders</a>
                        </li>
                        <li>
                                <a class="variable" href="#MultiComponentExecutor.custom_ids">custom_ids</a>
                        </li>
                        <li>
                                <a class="variable" href="#MultiComponentExecutor.executors">executors</a>
                        </li>
                        <li>
                                <a class="variable" href="#MultiComponentExecutor.has_expired">has_expired</a>
                        </li>
                        <li>
                                <a class="function" href="#MultiComponentExecutor.add_builder">add_builder</a>
                        </li>
                        <li>
                                <a class="function" href="#MultiComponentExecutor.add_action_row">add_action_row</a>
                        </li>
                        <li>
                                <a class="function" href="#MultiComponentExecutor.add_executor">add_executor</a>
                        </li>
                        <li>
                                <a class="function" href="#MultiComponentExecutor.execute">execute</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SelectMenuBuilder">SelectMenuBuilder</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SelectMenuBuilder.__init__">SelectMenuBuilder</a>
                        </li>
                        <li>
                                <a class="variable" href="#SelectMenuBuilder.callback">callback</a>
                        </li>
                        <li>
                                <a class="function" href="#SelectMenuBuilder.add_to_container">add_to_container</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#WaitForComponent">WaitForComponent</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#WaitForComponent.__init__">WaitForComponent</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaitForComponent.custom_ids">custom_ids</a>
                        </li>
                        <li>
                                <a class="variable" href="#WaitForComponent.has_expired">has_expired</a>
                        </li>
                        <li>
                                <a class="function" href="#WaitForComponent.wait_for">wait_for</a>
                        </li>
                        <li>
                                <a class="function" href="#WaitForComponent.execute">execute</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="module" href="#reactions">reactions</a>
            </li>
            <li>
                    <a class="function" href="#as_reaction_callback">as_reaction_callback</a>
            </li>
            <li>
                    <a class="class" href="#AbstractReactionHandler">AbstractReactionHandler</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#AbstractReactionHandler.has_expired">has_expired</a>
                        </li>
                        <li>
                                <a class="variable" href="#AbstractReactionHandler.last_triggered">last_triggered</a>
                        </li>
                        <li>
                                <a class="function" href="#AbstractReactionHandler.close">close</a>
                        </li>
                        <li>
                                <a class="function" href="#AbstractReactionHandler.open">open</a>
                        </li>
                        <li>
                                <a class="function" href="#AbstractReactionHandler.on_reaction_event">on_reaction_event</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ReactionHandler">ReactionHandler</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ReactionHandler.__init__">ReactionHandler</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReactionHandler.authors">authors</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReactionHandler.has_expired">has_expired</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReactionHandler.last_triggered">last_triggered</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReactionHandler.timeout">timeout</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionHandler.open">open</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionHandler.close">close</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionHandler.add_callback">add_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionHandler.remove_callback">remove_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionHandler.with_callback">with_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionHandler.on_reaction_event">on_reaction_event</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ReactionPaginator">ReactionPaginator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ReactionPaginator.__init__">ReactionPaginator</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionPaginator.get_next_entry">get_next_entry</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionPaginator.add_author">add_author</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionPaginator.remove_author">remove_author</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionPaginator.close">close</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionPaginator.open">open</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionPaginator.create_message">create_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ReactionClient">ReactionClient</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ReactionClient.__init__">ReactionClient</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReactionClient.blacklist">blacklist</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionClient.from_gateway_bot">from_gateway_bot</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReactionClient.is_closed">is_closed</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionClient.add_handler">add_handler</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionClient.get_handler">get_handler</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionClient.remove_handler">remove_handler</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionClient.close">close</a>
                        </li>
                        <li>
                                <a class="function" href="#ReactionClient.open">open</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="module" href="#pagination">pagination</a>
            </li>
            <li>
                    <a class="function" href="#async_paginate_string">async_paginate_string</a>
            </li>
            <li>
                    <a class="function" href="#sync_paginate_string">sync_paginate_string</a>
            </li>
            <li>
                    <a class="function" href="#paginate_string">paginate_string</a>
            </li>
    </ul>



                    <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
                        built with <span class="visually-hidden">pdoc</span><img
                            alt="pdoc logo"
                            src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
                    </a>
            </div>
        </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
yuyo    </h1>

                        <div class="docstring"><p>A collection of utility functions and classes designed to enhances Hikari.</p>
</div>

                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;A collection of utility functions and classes designed to enhances Hikari.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># /__init__.py</span>
    <span class="s2">&quot;__author__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__ci__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__copyright__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__docs__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__email__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__issue_tracker__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__license__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__url__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__version__&quot;</span><span class="p">,</span>
    <span class="c1"># /asgi.py</span>
    <span class="s2">&quot;asgi&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AsgiAdapter&quot;</span><span class="p">,</span>
    <span class="c1"># /backoff.py</span>
    <span class="s2">&quot;backoff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Backoff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ErrorManager&quot;</span><span class="p">,</span>
    <span class="c1"># /components.py</span>
    <span class="s2">&quot;components&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AbstractComponentExecutor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ActionRowExecutor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_child_executor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_component_callback&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ChildActionRowExecutor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ComponentClient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ComponentContext&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ComponentExecutor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ComponentPaginator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;InteractiveButtonBuilder&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MultiComponentExecutor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SelectMenuBuilder&quot;</span><span class="p">,</span>
    <span class="s2">&quot;WaitForComponent&quot;</span><span class="p">,</span>
    <span class="c1"># /reactions.py</span>
    <span class="s2">&quot;reactions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_reaction_callback&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AbstractReactionHandler&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ReactionHandler&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ReactionPaginator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ReactionClient&quot;</span><span class="p">,</span>
    <span class="c1"># /pagination.py</span>
    <span class="s2">&quot;pagination&quot;</span><span class="p">,</span>
    <span class="s2">&quot;async_paginate_string&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sync_paginate_string&quot;</span><span class="p">,</span>
    <span class="s2">&quot;paginate_string&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">from</span> <span class="nn">.asgi</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.backoff</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.components</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.pagination</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.reactions</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Faster Speeding&quot;</span>
<span class="n">__ci__</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/FasterSpeeding/Yuyo/actions&quot;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot; 2020 Faster Speeding&quot;</span>
<span class="n">__coverage__</span> <span class="o">=</span> <span class="s2">&quot;https://codeclimate.com/github/FasterSpeeding/Yuyo&quot;</span>
<span class="n">__docs__</span> <span class="o">=</span> <span class="s2">&quot;https://yuyo.cursed.solutions/&quot;</span>
<span class="n">__email__</span> <span class="o">=</span> <span class="s2">&quot;lucina@lmbyrne.dev&quot;</span>
<span class="n">__issue_tracker__</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/FasterSpeeding/Yuyo/issues&quot;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;BSD&quot;</span>
<span class="n">__url__</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/FasterSpeeding/Yuyo&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;1.0.3a1&quot;</span>
</pre></div>

        </details>

            </section>
                <section id="__author__">
                                <div class="attr variable"><a class="headerlink" href="#__author__">#&nbsp;&nbsp</a>

        <span class="name">__author__</span><span class="default_value"> = &#39;Faster Speeding&#39;</span>
    </div>

    

                </section>
                <section id="__ci__">
                                <div class="attr variable"><a class="headerlink" href="#__ci__">#&nbsp;&nbsp</a>

        <span class="name">__ci__</span><span class="default_value"> = &#39;https://github.com/FasterSpeeding/Yuyo/actions&#39;</span>
    </div>

    

                </section>
                <section id="__copyright__">
                                <div class="attr variable"><a class="headerlink" href="#__copyright__">#&nbsp;&nbsp</a>

        <span class="name">__copyright__</span><span class="default_value"> = &#39; 2020 Faster Speeding&#39;</span>
    </div>

    

                </section>
                <section id="__docs__">
                                <div class="attr variable"><a class="headerlink" href="#__docs__">#&nbsp;&nbsp</a>

        <span class="name">__docs__</span><span class="default_value"> = &#39;https://yuyo.cursed.solutions/&#39;</span>
    </div>

    

                </section>
                <section id="__email__">
                                <div class="attr variable"><a class="headerlink" href="#__email__">#&nbsp;&nbsp</a>

        <span class="name">__email__</span><span class="default_value"> = &#39;lucina@lmbyrne.dev&#39;</span>
    </div>

    

                </section>
                <section id="__issue_tracker__">
                                <div class="attr variable"><a class="headerlink" href="#__issue_tracker__">#&nbsp;&nbsp</a>

        <span class="name">__issue_tracker__</span><span class="default_value"> = &#39;https://github.com/FasterSpeeding/Yuyo/issues&#39;</span>
    </div>

    

                </section>
                <section id="__license__">
                                <div class="attr variable"><a class="headerlink" href="#__license__">#&nbsp;&nbsp</a>

        <span class="name">__license__</span><span class="default_value"> = &#39;BSD&#39;</span>
    </div>

    

                </section>
                <section id="__url__">
                                <div class="attr variable"><a class="headerlink" href="#__url__">#&nbsp;&nbsp</a>

        <span class="name">__url__</span><span class="default_value"> = &#39;https://github.com/FasterSpeeding/Yuyo&#39;</span>
    </div>

    

                </section>
                <section id="__version__">
                                <div class="attr variable"><a class="headerlink" href="#__version__">#&nbsp;&nbsp</a>

        <span class="name">__version__</span><span class="default_value"> = &#39;1.0.3a1&#39;</span>
    </div>

    

                </section>
                <section id="asgi">
                                <div class="attr module"><a class="headerlink" href="#asgi">#&nbsp;&nbsp</a>
<span class="name"><a href="yuyo/asgi.html">yuyo.asgi</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;ASGI/3 adapter for Hikari&#39;s interaction server.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AsgiAdapter&quot;</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">asgiref.typing</span> <span class="k">as</span> <span class="nn">asgiref</span>
<span class="kn">import</span> <span class="nn">hikari</span>

<span class="n">_AsgiAdapterT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_AsgiAdapterT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;AsgiAdapter&quot;</span><span class="p">)</span>


<span class="n">_CONTENT_TYPE_KEY</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;content-type&quot;</span>
<span class="n">_JSON_CONTENT_TYPE</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;application/json&quot;</span>
<span class="n">_BAD_REQUEST_STATUS</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">_X_SIGNATURE_ED25519_HEADER</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;x-signature-ed25519&quot;</span>
<span class="n">_X_SIGNATURE_TIMESTAMP_HEADER</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;x-signature-timestamp&quot;</span>
<span class="n">_TEXT_CONTENT_TYPE</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;text/plain; charset=UTF-8&quot;</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">_error_response</span><span class="p">(</span>
    <span class="n">send</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGISendCallable</span><span class="p">,</span> <span class="n">body</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">status_code</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">_BAD_REQUEST_STATUS</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">send</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;http.response.start&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status_code</span><span class="p">,</span> <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="n">_CONTENT_TYPE_KEY</span><span class="p">,</span> <span class="n">_TEXT_CONTENT_TYPE</span><span class="p">)]}</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;http.response.body&quot;</span><span class="p">,</span> <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">,</span> <span class="s2">&quot;more_body&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">_maybe_await</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">callback</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">result</span>


<span class="k">class</span> <span class="nc">AsgiAdapter</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Asgi/3 adapter for Hikari&#39;s interaction server interface.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_on_shutdown&quot;</span><span class="p">,</span> <span class="s2">&quot;_on_startup&quot;</span><span class="p">,</span> <span class="s2">&quot;_server&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialise the adapter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        server : hikari.api.InteractionServer</span>
<span class="sd">            The interaction server to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_shutdown</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_startup</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The interaction server this adapter is bound to.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">Scope</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGIReceiveCallable</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGISendCallable</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call the adapter.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This method is called by the ASGI server.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scope : asgiref.Scope</span>
<span class="sd">            The scope of the request.</span>
<span class="sd">        receive : asgiref.ASGIReceiveCallable</span>
<span class="sd">            The receive function to use.</span>
<span class="sd">        send : asgiref.ASGISendCallable</span>
<span class="sd">            The send function to use.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            If this is called with a websocket scope.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If an invalid scope event is passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;http&quot;</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_request</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">receive</span><span class="p">,</span> <span class="n">send</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;lifespan&quot;</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_lifespan_event</span><span class="p">(</span><span class="n">receive</span><span class="p">,</span> <span class="n">send</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Websocket operations are not supported&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_shutdown_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_AsgiAdapterT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_AsgiAdapterT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to be called when the ASGI server shuts down.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            These callbacks will block the ASGI server from shutting down until</span>
<span class="sd">            they complete and any raised errors will lead to a failed shutdown.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Callable[[], typing.Union[None, typing.Awaitable[None]]]</span>
<span class="sd">            The shutdown callback to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This adapter to enable call chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_shutdown</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_startup_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_AsgiAdapterT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_AsgiAdapterT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to be called when the ASGI server starts up.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            These callbacks will block the ASGI server from starting until</span>
<span class="sd">            they complete and any raised errors will lead to a failed startup.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Callable[[], typing.Union[None, typing.Awaitable[None]]]</span>
<span class="sd">            The startup callback to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This adapter to enable call chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_startup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">process_lifespan_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGIReceiveCallable</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGISendCallable</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Process a lifespan ASGI event.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This function is used internally by the adapter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        receive : asgiref.ASGIReceiveCallable</span>
<span class="sd">            The receive function to use.</span>
<span class="sd">        send : asgiref.ASGISendCallable</span>
<span class="sd">            The send function to use.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If an invalid lifespan event is passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receive</span><span class="p">()</span>
        <span class="n">message_type</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">message_type</span> <span class="o">==</span> <span class="s2">&quot;lifespan.startup&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">_maybe_await</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_startup</span><span class="p">))</span>

            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.startup.failed&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()})</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.startup.complete&quot;</span><span class="p">})</span>

        <span class="k">elif</span> <span class="n">message_type</span> <span class="o">==</span> <span class="s2">&quot;lifespan.shutdown&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">_maybe_await</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_shutdown</span><span class="p">))</span>

            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.shutdown.failed&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()})</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.shutdown.complete&quot;</span><span class="p">})</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown lifespan event </span><span class="si">{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">process_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">HTTPScope</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGIReceiveCallable</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGISendCallable</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Process an HTTP request.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This function is used internally by the adapter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scope : asgiref.HTTPScope</span>
<span class="sd">            The scope of the request.</span>
<span class="sd">        receive : asgiref.ASGIReceiveCallable</span>
<span class="sd">            The receive function to use.</span>
<span class="sd">        send : asgiref.ASGISendCallable</span>
<span class="sd">            The send function to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;POST&quot;</span> <span class="ow">or</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Not found&quot;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">more_body</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">body</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">more_body</span><span class="p">:</span>
            <span class="n">received</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receive</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">next_body</span> <span class="o">:=</span> <span class="n">received</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">):</span>
                <span class="n">body</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">next_body</span><span class="p">)</span>

            <span class="n">more_body</span> <span class="o">=</span> <span class="n">received</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;more_body&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">body</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;POST request must have a body&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">content_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">signature</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">timestamp</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;headers&quot;</span><span class="p">]:</span>
            <span class="c1"># As per-spec these should be matched case-insensitively.</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">_X_SIGNATURE_ED25519_HEADER</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">signature</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">))</span>

                <span class="c1"># Yes UnicodeDecodeError means failed ascii decode.</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">UnicodeDecodeError</span><span class="p">):</span>
                    <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Invalid ED25519 signature header found&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="k">if</span> <span class="n">timestamp</span> <span class="ow">and</span> <span class="n">content_type</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">_X_SIGNATURE_TIMESTAMP_HEADER</span><span class="p">:</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">if</span> <span class="n">signature</span> <span class="ow">and</span> <span class="n">content_type</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">_CONTENT_TYPE_KEY</span><span class="p">:</span>
                <span class="n">content_type</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">if</span> <span class="n">signature</span> <span class="ow">and</span> <span class="n">timestamp</span><span class="p">:</span>
                    <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">content_type</span> <span class="ow">or</span> <span class="n">content_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">_JSON_CONTENT_TYPE</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Content-Type must be application/json&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">signature</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Missing required request signature header(s)&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">on_interaction</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">signature</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Internal Server Error&quot;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="n">headers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

        <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;http.response.start&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="n">headers</span><span class="p">})</span>
        <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;http.response.body&quot;</span><span class="p">,</span> <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">payload</span> <span class="ow">or</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;more_body&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>

        </details>

            <div class="docstring"><p>ASGI/3 adapter for Hikari's interaction server.</p>
</div>


                </section>
                <section id="AsgiAdapter">
                                <div class="attr class">
        <a class="headerlink" href="#AsgiAdapter">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">AsgiAdapter</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AsgiAdapter</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Asgi/3 adapter for Hikari&#39;s interaction server interface.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_on_shutdown&quot;</span><span class="p">,</span> <span class="s2">&quot;_on_startup&quot;</span><span class="p">,</span> <span class="s2">&quot;_server&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialise the adapter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        server : hikari.api.InteractionServer</span>
<span class="sd">            The interaction server to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_shutdown</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_startup</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The interaction server this adapter is bound to.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">Scope</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGIReceiveCallable</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGISendCallable</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call the adapter.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This method is called by the ASGI server.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scope : asgiref.Scope</span>
<span class="sd">            The scope of the request.</span>
<span class="sd">        receive : asgiref.ASGIReceiveCallable</span>
<span class="sd">            The receive function to use.</span>
<span class="sd">        send : asgiref.ASGISendCallable</span>
<span class="sd">            The send function to use.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            If this is called with a websocket scope.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If an invalid scope event is passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;http&quot;</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_request</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">receive</span><span class="p">,</span> <span class="n">send</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;lifespan&quot;</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_lifespan_event</span><span class="p">(</span><span class="n">receive</span><span class="p">,</span> <span class="n">send</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Websocket operations are not supported&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_shutdown_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_AsgiAdapterT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_AsgiAdapterT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to be called when the ASGI server shuts down.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            These callbacks will block the ASGI server from shutting down until</span>
<span class="sd">            they complete and any raised errors will lead to a failed shutdown.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Callable[[], typing.Union[None, typing.Awaitable[None]]]</span>
<span class="sd">            The shutdown callback to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This adapter to enable call chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_shutdown</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_startup_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_AsgiAdapterT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_AsgiAdapterT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to be called when the ASGI server starts up.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            These callbacks will block the ASGI server from starting until</span>
<span class="sd">            they complete and any raised errors will lead to a failed startup.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Callable[[], typing.Union[None, typing.Awaitable[None]]]</span>
<span class="sd">            The startup callback to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This adapter to enable call chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_startup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">process_lifespan_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGIReceiveCallable</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGISendCallable</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Process a lifespan ASGI event.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This function is used internally by the adapter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        receive : asgiref.ASGIReceiveCallable</span>
<span class="sd">            The receive function to use.</span>
<span class="sd">        send : asgiref.ASGISendCallable</span>
<span class="sd">            The send function to use.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If an invalid lifespan event is passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receive</span><span class="p">()</span>
        <span class="n">message_type</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">message_type</span> <span class="o">==</span> <span class="s2">&quot;lifespan.startup&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">_maybe_await</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_startup</span><span class="p">))</span>

            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.startup.failed&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()})</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.startup.complete&quot;</span><span class="p">})</span>

        <span class="k">elif</span> <span class="n">message_type</span> <span class="o">==</span> <span class="s2">&quot;lifespan.shutdown&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">_maybe_await</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_shutdown</span><span class="p">))</span>

            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.shutdown.failed&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()})</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.shutdown.complete&quot;</span><span class="p">})</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown lifespan event </span><span class="si">{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">process_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">HTTPScope</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGIReceiveCallable</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGISendCallable</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Process an HTTP request.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This function is used internally by the adapter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scope : asgiref.HTTPScope</span>
<span class="sd">            The scope of the request.</span>
<span class="sd">        receive : asgiref.ASGIReceiveCallable</span>
<span class="sd">            The receive function to use.</span>
<span class="sd">        send : asgiref.ASGISendCallable</span>
<span class="sd">            The send function to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;POST&quot;</span> <span class="ow">or</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Not found&quot;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">more_body</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">body</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">more_body</span><span class="p">:</span>
            <span class="n">received</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receive</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">next_body</span> <span class="o">:=</span> <span class="n">received</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">):</span>
                <span class="n">body</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">next_body</span><span class="p">)</span>

            <span class="n">more_body</span> <span class="o">=</span> <span class="n">received</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;more_body&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">body</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;POST request must have a body&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">content_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">signature</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">timestamp</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;headers&quot;</span><span class="p">]:</span>
            <span class="c1"># As per-spec these should be matched case-insensitively.</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">_X_SIGNATURE_ED25519_HEADER</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">signature</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">))</span>

                <span class="c1"># Yes UnicodeDecodeError means failed ascii decode.</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">UnicodeDecodeError</span><span class="p">):</span>
                    <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Invalid ED25519 signature header found&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="k">if</span> <span class="n">timestamp</span> <span class="ow">and</span> <span class="n">content_type</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">_X_SIGNATURE_TIMESTAMP_HEADER</span><span class="p">:</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">if</span> <span class="n">signature</span> <span class="ow">and</span> <span class="n">content_type</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">_CONTENT_TYPE_KEY</span><span class="p">:</span>
                <span class="n">content_type</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">if</span> <span class="n">signature</span> <span class="ow">and</span> <span class="n">timestamp</span><span class="p">:</span>
                    <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">content_type</span> <span class="ow">or</span> <span class="n">content_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">_JSON_CONTENT_TYPE</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Content-Type must be application/json&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">signature</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Missing required request signature header(s)&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">on_interaction</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">signature</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Internal Server Error&quot;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="n">headers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

        <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;http.response.start&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="n">headers</span><span class="p">})</span>
        <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;http.response.body&quot;</span><span class="p">,</span> <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">payload</span> <span class="ow">or</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;more_body&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>

        </details>

            <div class="docstring"><p>Asgi/3 adapter for Hikari's interaction server interface.</p>
</div>


                            <div id="AsgiAdapter.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#AsgiAdapter.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">AsgiAdapter</span><span class="signature">(server: hikari.api.interaction_server.InteractionServer, /)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialise the adapter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        server : hikari.api.InteractionServer</span>
<span class="sd">            The interaction server to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_shutdown</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_startup</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>
</pre></div>

        </details>

            <div class="docstring"><p>Initialise the adapter.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>server</strong> (hikari.api.InteractionServer):
The interaction server to use.</li>
</ul>
</div>


                            </div>
                            <div id="AsgiAdapter.server" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#AsgiAdapter.server">#&nbsp;&nbsp</a>

        <span class="name">server</span><span class="annotation">: hikari.api.interaction_server.InteractionServer</span>
    </div>

            <div class="docstring"><p>The interaction server this adapter is bound to.</p>
</div>


                            </div>
                            <div id="AsgiAdapter.add_shutdown_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#AsgiAdapter.add_shutdown_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_shutdown_callback</span><span class="signature">(
    self: ~_AsgiAdapterT,
    callback: Callable[[], Optional[Awaitable[NoneType]]],
    /
) -&gt; ~_AsgiAdapterT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_shutdown_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_AsgiAdapterT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_AsgiAdapterT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to be called when the ASGI server shuts down.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            These callbacks will block the ASGI server from shutting down until</span>
<span class="sd">            they complete and any raised errors will lead to a failed shutdown.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Callable[[], typing.Union[None, typing.Awaitable[None]]]</span>
<span class="sd">            The shutdown callback to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This adapter to enable call chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_shutdown</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a callback to be called when the ASGI server shuts down.</p>

<p><em>Warning:</em>
These callbacks will block the ASGI server from shutting down until
they complete and any raised errors will lead to a failed shutdown.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>callback</strong> (typing.Callable[[], typing.Union[None, typing.Awaitable[None]]]):
The shutdown callback to add.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>SelfT</strong>: This adapter to enable call chaining.</li>
</ul>
</div>


                            </div>
                            <div id="AsgiAdapter.add_startup_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#AsgiAdapter.add_startup_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_startup_callback</span><span class="signature">(
    self: ~_AsgiAdapterT,
    callback: Callable[[], Optional[Awaitable[NoneType]]],
    /
) -&gt; ~_AsgiAdapterT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_startup_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_AsgiAdapterT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_AsgiAdapterT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to be called when the ASGI server starts up.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            These callbacks will block the ASGI server from starting until</span>
<span class="sd">            they complete and any raised errors will lead to a failed startup.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Callable[[], typing.Union[None, typing.Awaitable[None]]]</span>
<span class="sd">            The startup callback to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This adapter to enable call chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_startup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a callback to be called when the ASGI server starts up.</p>

<p><em>Warning:</em>
These callbacks will block the ASGI server from starting until
they complete and any raised errors will lead to a failed startup.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>callback</strong> (typing.Callable[[], typing.Union[None, typing.Awaitable[None]]]):
The startup callback to add.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>SelfT</strong>: This adapter to enable call chaining.</li>
</ul>
</div>


                            </div>
                            <div id="AsgiAdapter.process_lifespan_event" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#AsgiAdapter.process_lifespan_event">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">process_lifespan_event</span><span class="signature">(
    self,
    receive: Callable[[], Awaitable[Union[asgiref.HTTPRequestEvent, asgiref.HTTPDisconnectEvent, asgiref.WebSocketConnectEvent, asgiref.WebSocketReceiveEvent, asgiref.WebSocketDisconnectEvent, asgiref.LifespanStartupEvent, asgiref.LifespanShutdownEvent]]],
    send: Callable[[Union[asgiref.HTTPResponseStartEvent, asgiref.HTTPResponseBodyEvent, asgiref.HTTPServerPushEvent, asgiref.HTTPDisconnectEvent, asgiref.WebSocketAcceptEvent, asgiref.WebSocketSendEvent, asgiref.WebSocketResponseStartEvent, asgiref.WebSocketResponseBodyEvent, asgiref.WebSocketCloseEvent, asgiref.LifespanStartupCompleteEvent, asgiref.LifespanStartupFailedEvent, asgiref.LifespanShutdownCompleteEvent, asgiref.LifespanShutdownFailedEvent]], Awaitable[NoneType]],
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">process_lifespan_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGIReceiveCallable</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGISendCallable</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Process a lifespan ASGI event.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This function is used internally by the adapter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        receive : asgiref.ASGIReceiveCallable</span>
<span class="sd">            The receive function to use.</span>
<span class="sd">        send : asgiref.ASGISendCallable</span>
<span class="sd">            The send function to use.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If an invalid lifespan event is passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receive</span><span class="p">()</span>
        <span class="n">message_type</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">message_type</span> <span class="o">==</span> <span class="s2">&quot;lifespan.startup&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">_maybe_await</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_startup</span><span class="p">))</span>

            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.startup.failed&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()})</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.startup.complete&quot;</span><span class="p">})</span>

        <span class="k">elif</span> <span class="n">message_type</span> <span class="o">==</span> <span class="s2">&quot;lifespan.shutdown&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">_maybe_await</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_shutdown</span><span class="p">))</span>

            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.shutdown.failed&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()})</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;lifespan.shutdown.complete&quot;</span><span class="p">})</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown lifespan event </span><span class="si">{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Process a lifespan ASGI event.</p>

<p><em>Note:</em>
This function is used internally by the adapter.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>receive</strong> (asgiref.ASGIReceiveCallable):
The receive function to use.</li>
<li><strong>send</strong> (asgiref.ASGISendCallable):
The send function to use.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>RuntimeError</strong>: If an invalid lifespan event is passed.</li>
</ul>
</div>


                            </div>
                            <div id="AsgiAdapter.process_request" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#AsgiAdapter.process_request">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">process_request</span><span class="signature">(
    self,
    scope: asgiref.typing.HTTPScope,
    receive: Callable[[], Awaitable[Union[asgiref.HTTPRequestEvent, asgiref.HTTPDisconnectEvent, asgiref.WebSocketConnectEvent, asgiref.WebSocketReceiveEvent, asgiref.WebSocketDisconnectEvent, asgiref.LifespanStartupEvent, asgiref.LifespanShutdownEvent]]],
    send: Callable[[Union[asgiref.HTTPResponseStartEvent, asgiref.HTTPResponseBodyEvent, asgiref.HTTPServerPushEvent, asgiref.HTTPDisconnectEvent, asgiref.WebSocketAcceptEvent, asgiref.WebSocketSendEvent, asgiref.WebSocketResponseStartEvent, asgiref.WebSocketResponseBodyEvent, asgiref.WebSocketCloseEvent, asgiref.LifespanStartupCompleteEvent, asgiref.LifespanStartupFailedEvent, asgiref.LifespanShutdownCompleteEvent, asgiref.LifespanShutdownFailedEvent]], Awaitable[NoneType]],
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">process_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">HTTPScope</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGIReceiveCallable</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">asgiref</span><span class="o">.</span><span class="n">ASGISendCallable</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Process an HTTP request.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This function is used internally by the adapter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scope : asgiref.HTTPScope</span>
<span class="sd">            The scope of the request.</span>
<span class="sd">        receive : asgiref.ASGIReceiveCallable</span>
<span class="sd">            The receive function to use.</span>
<span class="sd">        send : asgiref.ASGISendCallable</span>
<span class="sd">            The send function to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;POST&quot;</span> <span class="ow">or</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Not found&quot;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">more_body</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">body</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">more_body</span><span class="p">:</span>
            <span class="n">received</span> <span class="o">=</span> <span class="k">await</span> <span class="n">receive</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">next_body</span> <span class="o">:=</span> <span class="n">received</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">):</span>
                <span class="n">body</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">next_body</span><span class="p">)</span>

            <span class="n">more_body</span> <span class="o">=</span> <span class="n">received</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;more_body&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">body</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;POST request must have a body&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">content_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">signature</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">timestamp</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">scope</span><span class="p">[</span><span class="s2">&quot;headers&quot;</span><span class="p">]:</span>
            <span class="c1"># As per-spec these should be matched case-insensitively.</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">_X_SIGNATURE_ED25519_HEADER</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">signature</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">))</span>

                <span class="c1"># Yes UnicodeDecodeError means failed ascii decode.</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">UnicodeDecodeError</span><span class="p">):</span>
                    <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Invalid ED25519 signature header found&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="k">if</span> <span class="n">timestamp</span> <span class="ow">and</span> <span class="n">content_type</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">_X_SIGNATURE_TIMESTAMP_HEADER</span><span class="p">:</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">if</span> <span class="n">signature</span> <span class="ow">and</span> <span class="n">content_type</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">_CONTENT_TYPE_KEY</span><span class="p">:</span>
                <span class="n">content_type</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">if</span> <span class="n">signature</span> <span class="ow">and</span> <span class="n">timestamp</span><span class="p">:</span>
                    <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">content_type</span> <span class="ow">or</span> <span class="n">content_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">_JSON_CONTENT_TYPE</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Content-Type must be application/json&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">signature</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Missing required request signature header(s)&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">on_interaction</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">signature</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_error_response</span><span class="p">(</span><span class="n">send</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;Internal Server Error&quot;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="n">headers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

        <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;http.response.start&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="n">headers</span><span class="p">})</span>
        <span class="k">await</span> <span class="n">send</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;http.response.body&quot;</span><span class="p">,</span> <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">payload</span> <span class="ow">or</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;more_body&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>

        </details>

            <div class="docstring"><p>Process an HTTP request.</p>

<p><em>Note:</em>
This function is used internally by the adapter.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>scope</strong> (asgiref.HTTPScope):
The scope of the request.</li>
<li><strong>receive</strong> (asgiref.ASGIReceiveCallable):
The receive function to use.</li>
<li><strong>send</strong> (asgiref.ASGISendCallable):
The send function to use.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="backoff">
                                <div class="attr module"><a class="headerlink" href="#backoff">#&nbsp;&nbsp</a>
<span class="name"><a href="yuyo/backoff.html">yuyo.backoff</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Utility used for handling automatic back-off.</span>

<span class="sd">This can be used to cover cases such as hitting rate-limits and failed requests.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Backoff&quot;</span><span class="p">,</span> <span class="s2">&quot;ErrorManager&quot;</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">from</span> <span class="nn">hikari.impl</span> <span class="kn">import</span> <span class="n">rate_limits</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">types</span>


<span class="n">ErrorManagerT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ErrorManagerT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;ErrorManager&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Backoff</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Used to exponentially backoff asynchronously.</span>

<span class="sd">    This class acts as an asynchronous iterator and can be iterated over to</span>
<span class="sd">    provide implicit backoff where for every iteration other than the first</span>
<span class="sd">    this will either back off for the time passed to `Backoff.set_next_backoff`</span>
<span class="sd">    if applicable or a time calculated exponentially.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    max_retries : typing.Optional[builtins.int]</span>
<span class="sd">        The maximum amount of times this should iterate for between resets.</span>
<span class="sd">        If left as `builtins.None` then this iterator will be unlimited.</span>
<span class="sd">        This must be greater than or equal to 1.</span>
<span class="sd">    base : builtins.float</span>
<span class="sd">        The base to use. Defaults to `2.0`.</span>
<span class="sd">    maximum : builtins.float</span>
<span class="sd">        The max value the backoff can be in a single iteration. Anything above</span>
<span class="sd">        this will be capped to this base value plus random jitter.</span>
<span class="sd">    jitter_multiplier : builtins.float</span>
<span class="sd">        The multiplier for the random jitter. Defaults to `1.0`.</span>
<span class="sd">        Set to `0` to disable jitter.</span>
<span class="sd">    initial_increment : builtins.int</span>
<span class="sd">        The initial increment to start at. Defaults to `0`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If an `builtins.int` that&#39;s too big to be represented as a</span>
<span class="sd">        `builtins.float` or a non-finite value is passed in place of a field</span>
<span class="sd">        that&#39;s annotated as `builtins.float` or if `max_retries` is less than 1.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    An example of using this class as an asynchronous iterator may look like</span>
<span class="sd">    the following</span>

<span class="sd">    ```py</span>
<span class="sd">    # While we can directly do `async for _ in Backoff()`, by assigning it to a</span>
<span class="sd">    # variable we allow ourself to provide a specific backoff time in some cases.</span>
<span class="sd">    backoff = Backoff()</span>
<span class="sd">    async for _ in backoff:</span>
<span class="sd">        try:</span>
<span class="sd">            message = await bot.rest.fetch_message(channel_id, message_id)</span>
<span class="sd">        except errors.RateLimitedError as exc:</span>
<span class="sd">            # If we have a specific backoff time then set it for the next iteration</span>
<span class="sd">            backoff.set_next_backoff(exc.retry_after)</span>
<span class="sd">        except errors.InternalServerError:</span>
<span class="sd">            # Else let the iterator calculate an exponential backoff before the next loop.</span>
<span class="sd">            pass</span>
<span class="sd">        else:</span>
<span class="sd">            # We need to break out of the iterator to make sure it doesn&#39;t backoff again.</span>
<span class="sd">            # Alternatively `Backoff.finish()` can be called to break out of the loop.</span>
<span class="sd">            break</span>
<span class="sd">    ```</span>

<span class="sd">    Alternatively you may want to explicitly call `Backoff.backoff`, a</span>
<span class="sd">    alternative of the previous example which uses `Backoff.backoff` may</span>
<span class="sd">    look like the following</span>

<span class="sd">    ```py</span>
<span class="sd">    backoff = Backoff()</span>
<span class="sd">    message: typing.Optional[messages.Message] = None</span>
<span class="sd">    while not message:</span>
<span class="sd">        try:</span>
<span class="sd">            message = await bot.rest.fetch_message(channel_id, message_id)</span>
<span class="sd">        except errors.RateLimitedError as exc:</span>
<span class="sd">            # If we have a specific backoff time then set it for the next iteration.</span>
<span class="sd">            await backoff.backoff(exc.retry_after)</span>
<span class="sd">        except errors.InternalServerError:</span>
<span class="sd">            # Else let the iterator calculate an exponential backoff before the next loop.</span>
<span class="sd">            await backoff.backoff()</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_backoff&quot;</span><span class="p">,</span> <span class="s2">&quot;_finished&quot;</span><span class="p">,</span> <span class="s2">&quot;_max_retries&quot;</span><span class="p">,</span> <span class="s2">&quot;_next_backoff&quot;</span><span class="p">,</span> <span class="s2">&quot;_retries&quot;</span><span class="p">,</span> <span class="s2">&quot;_started&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">base</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">maximum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">64.0</span><span class="p">,</span>
        <span class="n">jitter_multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">initial_increment</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">max_retries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">max_retries</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_retries must be greater than 1&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span> <span class="o">=</span> <span class="n">rate_limits</span><span class="o">.</span><span class="n">ExponentialBackOff</span><span class="p">(</span>
            <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">maximum</span><span class="p">,</span> <span class="n">jitter_multiplier</span><span class="o">=</span><span class="n">jitter_multiplier</span><span class="p">,</span> <span class="n">initial_increment</span><span class="o">=</span><span class="n">initial_increment</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span> <span class="o">=</span> <span class="n">max_retries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_retries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__aiter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Backoff</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__anext__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_depleted</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">raise</span> <span class="ne">StopAsyncIteration</span>

        <span class="c1"># We don&#39;t want to backoff on the first iteration.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span>

        <span class="n">backoff_</span><span class="p">:</span> <span class="nb">float</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">backoff_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">backoff_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_retries</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">backoff_</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_depleted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether &quot;max_retries&quot; has been reached.</span>

<span class="sd">        This can be used to workout whether the loop was explicitly broken out</span>
<span class="sd">        of using `Backoff.finish`/`break` or if it hit &quot;max_retries&quot;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            If &quot;max_retries&quot; has been hit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retries</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">backoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backoff_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Sleep for the provided backoff or for the next exponent.</span>

<span class="sd">        This provides an alternative to iterating over this class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        backoff_ : typing.Optional[float]</span>
<span class="sd">            The time this should backoff for. If left as `builtins.None` then</span>
<span class="sd">            this will back off for the last time provided with</span>
<span class="sd">            `Backoff.set_next_backoff` if available or the next exponential time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">backoff_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">backoff_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="n">backoff_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">backoff_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span><span class="p">)</span>

        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">backoff_</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">finish</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Mark the iterator as finished to break out of the current loop.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reset the backoff to it&#39;s original state to reuse it.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_retries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">set_next_backoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backoff_</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Specify a backoff time for the next iteration or `Backoff.backoff` call.</span>

<span class="sd">        If this is called then the exponent won&#39;t be increased for this iteration.</span>

<span class="sd">        !!! note</span>
<span class="sd">            Calling this multiple times in a single iteration will overwrite any</span>
<span class="sd">            previously set next backoff.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: maximum?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="n">backoff_</span>


<span class="k">class</span> <span class="nc">ErrorManager</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A context manager provided to allow for more concise error handling with `Backoff`.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    *rules : typing.Tuple[typing.Iterable[typing.Type[BaseException]], typing.Callable[[typing.Any], typing.Optional[bool]]]</span>
<span class="sd">        Rules to initiate this error context manager with.</span>

<span class="sd">        These are each a 2-length tuple where the tuple[0] is an</span>
<span class="sd">        iterable of types of the exceptions this rule should apply to</span>
<span class="sd">        and tuple[1] is the rule&#39;s callback function.</span>

<span class="sd">        The callback function will be called with the raised exception when it</span>
<span class="sd">        matches one of the passed exceptions for the relevant rule and may</span>
<span class="sd">        raise, return `builtins.True` to indicate that the current error should</span>
<span class="sd">        be raised outside of the context manager or</span>
<span class="sd">        `builtins.False`/`builtins.None` to suppress the current error.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    The following is an example of using `ErrorManager` alongside `Backoff`</span>
<span class="sd">    in-order to handle the exceptions which may be raised while trying to</span>
<span class="sd">    reply to a message.</span>

<span class="sd">    ```py</span>
<span class="sd">    retry = Backoff()</span>
<span class="sd">    # Rules can either be passed to `ErrorManager`&#39;s initiate as variable arguments</span>
<span class="sd">    # or one at a time to `ErrorManager.with_rule` through possibly chained-calls.</span>
<span class="sd">    error_handler = (</span>
<span class="sd">        # For the 1st rule we catch two errors which would indicate the bot</span>
<span class="sd">        # no-longer has access to the target channel and break out of the</span>
<span class="sd">        # retry loop using `Backoff.retry`.</span>
<span class="sd">        ErrorManager(((errors.NotFoundError, errors.ForbiddenError), lambda _: retry.finish()))</span>
<span class="sd">            # For the 2nd rule we catch rate limited errors and set their</span>
<span class="sd">            # `retry` value as the next backoff time before suppressing the</span>
<span class="sd">            # error to allow this to retry the request.</span>
<span class="sd">            .with_rule((errors.RateLimitedError,), lambda exc: retry.set_next_backoff(exc.retry_after))</span>
<span class="sd">            # For the 3rd rule we suppress the internal server error to allow</span>
<span class="sd">            # backoff to reach the next retry and exponentially backoff as we</span>
<span class="sd">            # don&#39;t have any specific retry time for this error.</span>
<span class="sd">            .with_rule((errors.InternalServerError,), lambda _: False)</span>
<span class="sd">    )</span>
<span class="sd">    async for _ in retry:</span>
<span class="sd">        # We entre this context manager each iteration to catch errors before</span>
<span class="sd">        # they cause us to break out of the `Backoff` loop.</span>
<span class="sd">        with error_handler:</span>
<span class="sd">            await message.respond(&quot;General Kenobi&quot;)</span>
<span class="sd">            # We need to break out of `retry` if this request succeeds.</span>
<span class="sd">            break</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_rules&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">rules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]</span>
        <span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span> <span class="o">=</span> <span class="p">{(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">exceptions</span><span class="p">),</span> <span class="n">callback</span><span class="p">)</span> <span class="k">for</span> <span class="n">exceptions</span><span class="p">,</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">}</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorManager</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exception_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">exception</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
        <span class="n">exception_traceback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">types</span><span class="o">.</span><span class="n">TracebackType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">exception_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">assert</span> <span class="n">exception</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="c1"># This shouldn&#39;t ever be None when exception_type isn&#39;t None.</span>
        <span class="k">for</span> <span class="n">rule</span><span class="p">,</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">exception_type</span><span class="p">,</span> <span class="n">rule</span><span class="p">):</span>
                <span class="c1"># For this context manager&#39;s rules we switch up how returns are handled to let the rules prevent</span>
                <span class="c1"># exceptions from being raised outside of the context by default by having `None` and `False` both</span>
                <span class="c1"># indicate don&#39;t re-raise (suppress) and `True` indicate that it should re-raise.</span>
                <span class="k">return</span> <span class="ow">not</span> <span class="n">callback</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">clear_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the rules registered with this handler.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">with_rule</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">ErrorManagerT</span><span class="p">,</span>
        <span class="n">exceptions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorManagerT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a rule to this exception context manager.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exceptions : typing.Iterable[typing.Type[builtins.BaseException]]</span>
<span class="sd">            An iterable of types of the exceptions this rule should apply to.</span>
<span class="sd">        result : typing.Callable[[typing.Any], typing.Optional[builtins.bool]]</span>
<span class="sd">            The function called with the raised exception when it matches one</span>
<span class="sd">            of the passed `exceptions`.</span>
<span class="sd">            This may raise, return `builtins.True` to indicate that the current</span>
<span class="sd">            error should be raised outside of the context manager or</span>
<span class="sd">            `builtins.False`/`builtins.None` to suppress the current error.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ErrorManager</span>
<span class="sd">            This returns the handler a rule was being added to in-order to</span>
<span class="sd">            allow for chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="nb">tuple</span><span class="p">(</span><span class="n">exceptions</span><span class="p">),</span> <span class="n">result</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Utility used for handling automatic back-off.</p>

<p>This can be used to cover cases such as hitting rate-limits and failed requests.</p>
</div>


                </section>
                <section id="Backoff">
                                <div class="attr class">
        <a class="headerlink" href="#Backoff">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Backoff</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Backoff</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Used to exponentially backoff asynchronously.</span>

<span class="sd">    This class acts as an asynchronous iterator and can be iterated over to</span>
<span class="sd">    provide implicit backoff where for every iteration other than the first</span>
<span class="sd">    this will either back off for the time passed to `Backoff.set_next_backoff`</span>
<span class="sd">    if applicable or a time calculated exponentially.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    max_retries : typing.Optional[builtins.int]</span>
<span class="sd">        The maximum amount of times this should iterate for between resets.</span>
<span class="sd">        If left as `builtins.None` then this iterator will be unlimited.</span>
<span class="sd">        This must be greater than or equal to 1.</span>
<span class="sd">    base : builtins.float</span>
<span class="sd">        The base to use. Defaults to `2.0`.</span>
<span class="sd">    maximum : builtins.float</span>
<span class="sd">        The max value the backoff can be in a single iteration. Anything above</span>
<span class="sd">        this will be capped to this base value plus random jitter.</span>
<span class="sd">    jitter_multiplier : builtins.float</span>
<span class="sd">        The multiplier for the random jitter. Defaults to `1.0`.</span>
<span class="sd">        Set to `0` to disable jitter.</span>
<span class="sd">    initial_increment : builtins.int</span>
<span class="sd">        The initial increment to start at. Defaults to `0`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If an `builtins.int` that&#39;s too big to be represented as a</span>
<span class="sd">        `builtins.float` or a non-finite value is passed in place of a field</span>
<span class="sd">        that&#39;s annotated as `builtins.float` or if `max_retries` is less than 1.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    An example of using this class as an asynchronous iterator may look like</span>
<span class="sd">    the following</span>

<span class="sd">    ```py</span>
<span class="sd">    # While we can directly do `async for _ in Backoff()`, by assigning it to a</span>
<span class="sd">    # variable we allow ourself to provide a specific backoff time in some cases.</span>
<span class="sd">    backoff = Backoff()</span>
<span class="sd">    async for _ in backoff:</span>
<span class="sd">        try:</span>
<span class="sd">            message = await bot.rest.fetch_message(channel_id, message_id)</span>
<span class="sd">        except errors.RateLimitedError as exc:</span>
<span class="sd">            # If we have a specific backoff time then set it for the next iteration</span>
<span class="sd">            backoff.set_next_backoff(exc.retry_after)</span>
<span class="sd">        except errors.InternalServerError:</span>
<span class="sd">            # Else let the iterator calculate an exponential backoff before the next loop.</span>
<span class="sd">            pass</span>
<span class="sd">        else:</span>
<span class="sd">            # We need to break out of the iterator to make sure it doesn&#39;t backoff again.</span>
<span class="sd">            # Alternatively `Backoff.finish()` can be called to break out of the loop.</span>
<span class="sd">            break</span>
<span class="sd">    ```</span>

<span class="sd">    Alternatively you may want to explicitly call `Backoff.backoff`, a</span>
<span class="sd">    alternative of the previous example which uses `Backoff.backoff` may</span>
<span class="sd">    look like the following</span>

<span class="sd">    ```py</span>
<span class="sd">    backoff = Backoff()</span>
<span class="sd">    message: typing.Optional[messages.Message] = None</span>
<span class="sd">    while not message:</span>
<span class="sd">        try:</span>
<span class="sd">            message = await bot.rest.fetch_message(channel_id, message_id)</span>
<span class="sd">        except errors.RateLimitedError as exc:</span>
<span class="sd">            # If we have a specific backoff time then set it for the next iteration.</span>
<span class="sd">            await backoff.backoff(exc.retry_after)</span>
<span class="sd">        except errors.InternalServerError:</span>
<span class="sd">            # Else let the iterator calculate an exponential backoff before the next loop.</span>
<span class="sd">            await backoff.backoff()</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_backoff&quot;</span><span class="p">,</span> <span class="s2">&quot;_finished&quot;</span><span class="p">,</span> <span class="s2">&quot;_max_retries&quot;</span><span class="p">,</span> <span class="s2">&quot;_next_backoff&quot;</span><span class="p">,</span> <span class="s2">&quot;_retries&quot;</span><span class="p">,</span> <span class="s2">&quot;_started&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">base</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">maximum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">64.0</span><span class="p">,</span>
        <span class="n">jitter_multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">initial_increment</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">max_retries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">max_retries</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_retries must be greater than 1&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span> <span class="o">=</span> <span class="n">rate_limits</span><span class="o">.</span><span class="n">ExponentialBackOff</span><span class="p">(</span>
            <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">maximum</span><span class="p">,</span> <span class="n">jitter_multiplier</span><span class="o">=</span><span class="n">jitter_multiplier</span><span class="p">,</span> <span class="n">initial_increment</span><span class="o">=</span><span class="n">initial_increment</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span> <span class="o">=</span> <span class="n">max_retries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_retries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__aiter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Backoff</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__anext__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_depleted</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">raise</span> <span class="ne">StopAsyncIteration</span>

        <span class="c1"># We don&#39;t want to backoff on the first iteration.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span>

        <span class="n">backoff_</span><span class="p">:</span> <span class="nb">float</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">backoff_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">backoff_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_retries</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">backoff_</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_depleted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether &quot;max_retries&quot; has been reached.</span>

<span class="sd">        This can be used to workout whether the loop was explicitly broken out</span>
<span class="sd">        of using `Backoff.finish`/`break` or if it hit &quot;max_retries&quot;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            If &quot;max_retries&quot; has been hit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retries</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">backoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backoff_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Sleep for the provided backoff or for the next exponent.</span>

<span class="sd">        This provides an alternative to iterating over this class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        backoff_ : typing.Optional[float]</span>
<span class="sd">            The time this should backoff for. If left as `builtins.None` then</span>
<span class="sd">            this will back off for the last time provided with</span>
<span class="sd">            `Backoff.set_next_backoff` if available or the next exponential time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">backoff_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">backoff_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="n">backoff_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">backoff_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span><span class="p">)</span>

        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">backoff_</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">finish</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Mark the iterator as finished to break out of the current loop.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reset the backoff to it&#39;s original state to reuse it.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_retries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">set_next_backoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backoff_</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Specify a backoff time for the next iteration or `Backoff.backoff` call.</span>

<span class="sd">        If this is called then the exponent won&#39;t be increased for this iteration.</span>

<span class="sd">        !!! note</span>
<span class="sd">            Calling this multiple times in a single iteration will overwrite any</span>
<span class="sd">            previously set next backoff.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: maximum?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="n">backoff_</span>
</pre></div>

        </details>

            <div class="docstring"><p>Used to exponentially backoff asynchronously.</p>

<p>This class acts as an asynchronous iterator and can be iterated over to
provide implicit backoff where for every iteration other than the first
this will either back off for the time passed to <code><a href="#Backoff.set_next_backoff">Backoff.set_next_backoff</a></code>
if applicable or a time calculated exponentially.</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>max_retries</strong> (typing.Optional[builtins.int]):
The maximum amount of times this should iterate for between resets.
If left as <code>builtins.None</code> then this iterator will be unlimited.
This must be greater than or equal to 1.</li>
<li><strong>base</strong> (builtins.float):
The base to use. Defaults to <code>2.0</code>.</li>
<li><strong>maximum</strong> (builtins.float):
The max value the backoff can be in a single iteration. Anything above
this will be capped to this base value plus random jitter.</li>
<li><strong>jitter_multiplier</strong> (builtins.float):
The multiplier for the random jitter. Defaults to <code>1.0</code>.
Set to <code>0</code> to disable jitter.</li>
<li><strong>initial_increment</strong> (builtins.int):
The initial increment to start at. Defaults to <code>0</code>.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If an <code>builtins.int</code> that's too big to be represented as a
<code>builtins.float</code> or a non-finite value is passed in place of a field
that's annotated as <code>builtins.float</code> or if <code>max_retries</code> is less than 1.</li>
</ul>

<h6 id="examples">Examples</h6>

<p>An example of using this class as an asynchronous iterator may look like
the following</p>

<div class="codehilite"><pre><span></span><code><span class="c1"># While we can directly do `async for _ in Backoff()`, by assigning it to a</span>
<span class="c1"># variable we allow ourself to provide a specific backoff time in some cases.</span>
<span class="n">backoff</span> <span class="o">=</span> <span class="n">Backoff</span><span class="p">()</span>
<span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">backoff</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="n">channel_id</span><span class="p">,</span> <span class="n">message_id</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="c1"># If we have a specific backoff time then set it for the next iteration</span>
        <span class="n">backoff</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
        <span class="c1"># Else let the iterator calculate an exponential backoff before the next loop.</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We need to break out of the iterator to make sure it doesn&#39;t backoff again.</span>
        <span class="c1"># Alternatively `<a href="#Backoff.finish">Backoff.finish()</a>` can be called to break out of the loop.</span>
        <span class="k">break</span>
</code></pre></div>

<p>Alternatively you may want to explicitly call <code><a href="#Backoff.backoff">Backoff.backoff</a></code>, a
alternative of the previous example which uses <code><a href="#Backoff.backoff">Backoff.backoff</a></code> may
look like the following</p>

<div class="codehilite"><pre><span></span><code><span class="n">backoff</span> <span class="o">=</span> <span class="n">Backoff</span><span class="p">()</span>
<span class="n">message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">messages</span><span class="o">.</span><span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">message</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="n">channel_id</span><span class="p">,</span> <span class="n">message_id</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="c1"># If we have a specific backoff time then set it for the next iteration.</span>
        <span class="k">await</span> <span class="n">backoff</span><span class="o">.</span><span class="n">backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
        <span class="c1"># Else let the iterator calculate an exponential backoff before the next loop.</span>
        <span class="k">await</span> <span class="n">backoff</span><span class="o">.</span><span class="n">backoff</span><span class="p">()</span>
</code></pre></div>
</div>


                            <div id="Backoff.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Backoff.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">Backoff</span><span class="signature">(
    max_retries: Optional[int] = None,
    *,
    base: float = 2.0,
    maximum: float = 64.0,
    jitter_multiplier: float = 1.0,
    initial_increment: int = 0
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">base</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">maximum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">64.0</span><span class="p">,</span>
        <span class="n">jitter_multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">initial_increment</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">max_retries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">max_retries</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_retries must be greater than 1&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span> <span class="o">=</span> <span class="n">rate_limits</span><span class="o">.</span><span class="n">ExponentialBackOff</span><span class="p">(</span>
            <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">maximum</span><span class="p">,</span> <span class="n">jitter_multiplier</span><span class="o">=</span><span class="n">jitter_multiplier</span><span class="p">,</span> <span class="n">initial_increment</span><span class="o">=</span><span class="n">initial_increment</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_retries</span> <span class="o">=</span> <span class="n">max_retries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_retries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Backoff.is_depleted" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Backoff.is_depleted">#&nbsp;&nbsp</a>

        <span class="name">is_depleted</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether "max_retries" has been reached.</p>

<p>This can be used to workout whether the loop was explicitly broken out
of using <code><a href="#Backoff.finish">Backoff.finish</a></code>/<code>break</code> or if it hit "max_retries".</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: If "max_retries" has been hit.</li>
</ul>
</div>


                            </div>
                            <div id="Backoff.backoff" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Backoff.backoff">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">backoff</span><span class="signature">(self, backoff_: Optional[float], /) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">backoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backoff_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Sleep for the provided backoff or for the next exponent.</span>

<span class="sd">        This provides an alternative to iterating over this class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        backoff_ : typing.Optional[float]</span>
<span class="sd">            The time this should backoff for. If left as `builtins.None` then</span>
<span class="sd">            this will back off for the last time provided with</span>
<span class="sd">            `Backoff.set_next_backoff` if available or the next exponential time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">backoff_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">backoff_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="n">backoff_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">backoff_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span><span class="p">)</span>

        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">backoff_</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Sleep for the provided backoff or for the next exponent.</p>

<p>This provides an alternative to iterating over this class.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>backoff_</strong> (typing.Optional[float]):
The time this should backoff for. If left as <code>builtins.None</code> then
this will back off for the last time provided with
<code><a href="#Backoff.set_next_backoff">Backoff.set_next_backoff</a></code> if available or the next exponential time.</li>
</ul>
</div>


                            </div>
                            <div id="Backoff.finish" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Backoff.finish">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">finish</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">finish</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Mark the iterator as finished to break out of the current loop.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

        </details>

            <div class="docstring"><p>Mark the iterator as finished to break out of the current loop.</p>
</div>


                            </div>
                            <div id="Backoff.reset" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Backoff.reset">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">reset</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reset the backoff to it&#39;s original state to reuse it.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backoff</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_retries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

        </details>

            <div class="docstring"><p>Reset the backoff to it's original state to reuse it.</p>
</div>


                            </div>
                            <div id="Backoff.set_next_backoff" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Backoff.set_next_backoff">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_next_backoff</span><span class="signature">(self, backoff_: float, /) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_next_backoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backoff_</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Specify a backoff time for the next iteration or `Backoff.backoff` call.</span>

<span class="sd">        If this is called then the exponent won&#39;t be increased for this iteration.</span>

<span class="sd">        !!! note</span>
<span class="sd">            Calling this multiple times in a single iteration will overwrite any</span>
<span class="sd">            previously set next backoff.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: maximum?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_backoff</span> <span class="o">=</span> <span class="n">backoff_</span>
</pre></div>

        </details>

            <div class="docstring"><p>Specify a backoff time for the next iteration or <code><a href="#Backoff.backoff">Backoff.backoff</a></code> call.</p>

<p>If this is called then the exponent won't be increased for this iteration.</p>

<p>!!! note
    Calling this multiple times in a single iteration will overwrite any
    previously set next backoff.</p>
</div>


                            </div>
                </section>
                <section id="ErrorManager">
                                <div class="attr class">
        <a class="headerlink" href="#ErrorManager">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ErrorManager</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ErrorManager</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A context manager provided to allow for more concise error handling with `Backoff`.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    *rules : typing.Tuple[typing.Iterable[typing.Type[BaseException]], typing.Callable[[typing.Any], typing.Optional[bool]]]</span>
<span class="sd">        Rules to initiate this error context manager with.</span>

<span class="sd">        These are each a 2-length tuple where the tuple[0] is an</span>
<span class="sd">        iterable of types of the exceptions this rule should apply to</span>
<span class="sd">        and tuple[1] is the rule&#39;s callback function.</span>

<span class="sd">        The callback function will be called with the raised exception when it</span>
<span class="sd">        matches one of the passed exceptions for the relevant rule and may</span>
<span class="sd">        raise, return `builtins.True` to indicate that the current error should</span>
<span class="sd">        be raised outside of the context manager or</span>
<span class="sd">        `builtins.False`/`builtins.None` to suppress the current error.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    The following is an example of using `ErrorManager` alongside `Backoff`</span>
<span class="sd">    in-order to handle the exceptions which may be raised while trying to</span>
<span class="sd">    reply to a message.</span>

<span class="sd">    ```py</span>
<span class="sd">    retry = Backoff()</span>
<span class="sd">    # Rules can either be passed to `ErrorManager`&#39;s initiate as variable arguments</span>
<span class="sd">    # or one at a time to `ErrorManager.with_rule` through possibly chained-calls.</span>
<span class="sd">    error_handler = (</span>
<span class="sd">        # For the 1st rule we catch two errors which would indicate the bot</span>
<span class="sd">        # no-longer has access to the target channel and break out of the</span>
<span class="sd">        # retry loop using `Backoff.retry`.</span>
<span class="sd">        ErrorManager(((errors.NotFoundError, errors.ForbiddenError), lambda _: retry.finish()))</span>
<span class="sd">            # For the 2nd rule we catch rate limited errors and set their</span>
<span class="sd">            # `retry` value as the next backoff time before suppressing the</span>
<span class="sd">            # error to allow this to retry the request.</span>
<span class="sd">            .with_rule((errors.RateLimitedError,), lambda exc: retry.set_next_backoff(exc.retry_after))</span>
<span class="sd">            # For the 3rd rule we suppress the internal server error to allow</span>
<span class="sd">            # backoff to reach the next retry and exponentially backoff as we</span>
<span class="sd">            # don&#39;t have any specific retry time for this error.</span>
<span class="sd">            .with_rule((errors.InternalServerError,), lambda _: False)</span>
<span class="sd">    )</span>
<span class="sd">    async for _ in retry:</span>
<span class="sd">        # We entre this context manager each iteration to catch errors before</span>
<span class="sd">        # they cause us to break out of the `Backoff` loop.</span>
<span class="sd">        with error_handler:</span>
<span class="sd">            await message.respond(&quot;General Kenobi&quot;)</span>
<span class="sd">            # We need to break out of `retry` if this request succeeds.</span>
<span class="sd">            break</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_rules&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">rules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]</span>
        <span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span> <span class="o">=</span> <span class="p">{(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">exceptions</span><span class="p">),</span> <span class="n">callback</span><span class="p">)</span> <span class="k">for</span> <span class="n">exceptions</span><span class="p">,</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">}</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorManager</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exception_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">exception</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
        <span class="n">exception_traceback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">types</span><span class="o">.</span><span class="n">TracebackType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">exception_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">assert</span> <span class="n">exception</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>  <span class="c1"># This shouldn&#39;t ever be None when exception_type isn&#39;t None.</span>
        <span class="k">for</span> <span class="n">rule</span><span class="p">,</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">exception_type</span><span class="p">,</span> <span class="n">rule</span><span class="p">):</span>
                <span class="c1"># For this context manager&#39;s rules we switch up how returns are handled to let the rules prevent</span>
                <span class="c1"># exceptions from being raised outside of the context by default by having `None` and `False` both</span>
                <span class="c1"># indicate don&#39;t re-raise (suppress) and `True` indicate that it should re-raise.</span>
                <span class="k">return</span> <span class="ow">not</span> <span class="n">callback</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">clear_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the rules registered with this handler.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">with_rule</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">ErrorManagerT</span><span class="p">,</span>
        <span class="n">exceptions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorManagerT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a rule to this exception context manager.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exceptions : typing.Iterable[typing.Type[builtins.BaseException]]</span>
<span class="sd">            An iterable of types of the exceptions this rule should apply to.</span>
<span class="sd">        result : typing.Callable[[typing.Any], typing.Optional[builtins.bool]]</span>
<span class="sd">            The function called with the raised exception when it matches one</span>
<span class="sd">            of the passed `exceptions`.</span>
<span class="sd">            This may raise, return `builtins.True` to indicate that the current</span>
<span class="sd">            error should be raised outside of the context manager or</span>
<span class="sd">            `builtins.False`/`builtins.None` to suppress the current error.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ErrorManager</span>
<span class="sd">            This returns the handler a rule was being added to in-order to</span>
<span class="sd">            allow for chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="nb">tuple</span><span class="p">(</span><span class="n">exceptions</span><span class="p">),</span> <span class="n">result</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>A context manager provided to allow for more concise error handling with <code><a href="#Backoff">Backoff</a></code>.</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>*rules</strong> (typing.Tuple[typing.Iterable[typing.Type[BaseException]], typing.Callable[[typing.Any], typing.Optional[bool]]]):
Rules to initiate this error context manager with.</p>

<p>These are each a 2-length tuple where the tuple[0] is an
iterable of types of the exceptions this rule should apply to
and tuple[1] is the rule's callback function.</p>

<p>The callback function will be called with the raised exception when it
matches one of the passed exceptions for the relevant rule and may
raise, return <code>builtins.True</code> to indicate that the current error should
be raised outside of the context manager or
<code>builtins.False</code>/<code>builtins.None</code> to suppress the current error.</p></li>
</ul>

<h6 id="examples">Examples</h6>

<p>The following is an example of using <code><a href="#ErrorManager">ErrorManager</a></code> alongside <code><a href="#Backoff">Backoff</a></code>
in-order to handle the exceptions which may be raised while trying to
reply to a message.</p>

<div class="codehilite"><pre><span></span><code><span class="n">retry</span> <span class="o">=</span> <span class="n">Backoff</span><span class="p">()</span>
<span class="c1"># Rules can either be passed to `ErrorManager`&#39;s initiate as variable arguments</span>
<span class="c1"># or one at a time to `<a href="#ErrorManager.with_rule">ErrorManager.with_rule</a>` through possibly chained-calls.</span>
<span class="n">error_handler</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># For the 1st rule we catch two errors which would indicate the bot</span>
    <span class="c1"># no-longer has access to the target channel and break out of the</span>
    <span class="c1"># retry loop using `Backoff.retry`.</span>
    <span class="n">ErrorManager</span><span class="p">(((</span><span class="n">errors</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">,</span> <span class="n">errors</span><span class="o">.</span><span class="n">ForbiddenError</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">retry</span><span class="o">.</span><span class="n">finish</span><span class="p">()))</span>
        <span class="c1"># For the 2nd rule we catch rate limited errors and set their</span>
        <span class="c1"># `retry` value as the next backoff time before suppressing the</span>
        <span class="c1"># error to allow this to retry the request.</span>
        <span class="o">.</span><span class="n">with_rule</span><span class="p">((</span><span class="n">errors</span><span class="o">.</span><span class="n">RateLimitedError</span><span class="p">,),</span> <span class="k">lambda</span> <span class="n">exc</span><span class="p">:</span> <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">))</span>
        <span class="c1"># For the 3rd rule we suppress the internal server error to allow</span>
        <span class="c1"># backoff to reach the next retry and exponentially backoff as we</span>
        <span class="c1"># don&#39;t have any specific retry time for this error.</span>
        <span class="o">.</span><span class="n">with_rule</span><span class="p">((</span><span class="n">errors</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">,),</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
    <span class="c1"># We entre this context manager each iteration to catch errors before</span>
    <span class="c1"># they cause us to break out of the `Backoff` loop.</span>
    <span class="k">with</span> <span class="n">error_handler</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s2">&quot;General Kenobi&quot;</span><span class="p">)</span>
        <span class="c1"># We need to break out of `retry` if this request succeeds.</span>
        <span class="k">break</span>
</code></pre></div>
</div>


                            <div id="ErrorManager.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ErrorManager.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ErrorManager</span><span class="signature">(
    *rules: Tuple[Iterable[Type[BaseException]], Callable[[Any], Optional[bool]]]
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">rules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]</span>
        <span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span> <span class="o">=</span> <span class="p">{(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">exceptions</span><span class="p">),</span> <span class="n">callback</span><span class="p">)</span> <span class="k">for</span> <span class="n">exceptions</span><span class="p">,</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">}</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ErrorManager.clear_rules" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ErrorManager.clear_rules">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">clear_rules</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">clear_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the rules registered with this handler.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Clear the rules registered with this handler.</p>
</div>


                            </div>
                            <div id="ErrorManager.with_rule" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ErrorManager.with_rule">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_rule</span><span class="signature">(
    self: ~ErrorManagerT,
    exceptions: Iterable[Type[BaseException]],
    result: Callable[[Any], Optional[bool]]
) -&gt; ~ErrorManagerT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_rule</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">ErrorManagerT</span><span class="p">,</span>
        <span class="n">exceptions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorManagerT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a rule to this exception context manager.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exceptions : typing.Iterable[typing.Type[builtins.BaseException]]</span>
<span class="sd">            An iterable of types of the exceptions this rule should apply to.</span>
<span class="sd">        result : typing.Callable[[typing.Any], typing.Optional[builtins.bool]]</span>
<span class="sd">            The function called with the raised exception when it matches one</span>
<span class="sd">            of the passed `exceptions`.</span>
<span class="sd">            This may raise, return `builtins.True` to indicate that the current</span>
<span class="sd">            error should be raised outside of the context manager or</span>
<span class="sd">            `builtins.False`/`builtins.None` to suppress the current error.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ErrorManager</span>
<span class="sd">            This returns the handler a rule was being added to in-order to</span>
<span class="sd">            allow for chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="nb">tuple</span><span class="p">(</span><span class="n">exceptions</span><span class="p">),</span> <span class="n">result</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a rule to this exception context manager.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>exceptions</strong> (typing.Iterable[typing.Type[builtins.BaseException]]):
An iterable of types of the exceptions this rule should apply to.</li>
<li><strong>result</strong> (typing.Callable[[typing.Any], typing.Optional[builtins.bool]]):
The function called with the raised exception when it matches one
of the passed <code>exceptions</code>.
This may raise, return <code>builtins.True</code> to indicate that the current
error should be raised outside of the context manager or
<code>builtins.False</code>/<code>builtins.None</code> to suppress the current error.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ErrorManager</strong>: This returns the handler a rule was being added to in-order to
allow for chained calls.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="components">
                                <div class="attr module"><a class="headerlink" href="#components">#&nbsp;&nbsp</a>
<span class="name"><a href="yuyo/components.html">yuyo.components</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Higher level client for callback based component execution.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;AbstractComponentExecutor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ActionRowExecutor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_child_executor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_component_callback&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ChildActionRowExecutor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ComponentClient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ComponentContext&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ComponentExecutor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ComponentPaginator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;InteractiveButtonBuilder&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MultiComponentExecutor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SelectMenuBuilder&quot;</span><span class="p">,</span>
    <span class="s2">&quot;WaitForComponent&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">import</span> <span class="nn">uuid</span>

<span class="kn">import</span> <span class="nn">hikari</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">pagination</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">types</span>

    <span class="kn">from</span> <span class="nn">hikari</span> <span class="kn">import</span> <span class="n">traits</span>

    <span class="n">_T</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_T&quot;</span><span class="p">)</span>
    <span class="n">_ActionRowExecutorT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ActionRowExecutorT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;ActionRowExecutor&quot;</span><span class="p">)</span>
    <span class="n">_ComponentClientT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ComponentClientT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;ComponentClient&quot;</span><span class="p">)</span>
    <span class="n">_ComponentExecutorT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ComponentExecutorT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;ComponentExecutor&quot;</span><span class="p">)</span>
    <span class="n">_MultiComponentExecutorT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_MultiComponentExecutorT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;MultiComponentExecutor&quot;</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">_ContainerProto</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">__</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>

        <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">class</span> <span class="nc">_ParentExecutorProto</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">add_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>

        <span class="k">def</span> <span class="nf">add_executor</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">AbstractComponentExecutor</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="k">def</span> <span class="nf">_random_id</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>


<span class="n">AbstractComponentExecutorT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;AbstractComponentExecutorT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;AbstractComponentExecutor&quot;</span><span class="p">)</span>
<span class="n">CallbackSig</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="s2">&quot;ComponentContext&quot;</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span>
<span class="n">CallbackSigT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;CallbackSigT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">CallbackSig</span><span class="p">)</span>
<span class="n">ContainerProtoT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ContainerProtoT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;_ContainerProto&quot;</span><span class="p">)</span>
<span class="n">ParentExecutorProtoT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ParentExecutorProtoT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;_ParentExecutorProto&quot;</span><span class="p">)</span>
<span class="n">ResponseT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionMessageBuilder</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionDeferredBuilder</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">ComponentContext</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The general context passed around for a component trigger.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_ephemeral_default&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_has_responded&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_has_been_deferred&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_interaction&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_last_response_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_response_future&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_response_lock&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span>
        <span class="n">response_future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span> <span class="o">=</span> <span class="n">interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span> <span class="o">=</span> <span class="n">response_future</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_been_deferred</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this context&#39;s initial response has been deferred.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether this context&#39;s initial response has been deferred.</span>

<span class="sd">            This will be true if `ComponentContext.defer` has been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_responded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether an initial response has been made to this context yet.</span>

<span class="sd">        It&#39;s worth noting that a context must be either responded to or</span>
<span class="sd">        deferred within 3 seconds from it being received otherwise it&#39;ll be</span>
<span class="sd">        marked as failed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether an initial response has been made to this context yet.</span>

<span class="sd">            This will be true if either `CompontentContext.respond`,</span>
<span class="sd">            `ComponentContext.create_initial_response` or</span>
<span class="sd">            `ComponentContext.edit_initial_response` (after a deferral) has been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Object of the interaction this context is for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.ComponentInteraction</span>
<span class="sd">            The interaction this context is for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span>

    <span class="k">def</span> <span class="nf">_get_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">flags</span>

        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="k">else</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">NONE</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">defer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">defer_type</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">DeferredResponseTypesT</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Mark this context as deferred.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        defer_type : hikari.DeferredResponseTypesT</span>
<span class="sd">            The type of deferral this should be.</span>

<span class="sd">            This may either be `hikari.ResponseType.DEFERRED_MESSAGE_CREATE` to</span>
<span class="sd">            indicate that the following up call to `ComponentContext.edit_initial_response`</span>
<span class="sd">            or `ComponentContext.respond` should create a new message or</span>
<span class="sd">            `hikari.ResponseType.DEFERRED_MESSAGE_UPDATE` to indicate that the following</span>
<span class="sd">            call to the aforementioned methods should update the existing message.</span>
<span class="sd">        flags : typing.Union[hikari.UndefinedType, int, hikari.MessageFlag]</span>
<span class="sd">            The flags to set for this deferral.</span>

<span class="sd">            As of writing, the only message flag which can be set here is</span>
<span class="sd">            `hikari.MessageFlag.EPHEMERAL` which indicates that the deferred</span>
<span class="sd">            message create should be only visible by the interaction&#39;s author.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Context has already been responded to&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">build_deferred_response</span><span class="p">(</span><span class="n">defer_type</span><span class="p">)</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">defer_type</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_followup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Respond to this context with a followup message.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : hikari.UndefinedOr[typing.Any]</span>
<span class="sd">            The content to respond with.</span>

<span class="sd">            If provided, the message contents. If</span>
<span class="sd">            `hikari.undefined.UNDEFINED`, then nothing will be sent</span>
<span class="sd">            in the content. Any other value here will be cast to a</span>
<span class="sd">            `str`.</span>

<span class="sd">            If this is a `hikari.embeds.Embed` and no `embed` nor `embeds` kwarg</span>
<span class="sd">            is provided, then this will instead update the embed. This allows</span>
<span class="sd">            for simpler syntax when sending an embed alone.</span>

<span class="sd">            Likewise, if this is a `hikari.files.Resource`, then the</span>
<span class="sd">            content is instead treated as an attachment if no `attachment` and</span>
<span class="sd">            no `attachments` kwargs are provided.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        ensure_result : bool</span>
<span class="sd">            This parameter does nothing but necessary to keep the signature with `Context`.</span>
<span class="sd">        tts : hikari.UndefinedOr[bool]</span>
<span class="sd">            Whether to respond with tts/text to speech or no.</span>
<span class="sd">        reply : hikari.Undefinedor[hikari.SnowflakeishOr[hikari.PartialMessage]]</span>
<span class="sd">            Whether to reply instead of sending the content to the context.</span>
<span class="sd">        nonce : hikari.UndefinedOr[str]</span>
<span class="sd">            The nonce that validates that the message was sent.</span>
<span class="sd">        attachment : hikari.UndefinedOr[hikari.Resourceish]</span>
<span class="sd">            A singular attachment to respond with.</span>
<span class="sd">        attachments : hikari.UndefinedOr[collections.Sequence[hikari.Resourceish]]</span>
<span class="sd">            A sequence of attachments to respond with.</span>
<span class="sd">        component : hikari.undefined.UndefinedOr[hikari.api.special_endpoints.ComponentBuilder]</span>
<span class="sd">            If provided, builder object of the component to include in this message.</span>
<span class="sd">        components : hikari.undefined.UndefinedOr[typing.Sequence[hikari.api.special_endpoints.ComponentBuilder]]</span>
<span class="sd">            If provided, a sequence of the component builder objects to include</span>
<span class="sd">            in this message.</span>
<span class="sd">        embed : hikari.UndefinedOr[hikari.Embed]</span>
<span class="sd">            An embed to respond with.</span>
<span class="sd">        embeds : hikari.UndefinedOr[collections.Sequence[hikari.Embed]]</span>
<span class="sd">            A sequence of embeds to respond with.</span>
<span class="sd">        mentions_everyone : hikari.undefined.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message should parse @everyone/@here</span>
<span class="sd">            mentions.</span>
<span class="sd">        user_mentions : hikari.undefined.UndefinedOr[typing.Union[hikari.snowflakes.SnowflakeishSequence[hikari.users.PartialUser], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>
<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.snowflakes.Snowflake`, or `hikari.users.PartialUser`</span>
<span class="sd">            derivatives to enforce mentioning specific users.</span>
<span class="sd">        role_mentions : hikari.undefined.UndefinedOr[typing.Union[hikari.snowflakes.SnowflakeishSequence[hikari.guilds.PartialRole], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>
<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.snowflakes.Snowflake`, or</span>
<span class="sd">            `hikari.guilds.PartialRole` derivatives to enforce mentioning</span>
<span class="sd">            specific roles.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Attachments can be passed as many different things, to aid in</span>
<span class="sd">        convenience.</span>
<span class="sd">        * If a `pathlib.PurePath` or `str` to a valid URL, the</span>
<span class="sd">            resource at the given URL will be streamed to Discord when</span>
<span class="sd">            sending the message. Subclasses of</span>
<span class="sd">            `hikari.files.WebResource` such as</span>
<span class="sd">            `hikari.files.URL`,</span>
<span class="sd">            `hikari.messages.Attachment`,</span>
<span class="sd">            `hikari.emojis.Emoji`,</span>
<span class="sd">            `EmbedResource`, etc will also be uploaded this way.</span>
<span class="sd">            This will use bit-inception, so only a small percentage of the</span>
<span class="sd">            resource will remain in memory at any one time, thus aiding in</span>
<span class="sd">            scalability.</span>
<span class="sd">        * If a `hikari.files.Bytes` is passed, or a `str`</span>
<span class="sd">            that contains a valid data URI is passed, then this is uploaded</span>
<span class="sd">            with a randomized file name if not provided.</span>
<span class="sd">        * If a `hikari.files.File`, `pathlib.PurePath` or</span>
<span class="sd">            `str` that is an absolute or relative path to a file</span>
<span class="sd">            on your file system is passed, then this resource is uploaded</span>
<span class="sd">            as an attachment using non-blocking code internally and streamed</span>
<span class="sd">            using bit-inception where possible. This depends on the</span>
<span class="sd">            type of `concurrent.futures.Executor` that is being used for</span>
<span class="sd">            the application (default is a thread pool which supports this</span>
<span class="sd">            behaviour).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.messages.Message</span>
<span class="sd">            The message that has been created.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If more than 100 unique objects/entities are passed for</span>
<span class="sd">            `role_mentions` or `user_mentions`.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If both `attachment` and `attachments` are specified.</span>
<span class="sd">        hikari.errors.BadRequestError</span>
<span class="sd">            This may be raised in several discrete situations, such as messages</span>
<span class="sd">            being empty with no attachments or embeds; messages with more than</span>
<span class="sd">            2000 characters in them, embeds that exceed one of the many embed</span>
<span class="sd">            limits; too many attachments; attachments that are too large;</span>
<span class="sd">            invalid image URLs in embeds; if `reply` is not found or not in the</span>
<span class="sd">            same channel as `channel`; too many components.</span>
<span class="sd">        hikari.errors.UnauthorizedError</span>
<span class="sd">            If you are unauthorized to make the request (invalid/missing token).</span>
<span class="sd">        hikari.errors.ForbiddenError</span>
<span class="sd">            If you are missing the `SEND_MESSAGES` in the channel or the</span>
<span class="sd">            person you are trying to message has the DM&#39;s disabled.</span>
<span class="sd">        hikari.errors.NotFoundError</span>
<span class="sd">            If the channel is not found.</span>
<span class="sd">        hikari.errors.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.errors.RateLimitedError</span>
<span class="sd">            Usually, Hikari will handle and retry on hitting</span>
<span class="sd">            rate-limits automatically. This includes most bucket-specific</span>
<span class="sd">            rate-limits and global rate-limits. In some rare edge cases,</span>
<span class="sd">            however, Discord implements other undocumented rules for</span>
<span class="sd">            rate-limiting, such as limits per attribute. These cannot be</span>
<span class="sd">            detected or handled normally by Hikari due to their undocumented</span>
<span class="sd">            nature, and will trigger this exception if they occur.</span>
<span class="sd">        hikari.errors.InternalServerError</span>
<span class="sd">            If an internal error occurs on Discord while handling the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - Line too long</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>
            <span class="k">return</span> <span class="n">message</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">response_type</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentResponseTypesT</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Initial response has already been created&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;edit_initial_response must be used to set the initial response after a context has been deferred&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
                <span class="n">response_type</span><span class="o">=</span><span class="n">response_type</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">component</span> <span class="ow">and</span> <span class="n">components</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of component or components may be passed&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">embed</span> <span class="ow">and</span> <span class="n">embeds</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of embed or embeds may be passed&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">component</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">)</span>
                <span class="n">components</span> <span class="o">=</span> <span class="p">(</span><span class="n">component</span><span class="p">,)</span>

            <span class="k">if</span> <span class="n">embed</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">embed</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">)</span>
                <span class="n">embeds</span> <span class="o">=</span> <span class="p">(</span><span class="n">embed</span><span class="p">,)</span>

            <span class="c1"># Pyright doesn&#39;t properly support attrs and doesn&#39;t account for _ being removed from field</span>
            <span class="c1"># pre-fix in init.</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">InteractionMessageBuilder</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">response_type</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">is_tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>  <span class="c1"># type: ignore</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">response_type</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageResponseTypesT</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">response_type</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no last response&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_last_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous responses&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous known responses&quot;</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                    <span class="n">content</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>
                <span class="k">return</span> <span class="n">message</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                    <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">ensure_result</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">ExecutorClosed</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error used to indicate that an executor is now closed during execution.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">ComponentClient</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Client used to handle component executors within a REST or gateway flow.</span>

<span class="sd">    .. note::</span>
<span class="sd">        For an easier way to initialise the client from a bot see</span>
<span class="sd">        `ComponentClient.from_gateway_bot` and `ComponentClient.from_rest_bot`.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    event_manager : typing.Optional[hikari.api.EventManager]</span>
<span class="sd">        The event manager this client should listen to dispatched component</span>
<span class="sd">        interactions from if applicable.</span>
<span class="sd">    event_managed : bool</span>
<span class="sd">        Whether this client should be automatically opened and closed based on</span>
<span class="sd">        the lifetime events dispatched by `event_manager`.</span>

<span class="sd">        Defaults to `True` if an event manager is passed.</span>
<span class="sd">    server : typing.Optional[hikari.api.InteractionServer]</span>
<span class="sd">        The server this client should listen to component interactions</span>
<span class="sd">        from if applicable.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If `event_managed` is passed as `True` when `event_manager` is None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_event_manager&quot;</span><span class="p">,</span> <span class="s2">&quot;_executors&quot;</span><span class="p">,</span> <span class="s2">&quot;_gc_task&quot;</span><span class="p">,</span> <span class="s2">&quot;_server&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">event_manager</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">server</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span> <span class="o">=</span> <span class="n">event_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">AbstractComponentExecutor</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>

        <span class="k">if</span> <span class="n">event_managed</span> <span class="ow">or</span> <span class="n">event_managed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">event_manager</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">event_manager</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;event_managed may only be passed when an event_manager is also passed&quot;</span><span class="p">)</span>

            <span class="n">event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting</span><span class="p">)</span>
            <span class="n">event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exc_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">exc</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
        <span class="n">exc_traceback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">types</span><span class="o">.</span><span class="n">TracebackType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComponentClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a component client froma Gateway Bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The Gateway bot this component client should be bound to.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether the component client should be automatically opened and</span>
<span class="sd">            closed based on the lifetime events dispatched by `bot`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ComponentClient</span>
<span class="sd">            The initialised component client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">event_manager</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span> <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rest_bot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">traits</span><span class="o">.</span><span class="n">RESTBotAware</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComponentClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a component client froma REST Bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.RESTBotAware</span>
<span class="sd">            The REST bot this component client should be bound to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ComponentClient</span>
<span class="sd">            The initialised component client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">server</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">interaction_server</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_starting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_stopping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_gc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">message_id</span><span class="p">,</span> <span class="n">executor</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">executor</span><span class="o">.</span><span class="n">has_expired</span> <span class="ow">or</span> <span class="n">message_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">[</span><span class="n">message_id</span><span class="p">]</span>
                <span class="c1"># This may slow this gc task down but the more we yield the better.</span>
                <span class="c1"># await executor.close()  # TODO: this</span>

            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># TODO: is this a good time?</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the component client.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_gateway_event</span><span class="p">)</span>

        <span class="c1"># executor = self._executors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># for executor in executor.values():  # TODO: finish</span>
        <span class="c1">#     executor.close()</span>

    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Startup the component client.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gc</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_rest_request</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_gateway_event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_execute_executor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">executor</span><span class="p">:</span> <span class="n">AbstractComponentExecutor</span><span class="p">,</span>
        <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ExecutorClosed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_gateway_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">executor</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span> <span class="s2">&quot;This message has timed-out.&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_rest_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResponseT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">executor</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">executor</span><span class="o">.</span><span class="n">has_expired</span><span class="p">:</span>
                <span class="n">future</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_execute_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">,</span> <span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">))</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">[</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">interaction</span><span class="o">.</span><span class="n">build_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="s2">&quot;This message has timed-out.&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_executor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentClientT</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span> <span class="n">executor</span><span class="p">:</span> <span class="n">AbstractComponentExecutor</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentClientT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">message</span><span class="p">)]</span> <span class="o">=</span> <span class="n">executor</span>
        <span class="k">return</span> <span class="bp">self</span>


<span class="k">def</span> <span class="nf">as_component_callback</span><span class="p">(</span><span class="n">custom_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSigT</span><span class="p">],</span> <span class="n">CallbackSigT</span><span class="p">]:</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSigT</span><span class="p">:</span>
        <span class="n">callback</span><span class="o">.</span><span class="n">__custom_id__</span> <span class="o">=</span> <span class="n">custom_id</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">return</span> <span class="n">decorator</span>


<span class="k">class</span> <span class="nc">AbstractComponentExecutor</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">custom_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this executor has ended.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether this executor has ended.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="k">class</span> <span class="nc">ComponentExecutor</span><span class="p">(</span><span class="n">AbstractComponentExecutor</span><span class="p">):</span>  <span class="c1"># TODO: Not found action?</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_ephemeral_default&quot;</span><span class="p">,</span> <span class="s2">&quot;_id_to_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_last_triggered&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">,</span> <span class="s2">&quot;_timeout&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">CallbackSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ComponentExecutor</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># TODO: might be a tad bit slow</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">custom_id</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">__custom_id__</span>

                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">[</span><span class="n">custom_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">CallbackSig</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">custom_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">ComponentContext</span><span class="p">(</span>
            <span class="n">ephemeral_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span><span class="p">,</span> <span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span> <span class="n">response_future</span><span class="o">=</span><span class="n">future</span>
        <span class="p">)</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">[</span><span class="n">interaction</span><span class="o">.</span><span class="n">custom_id</span><span class="p">]</span>
        <span class="k">await</span> <span class="n">callback</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentExecutorT</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentExecutorT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSigT</span><span class="p">],</span> <span class="n">CallbackSigT</span><span class="p">]:</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">id_</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">_pre_execution_error</span><span class="p">(</span>
    <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]],</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">future</span><span class="p">:</span>
        <span class="n">future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span>
            <span class="n">interaction</span><span class="o">.</span><span class="n">build_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">WaitForComponent</span><span class="p">(</span><span class="n">AbstractComponentExecutor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Component executor used to wait for a single component interaction.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    authors: typing.Optional[typing.Iterable[hikari.SnowflakeishOr[hikari.User]]]</span>
<span class="sd">        The authors of the entries.</span>

<span class="sd">        If None is passed here then the paginator will be public (meaning that</span>
<span class="sd">        anybody can use it).</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    ephemeral_default: bool</span>
<span class="sd">        Whether or not the responses made on contexts spawned from this paginator</span>
<span class="sd">        should default to ephemeral (meaning only the author can see them) unless</span>
<span class="sd">        `flags` is specified on the response method.</span>
<span class="sd">    timeout : datetime.timedelta</span>
<span class="sd">        How long this should wait for a matching component interaction until it times-out.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    responses: dict[str, str]</span>
<span class="sd">    message = await ctx.respond(&quot;hi, pick an option&quot;, components=[...])</span>
<span class="sd">    executor = yuyo.components.WaitFor(authors=(ctx.author.id,), timeout=datetime.timedelta(seconds=30))</span>
<span class="sd">    component_client.add_executor(message.id, executor)</span>

<span class="sd">    try:</span>
<span class="sd">        result = await executor.wait_for()</span>
<span class="sd">    except asyncio.TimeoutError:</span>
<span class="sd">        await ctx.respond(&quot;timed out&quot;)</span>

<span class="sd">    else:</span>
<span class="sd">        await result.respond(responses[result.interaction.custom_id])</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_authors&quot;</span><span class="p">,</span> <span class="s2">&quot;_ephemeral_default&quot;</span><span class="p">,</span> <span class="s2">&quot;_finished&quot;</span><span class="p">,</span> <span class="s2">&quot;_future&quot;</span><span class="p">,</span> <span class="s2">&quot;_made_at&quot;</span><span class="p">,</span> <span class="s2">&quot;_timeout&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]]],</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">authors</span><span class="p">))</span> <span class="k">if</span> <span class="n">authors</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ComponentContext</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_made_at</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">custom_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_made_at</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_made_at</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ComponentContext</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Wait for the next matching interaction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        asyncio.Future[ComponentContext]</span>
<span class="sd">            A future that will be resolved with the next matching interaction.</span>

<span class="sd">            This will raise `asyncio.TimeoutError` if the timeout is reached.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the executor is already being waited for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This executor is already being waited for&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_made_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_future</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="ow">and</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_pre_execution_error</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="p">,</span> <span class="s2">&quot;You are not allowed to use this button&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span>
            <span class="n">ComponentContext</span><span class="p">(</span><span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span> <span class="n">response_future</span><span class="o">=</span><span class="n">future</span><span class="p">,</span> <span class="n">ephemeral_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span><span class="p">)</span>
        <span class="p">)</span>


<span class="n">WaitFor</span> <span class="o">=</span> <span class="n">WaitForComponent</span>


<span class="k">class</span> <span class="nc">InteractiveButtonBuilder</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">InteractiveButtonBuilder</span><span class="p">[</span><span class="n">ContainerProtoT</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="n">container</span><span class="p">:</span> <span class="n">ContainerProtoT</span><span class="p">,</span> <span class="n">custom_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="c1"># pyright doesn&#39;t support attrs _ kwargs</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSig</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span>

    <span class="k">def</span> <span class="nf">add_to_container</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContainerProtoT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">SelectMenuBuilder</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">SelectMenuBuilder</span><span class="p">[</span><span class="n">ContainerProtoT</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="n">container</span><span class="p">:</span> <span class="n">ContainerProtoT</span><span class="p">,</span> <span class="n">custom_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="c1"># pyright doesn&#39;t support attrs _ kwargs</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSig</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span>

    <span class="k">def</span> <span class="nf">add_to_container</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContainerProtoT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">ActionRowExecutor</span><span class="p">(</span><span class="n">ComponentExecutor</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_components&quot;</span><span class="p">,</span> <span class="s2">&quot;_stored_type&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">ephemeral_default</span><span class="o">=</span><span class="n">ephemeral_default</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="n">load_from_attributes</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stored_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_assert_can_add_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stored_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stored_type</span> <span class="o">!=</span> <span class="n">type_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2"> component type cannot be added to a container which already holds </span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stored_type</span> <span class="o">=</span> <span class="n">type_</span>

    <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ActionRowExecutorT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">add_button</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractiveButtonTypesT</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">custom_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InteractiveButtonBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">add_button</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">LINK</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span>
        <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">LinkButtonBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">add_button</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="p">],</span>
        <span class="n">callback_or_url</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">custom_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
        <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">LinkButtonBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">],</span> <span class="n">InteractiveButtonBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">]</span>
    <span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_can_add_type</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="o">.</span><span class="n">BUTTON</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractiveButtonTypes</span><span class="p">:</span>
            <span class="c1"># Pyright doesn&#39;t properly support _ attrs kwargs</span>
            <span class="k">if</span> <span class="n">custom_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">custom_id</span> <span class="o">=</span> <span class="n">_random_id</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Callback must be passed for an interactive button, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">InteractiveButtonBuilder</span><span class="p">(</span>
                <span class="n">callback</span><span class="o">=</span><span class="n">callback_or_url</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>

        <span class="c1"># Pyright doesn&#39;t properly support _ attrs kwargs</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;String url must be passed for Link style buttons, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">LinkButtonBuilder</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">callback_or_url</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span> <span class="nf">add_select_menu</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">custom_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SelectMenuBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_can_add_type</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="o">.</span><span class="n">SELECT_MENU</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">custom_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">custom_id</span> <span class="o">=</span> <span class="n">_random_id</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">SelectMenuBuilder</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="o">.</span><span class="n">ACTION_ROW</span><span class="p">,</span>
            <span class="s2">&quot;components&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">build</span><span class="p">()</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">],</span>
        <span class="p">}</span>


<span class="k">class</span> <span class="nc">ChildActionRowExecutor</span><span class="p">(</span><span class="n">ActionRowExecutor</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">ParentExecutorProtoT</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Extended implementation of `ActionRowExecutor` which can be tied to a `MultiComponentExecutor`.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_parent&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">ParentExecutorProtoT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ephemeral_default</span><span class="o">=</span><span class="n">ephemeral_default</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="n">load_from_attributes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>

    <span class="k">def</span> <span class="nf">add_to_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParentExecutorProtoT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add this action row to its parent executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ParentExecutorProtoT</span>
<span class="sd">            The parent executor this action row was added to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add_executor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">as_child_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="n">AbstractComponentExecutorT</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="n">AbstractComponentExecutorT</span><span class="p">]:</span>
    <span class="n">executor</span><span class="o">.</span><span class="n">__is_child_executor__</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># type: ignore</span>
    <span class="k">return</span> <span class="n">executor</span>


<span class="k">class</span> <span class="nc">MultiComponentExecutor</span><span class="p">(</span><span class="n">AbstractComponentExecutor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multi-component implementation of a component executor.</span>

<span class="sd">    This implementation allows for multiple components to be executed as a single</span>
<span class="sd">    view.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    load_from_attributes: bool</span>
<span class="sd">        Whether this should load sub-components from its attributes.</span>

<span class="sd">        This is helpful when inheritance and `as_child_executor` are being</span>
<span class="sd">        used to declare child executors within this executor.</span>
<span class="sd">    timeout : datetime.timedelta</span>
<span class="sd">        The amount of time to wait after the component&#39;s last execution or creation</span>
<span class="sd">        until it times out.</span>

<span class="sd">        Defaults to 30 seconds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_builders&quot;</span><span class="p">,</span> <span class="s2">&quot;_executors&quot;</span><span class="p">,</span> <span class="s2">&quot;_last_triggered&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">,</span> <span class="s2">&quot;_timeout&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_builders</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">AbstractComponentExecutor</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">MultiComponentExecutor</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># TODO: might be a tad bit slow</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">__is_child_executor__</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">())</span>

                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">builders</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Component builders within this executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Sequence[hikari.api.ComponentBuilder]</span>
<span class="sd">            Seqeuence of the component builders within this executor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_builders</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">custom_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">custom_ids</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">executors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">AbstractComponentExecutor</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Child executors within this multi-executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Sequence[AbstractComponentExecutor]</span>
<span class="sd">            A sequence of the child executors within this multi-executor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span>

    <span class="k">def</span> <span class="nf">add_builder</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MultiComponentExecutorT</span><span class="p">,</span> <span class="n">builder</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MultiComponentExecutorT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a non-executable component builder to this executor.</span>

<span class="sd">        This is useful for adding components that are not meant to be executed, such as a</span>
<span class="sd">        a row of link buttons.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        builder : hikari.api.ComponentBuilder</span>
<span class="sd">            The component builder to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_builders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">builder</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_action_row</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MultiComponentExecutorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChildActionRowExecutor</span><span class="p">[</span><span class="n">_MultiComponentExecutorT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Create a builder class to add an action row to this executor.</span>

<span class="sd">        For the most part this follows the same implementation as `ActionRowExecutor`</span>
<span class="sd">        except with the added detail that `ChildActionRowExecutor.add_to_parent`</span>
<span class="sd">        must be called to add the action row to the parent executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ChildActionRowExecutor[_MultiComponentExecutorT]</span>
<span class="sd">            A builder class to add an action row to this executor.</span>

<span class="sd">            `ChildActionRowExecutor.add_to_parent` should be called to finalise</span>
<span class="sd">            the action row and will return the parent executor for chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ChildActionRowExecutor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_executor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MultiComponentExecutorT</span><span class="p">,</span> <span class="n">executor</span><span class="p">:</span> <span class="n">AbstractComponentExecutor</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MultiComponentExecutorT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a component executor to this multi-component executor.</span>

<span class="sd">        This method is internally used by the `add_{component}` methods.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        executor : AbstractComponentExecutor</span>
<span class="sd">            The component executor to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The multi-component executor instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">executor</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">for</span> <span class="n">executor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">custom_id</span> <span class="ow">in</span> <span class="n">executor</span><span class="o">.</span><span class="n">custom_ids</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Custom ID not found&quot;</span><span class="p">)</span>  <span class="c1"># TODO: do we want to respond here?</span>


<span class="k">class</span> <span class="nc">ComponentPaginator</span><span class="p">(</span><span class="n">ActionRowExecutor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard implementation of an action row executor used for pagination.</span>

<span class="sd">    This is a convenience class that allows you to easily implement a paginator.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    iterator: yuyo.pagination.IteratorT[pagination.EntryT]</span>
<span class="sd">        The iterator to paginate.</span>

<span class="sd">        This should be an iterator of tuples of `(content: hikari.UndefinedOr[str],</span>
<span class="sd">        embed: hikari.UndefinedOr[hikari.Embed])`.</span>
<span class="sd">    authors: typing.Optional[typing.Iterable[hikari.SnowflakeishOr[hikari.User]]]</span>
<span class="sd">        The authors of the entries.</span>

<span class="sd">        If None is passed here then the paginator will be public (meaning that</span>
<span class="sd">        anybody can use it).</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    ephemeral_default: bool</span>
<span class="sd">        Whether or not the responses made on contexts spawned from this paginator</span>
<span class="sd">        should default to ephemeral (meaning only the author can see them) unless</span>
<span class="sd">        `flags` is specified on the response method.</span>
<span class="sd">    triggers: typing.Collection[str]</span>
<span class="sd">        Collection of the unicode emojis that should trigger this paginator.</span>

<span class="sd">        As of current the only usable emojis are `pagination.LEFT_TRIANGLE`,</span>
<span class="sd">        `pagination.RIGHT_TRIANGLE`, `pagination.STOP_SQUARE`,</span>
<span class="sd">        `pagination.LEFT_DOUBLE_TRIANGLE` and `pagination.LEFT_RIGHT_TRIANGLE`.</span>
<span class="sd">    timeout : datetime.timedelta</span>
<span class="sd">        The amount of time to wait after the component&#39;s last execution or creation</span>
<span class="sd">        until it times out.</span>

<span class="sd">        This defaults to 30 seconds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_authors&quot;</span><span class="p">,</span> <span class="s2">&quot;_buffer&quot;</span><span class="p">,</span> <span class="s2">&quot;_index&quot;</span><span class="p">,</span> <span class="s2">&quot;_iterator&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">iterator</span><span class="p">:</span> <span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]]],</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">triggers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid value passed for `iterator`, expected an iterator but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">ephemeral_default</span><span class="o">=</span><span class="n">ephemeral_default</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="n">load_from_attributes</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">authors</span><span class="p">))</span> <span class="k">if</span> <span class="n">authors</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]]</span> <span class="o">=</span> <span class="n">iterator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_first</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_previous</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">DANGER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_disable</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">BLACK_CROSS</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_next</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_last</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">builder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a sequence of the component builders for this paginator.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Sequence[hikari.api.ComponentBuilder]</span>
<span class="sd">            The component builders for this paginator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="ow">and</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_pre_execution_error</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="p">,</span> <span class="s2">&quot;You are not allowed to use this button&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_next_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the next entry in this paginator.</span>

<span class="sd">        This is generally helpful for making the message which the paginator will be based off</span>
<span class="sd">        and will still internally store the entry and increment the position of the paginator.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        response_paginator = yuyo.ComponentPaginator(</span>
<span class="sd">            pages,</span>
<span class="sd">            authors=(ctx.author.id,)</span>
<span class="sd">        )</span>
<span class="sd">        first_response = await response_paginator.get_next_entry()</span>
<span class="sd">        assert first_response</span>
<span class="sd">        content, embed = first_response</span>
<span class="sd">        message = await ctx.respond(content=content, embed=embed, component=response_paginator, ensure_result=True)</span>
<span class="sd">        component_client.add_executor(message, response_paginator)</span>
<span class="sd">        ```</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[pagination.EntryT]</span>
<span class="sd">            The next entry in this paginator, or `None` if there are no more entries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check to see if we&#39;re behind the buffer before trying to go forward in the generator.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>

        <span class="c1"># If entry is not None then the generator&#39;s position was pushed forwards.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="ow">and</span> <span class="p">(</span><span class="n">entry</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">pagination</span><span class="o">.</span><span class="n">seek_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">entry</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_noop</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_UPDATE</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">first_entry</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="k">else</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="n">first_entry</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_UPDATE</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noop</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_previous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_UPDATE</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noop</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_disable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">defer</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">DEFERRED_MESSAGE_UPDATE</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
        <span class="k">raise</span> <span class="n">ExecutorClosed</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_last</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span>
            <span class="c1"># TODO: option to not lock on last</span>
            <span class="n">loading_component</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">build_action_row</span><span class="p">()</span>
                <span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="s2">&quot;loading&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">set_is_disabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span><span class="mi">878377505344614461</span><span class="p">)</span>
                <span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_UPDATE</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">loading_component</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="k">await</span> <span class="n">pagination</span><span class="o">.</span><span class="n">collect_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span>
                <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>
                <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="p">(),</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="p">())</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_UPDATE</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noop</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entry</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">():</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">defer</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">DEFERRED_MESSAGE_UPDATE</span><span class="p">)</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="n">entry</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noop</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Higher level client for callback based component execution.</p>
</div>


                </section>
                <section id="AbstractComponentExecutor">
                                <div class="attr class">
        <a class="headerlink" href="#AbstractComponentExecutor">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">AbstractComponentExecutor</span><wbr>(<span class="base">abc.ABC</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AbstractComponentExecutor</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">custom_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this executor has ended.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether this executor has ended.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

        </details>

            <div class="docstring"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p>
</div>


                            <div id="AbstractComponentExecutor.custom_ids" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#AbstractComponentExecutor.custom_ids">#&nbsp;&nbsp</a>

        <span class="name">custom_ids</span><span class="annotation">: Collection[str]</span>
    </div>

    

                            </div>
                            <div id="AbstractComponentExecutor.has_expired" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#AbstractComponentExecutor.has_expired">#&nbsp;&nbsp</a>

        <span class="name">has_expired</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this executor has ended.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: Whether this executor has ended.</li>
</ul>
</div>


                            </div>
                            <div id="AbstractComponentExecutor.execute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#AbstractComponentExecutor.execute">#&nbsp;&nbsp</a>

                <div class="decorator">@abc.abstractmethod</div>

            <span class="def">async def</span>
            <span class="name">execute</span><span class="signature">(
    self,
    _: hikari.interactions.component_interactions.ComponentInteraction,
    /,
    *,
    future: Optional[_asyncio.Future] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

        </details>

    

                            </div>
                </section>
                <section id="ActionRowExecutor">
                                <div class="attr class">
        <a class="headerlink" href="#ActionRowExecutor">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ActionRowExecutor</span><wbr>(<span class="base"><a href="#ComponentExecutor">yuyo.ComponentExecutor</a></span>, <span class="base">hikari.api.special_endpoints.ComponentBuilder</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ActionRowExecutor</span><span class="p">(</span><span class="n">ComponentExecutor</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_components&quot;</span><span class="p">,</span> <span class="s2">&quot;_stored_type&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">ephemeral_default</span><span class="o">=</span><span class="n">ephemeral_default</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="n">load_from_attributes</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stored_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_assert_can_add_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stored_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stored_type</span> <span class="o">!=</span> <span class="n">type_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2"> component type cannot be added to a container which already holds </span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stored_type</span> <span class="o">=</span> <span class="n">type_</span>

    <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ActionRowExecutorT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">add_button</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractiveButtonTypesT</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">custom_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InteractiveButtonBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">add_button</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">LINK</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span>
        <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">LinkButtonBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">add_button</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="p">],</span>
        <span class="n">callback_or_url</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">custom_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
        <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">LinkButtonBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">],</span> <span class="n">InteractiveButtonBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">]</span>
    <span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_can_add_type</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="o">.</span><span class="n">BUTTON</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractiveButtonTypes</span><span class="p">:</span>
            <span class="c1"># Pyright doesn&#39;t properly support _ attrs kwargs</span>
            <span class="k">if</span> <span class="n">custom_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">custom_id</span> <span class="o">=</span> <span class="n">_random_id</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Callback must be passed for an interactive button, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">InteractiveButtonBuilder</span><span class="p">(</span>
                <span class="n">callback</span><span class="o">=</span><span class="n">callback_or_url</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>

        <span class="c1"># Pyright doesn&#39;t properly support _ attrs kwargs</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;String url must be passed for Link style buttons, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">LinkButtonBuilder</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">callback_or_url</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span> <span class="nf">add_select_menu</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">custom_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SelectMenuBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_can_add_type</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="o">.</span><span class="n">SELECT_MENU</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">custom_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">custom_id</span> <span class="o">=</span> <span class="n">_random_id</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">SelectMenuBuilder</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="o">.</span><span class="n">ACTION_ROW</span><span class="p">,</span>
            <span class="s2">&quot;components&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">build</span><span class="p">()</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">],</span>
        <span class="p">}</span>
</pre></div>

        </details>

            <div class="docstring"><p>Base class for all component builder classes.</p>
</div>


                            <div id="ActionRowExecutor.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ActionRowExecutor.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ActionRowExecutor</span><span class="signature">(
    *,
    ephemeral_default: bool = False,
    load_from_attributes: bool = False,
    timeout: datetime.timedelta = datetime.timedelta(seconds=30)
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">ephemeral_default</span><span class="o">=</span><span class="n">ephemeral_default</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="n">load_from_attributes</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stored_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ActionRowExecutor.components" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ActionRowExecutor.components">#&nbsp;&nbsp</a>

        <span class="name">components</span><span class="annotation">: Sequence[hikari.api.special_endpoints.ComponentBuilder]</span>
    </div>

    

                            </div>
                            <div id="ActionRowExecutor.add_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ActionRowExecutor.add_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_component</span><span class="signature">(
    self: ~_ActionRowExecutorT,
    component: hikari.api.special_endpoints.ComponentBuilder,
    /
) -&gt; ~_ActionRowExecutorT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ActionRowExecutorT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ActionRowExecutor.add_button" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ActionRowExecutor.add_button">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_button</span><span class="signature">(
    self: ~_ActionRowExecutorT,
    style: Union[int, hikari.messages.ButtonStyle],
    callback_or_url: Union[Callable[[<a href="yuyo/components.html#ComponentContext">yuyo.components.ComponentContext</a>], Awaitable[NoneType]], str],
    *,
    custom_id: Optional[str] = None
) -&gt; Union[hikari.impl.special_endpoints.LinkButtonBuilder[~_ActionRowExecutorT], <a href="yuyo/components.html#InteractiveButtonBuilder">yuyo.components.InteractiveButtonBuilder</a>[~_ActionRowExecutorT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_button</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="p">],</span>
        <span class="n">callback_or_url</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">custom_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
        <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">LinkButtonBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">],</span> <span class="n">InteractiveButtonBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">]</span>
    <span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_can_add_type</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="o">.</span><span class="n">BUTTON</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractiveButtonTypes</span><span class="p">:</span>
            <span class="c1"># Pyright doesn&#39;t properly support _ attrs kwargs</span>
            <span class="k">if</span> <span class="n">custom_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">custom_id</span> <span class="o">=</span> <span class="n">_random_id</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Callback must be passed for an interactive button, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">InteractiveButtonBuilder</span><span class="p">(</span>
                <span class="n">callback</span><span class="o">=</span><span class="n">callback_or_url</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>

        <span class="c1"># Pyright doesn&#39;t properly support _ attrs kwargs</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;String url must be passed for Link style buttons, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">callback_or_url</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">LinkButtonBuilder</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">callback_or_url</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ActionRowExecutor.add_select_menu" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ActionRowExecutor.add_select_menu">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_select_menu</span><span class="signature">(
    self: ~_ActionRowExecutorT,
    callback: Callable[[<a href="yuyo/components.html#ComponentContext">yuyo.components.ComponentContext</a>], Awaitable[NoneType]],
    /,
    custom_id: Optional[str] = None
) -&gt; <a href="yuyo/components.html#SelectMenuBuilder">yuyo.components.SelectMenuBuilder</a>[~_ActionRowExecutorT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_select_menu</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ActionRowExecutorT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">custom_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SelectMenuBuilder</span><span class="p">[</span><span class="n">_ActionRowExecutorT</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_can_add_type</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="o">.</span><span class="n">SELECT_MENU</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">custom_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">custom_id</span> <span class="o">=</span> <span class="n">_random_id</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">SelectMenuBuilder</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ActionRowExecutor.build" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ActionRowExecutor.build">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">build</span><span class="signature">(self) -&gt; Dict[str, Any]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentType</span><span class="o">.</span><span class="n">ACTION_ROW</span><span class="p">,</span>
            <span class="s2">&quot;components&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">build</span><span class="p">()</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">],</span>
        <span class="p">}</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a JSON object from this builder.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.internal.data_binding.JSONObject</strong>: The built json object representation of this builder.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ComponentExecutor">ComponentExecutor</a></dt>
                                <dd id="ActionRowExecutor.callbacks" class="variable"><a href="#ComponentExecutor.callbacks">callbacks</a></dd>
                <dd id="ActionRowExecutor.custom_ids" class="variable"><a href="#ComponentExecutor.custom_ids">custom_ids</a></dd>
                <dd id="ActionRowExecutor.has_expired" class="variable"><a href="#ComponentExecutor.has_expired">has_expired</a></dd>
                <dd id="ActionRowExecutor.execute" class="function"><a href="#ComponentExecutor.execute">execute</a></dd>
                <dd id="ActionRowExecutor.add_callback" class="function"><a href="#ComponentExecutor.add_callback">add_callback</a></dd>
                <dd id="ActionRowExecutor.with_callback" class="function"><a href="#ComponentExecutor.with_callback">with_callback</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="as_child_executor">
                            <div class="attr function"><a class="headerlink" href="#as_child_executor">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_child_executor</span><span class="signature">(
    executor: Type[~AbstractComponentExecutorT],
    /
) -&gt; Type[~AbstractComponentExecutorT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_child_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="n">AbstractComponentExecutorT</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="n">AbstractComponentExecutorT</span><span class="p">]:</span>
    <span class="n">executor</span><span class="o">.</span><span class="n">__is_child_executor__</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># type: ignore</span>
    <span class="k">return</span> <span class="n">executor</span>
</pre></div>

        </details>

    

                </section>
                <section id="as_component_callback">
                            <div class="attr function"><a class="headerlink" href="#as_component_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_component_callback</span><span class="signature">(custom_id: str, /) -&gt; Callable[[~CallbackSigT], ~CallbackSigT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_component_callback</span><span class="p">(</span><span class="n">custom_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSigT</span><span class="p">],</span> <span class="n">CallbackSigT</span><span class="p">]:</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSigT</span><span class="p">:</span>
        <span class="n">callback</span><span class="o">.</span><span class="n">__custom_id__</span> <span class="o">=</span> <span class="n">custom_id</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

    

                </section>
                <section id="ChildActionRowExecutor">
                                <div class="attr class">
        <a class="headerlink" href="#ChildActionRowExecutor">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ChildActionRowExecutor</span><wbr>(<span class="base"><a href="#ActionRowExecutor">yuyo.ActionRowExecutor</a></span>, <span class="base">typing.Generic[~ParentExecutorProtoT]</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ChildActionRowExecutor</span><span class="p">(</span><span class="n">ActionRowExecutor</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">ParentExecutorProtoT</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Extended implementation of `ActionRowExecutor` which can be tied to a `MultiComponentExecutor`.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_parent&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">ParentExecutorProtoT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ephemeral_default</span><span class="o">=</span><span class="n">ephemeral_default</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="n">load_from_attributes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>

    <span class="k">def</span> <span class="nf">add_to_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParentExecutorProtoT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add this action row to its parent executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ParentExecutorProtoT</span>
<span class="sd">            The parent executor this action row was added to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add_executor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Extended implementation of <code><a href="#ActionRowExecutor">ActionRowExecutor</a></code> which can be tied to a <code><a href="#MultiComponentExecutor">MultiComponentExecutor</a></code>.</p>
</div>


                            <div id="ChildActionRowExecutor.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ChildActionRowExecutor.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ChildActionRowExecutor</span><span class="signature">(
    parent: ~ParentExecutorProtoT,
    *,
    ephemeral_default: bool = False,
    load_from_attributes: bool = False
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">ParentExecutorProtoT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ephemeral_default</span><span class="o">=</span><span class="n">ephemeral_default</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="n">load_from_attributes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ChildActionRowExecutor.add_to_parent" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ChildActionRowExecutor.add_to_parent">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_to_parent</span><span class="signature">(self) -&gt; ~ParentExecutorProtoT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_to_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParentExecutorProtoT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add this action row to its parent executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ParentExecutorProtoT</span>
<span class="sd">            The parent executor this action row was added to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add_executor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add this action row to its parent executor.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ParentExecutorProtoT</strong>: The parent executor this action row was added to.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ActionRowExecutor">ActionRowExecutor</a></dt>
                                <dd id="ChildActionRowExecutor.components" class="variable"><a href="#ActionRowExecutor.components">components</a></dd>
                <dd id="ChildActionRowExecutor.add_component" class="function"><a href="#ActionRowExecutor.add_component">add_component</a></dd>
                <dd id="ChildActionRowExecutor.add_button" class="function"><a href="#ActionRowExecutor.add_button">add_button</a></dd>
                <dd id="ChildActionRowExecutor.add_select_menu" class="function"><a href="#ActionRowExecutor.add_select_menu">add_select_menu</a></dd>
                <dd id="ChildActionRowExecutor.build" class="function"><a href="#ActionRowExecutor.build">build</a></dd>

            </div>
            <div><dt><a href="#ComponentExecutor">ComponentExecutor</a></dt>
                                <dd id="ChildActionRowExecutor.callbacks" class="variable"><a href="#ComponentExecutor.callbacks">callbacks</a></dd>
                <dd id="ChildActionRowExecutor.custom_ids" class="variable"><a href="#ComponentExecutor.custom_ids">custom_ids</a></dd>
                <dd id="ChildActionRowExecutor.has_expired" class="variable"><a href="#ComponentExecutor.has_expired">has_expired</a></dd>
                <dd id="ChildActionRowExecutor.execute" class="function"><a href="#ComponentExecutor.execute">execute</a></dd>
                <dd id="ChildActionRowExecutor.add_callback" class="function"><a href="#ComponentExecutor.add_callback">add_callback</a></dd>
                <dd id="ChildActionRowExecutor.with_callback" class="function"><a href="#ComponentExecutor.with_callback">with_callback</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ComponentClient">
                                <div class="attr class">
        <a class="headerlink" href="#ComponentClient">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ComponentClient</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ComponentClient</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Client used to handle component executors within a REST or gateway flow.</span>

<span class="sd">    .. note::</span>
<span class="sd">        For an easier way to initialise the client from a bot see</span>
<span class="sd">        `ComponentClient.from_gateway_bot` and `ComponentClient.from_rest_bot`.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    event_manager : typing.Optional[hikari.api.EventManager]</span>
<span class="sd">        The event manager this client should listen to dispatched component</span>
<span class="sd">        interactions from if applicable.</span>
<span class="sd">    event_managed : bool</span>
<span class="sd">        Whether this client should be automatically opened and closed based on</span>
<span class="sd">        the lifetime events dispatched by `event_manager`.</span>

<span class="sd">        Defaults to `True` if an event manager is passed.</span>
<span class="sd">    server : typing.Optional[hikari.api.InteractionServer]</span>
<span class="sd">        The server this client should listen to component interactions</span>
<span class="sd">        from if applicable.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If `event_managed` is passed as `True` when `event_manager` is None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_event_manager&quot;</span><span class="p">,</span> <span class="s2">&quot;_executors&quot;</span><span class="p">,</span> <span class="s2">&quot;_gc_task&quot;</span><span class="p">,</span> <span class="s2">&quot;_server&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">event_manager</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">server</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span> <span class="o">=</span> <span class="n">event_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">AbstractComponentExecutor</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>

        <span class="k">if</span> <span class="n">event_managed</span> <span class="ow">or</span> <span class="n">event_managed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">event_manager</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">event_manager</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;event_managed may only be passed when an event_manager is also passed&quot;</span><span class="p">)</span>

            <span class="n">event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting</span><span class="p">)</span>
            <span class="n">event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exc_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">exc</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
        <span class="n">exc_traceback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">types</span><span class="o">.</span><span class="n">TracebackType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComponentClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a component client froma Gateway Bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The Gateway bot this component client should be bound to.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether the component client should be automatically opened and</span>
<span class="sd">            closed based on the lifetime events dispatched by `bot`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ComponentClient</span>
<span class="sd">            The initialised component client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">event_manager</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span> <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rest_bot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">traits</span><span class="o">.</span><span class="n">RESTBotAware</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComponentClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a component client froma REST Bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.RESTBotAware</span>
<span class="sd">            The REST bot this component client should be bound to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ComponentClient</span>
<span class="sd">            The initialised component client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">server</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">interaction_server</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_starting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_stopping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_gc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">message_id</span><span class="p">,</span> <span class="n">executor</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">executor</span><span class="o">.</span><span class="n">has_expired</span> <span class="ow">or</span> <span class="n">message_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">[</span><span class="n">message_id</span><span class="p">]</span>
                <span class="c1"># This may slow this gc task down but the more we yield the better.</span>
                <span class="c1"># await executor.close()  # TODO: this</span>

            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># TODO: is this a good time?</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the component client.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_gateway_event</span><span class="p">)</span>

        <span class="c1"># executor = self._executors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># for executor in executor.values():  # TODO: finish</span>
        <span class="c1">#     executor.close()</span>

    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Startup the component client.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gc</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_rest_request</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_gateway_event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_execute_executor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">executor</span><span class="p">:</span> <span class="n">AbstractComponentExecutor</span><span class="p">,</span>
        <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ExecutorClosed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_gateway_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">executor</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span> <span class="s2">&quot;This message has timed-out.&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_rest_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResponseT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">executor</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">executor</span><span class="o">.</span><span class="n">has_expired</span><span class="p">:</span>
                <span class="n">future</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_execute_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">,</span> <span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">))</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">[</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">interaction</span><span class="o">.</span><span class="n">build_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="s2">&quot;This message has timed-out.&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_executor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentClientT</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span> <span class="n">executor</span><span class="p">:</span> <span class="n">AbstractComponentExecutor</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentClientT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">message</span><span class="p">)]</span> <span class="o">=</span> <span class="n">executor</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Client used to handle component executors within a REST or gateway flow.</p>

<p><em>Note:</em>
For an easier way to initialise the client from a bot see
<code><a href="#ComponentClient.from_gateway_bot">ComponentClient.from_gateway_bot</a></code> and <code><a href="#ComponentClient.from_rest_bot">ComponentClient.from_rest_bot</a></code>.</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>event_manager</strong> (typing.Optional[hikari.api.EventManager]):
The event manager this client should listen to dispatched component
interactions from if applicable.</li>
<li><p><strong>event_managed</strong> (bool):
Whether this client should be automatically opened and closed based on
the lifetime events dispatched by <code>event_manager</code>.</p>

<p>Defaults to <code>True</code> if an event manager is passed.</p></li>
<li><strong>server</strong> (typing.Optional[hikari.api.InteractionServer]):
The server this client should listen to component interactions
from if applicable.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If <code>event_managed</code> is passed as <code>True</code> when <code>event_manager</code> is None.</li>
</ul>
</div>


                            <div id="ComponentClient.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentClient.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ComponentClient</span><span class="signature">(
    *,
    event_manager: Optional[hikari.api.event_manager.EventManager] = None,
    event_managed: Optional[bool] = None,
    server: Optional[hikari.api.interaction_server.InteractionServer] = None
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">event_manager</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">server</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span> <span class="o">=</span> <span class="n">event_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">AbstractComponentExecutor</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>

        <span class="k">if</span> <span class="n">event_managed</span> <span class="ow">or</span> <span class="n">event_managed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">event_manager</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">event_manager</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;event_managed may only be passed when an event_manager is also passed&quot;</span><span class="p">)</span>

            <span class="n">event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting</span><span class="p">)</span>
            <span class="n">event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentClient.from_gateway_bot" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentClient.from_gateway_bot">#&nbsp;&nbsp</a>

                <div class="decorator">@classmethod</div>

            <span class="def">def</span>
            <span class="name">from_gateway_bot</span><span class="signature">(
    cls,
    bot: hikari.traits.GatewayBotAware,
    /,
    *,
    event_managed: bool = True
) -&gt; <a href="yuyo/components.html#ComponentClient">yuyo.components.ComponentClient</a></span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComponentClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a component client froma Gateway Bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The Gateway bot this component client should be bound to.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether the component client should be automatically opened and</span>
<span class="sd">            closed based on the lifetime events dispatched by `bot`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ComponentClient</span>
<span class="sd">            The initialised component client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">event_manager</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span> <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a component client froma Gateway Bot.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>bot</strong> (hikari.traits.GatewayBotAware):
The Gateway bot this component client should be bound to.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>event_managed</strong> (bool):
Whether the component client should be automatically opened and
closed based on the lifetime events dispatched by <code>bot</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ComponentClient</strong>: The initialised component client.</li>
</ul>
</div>


                            </div>
                            <div id="ComponentClient.from_rest_bot" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentClient.from_rest_bot">#&nbsp;&nbsp</a>

                <div class="decorator">@classmethod</div>

            <span class="def">def</span>
            <span class="name">from_rest_bot</span><span class="signature">(
    cls,
    bot: hikari.traits.RESTBotAware,
    /
) -&gt; <a href="yuyo/components.html#ComponentClient">yuyo.components.ComponentClient</a></span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rest_bot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">traits</span><span class="o">.</span><span class="n">RESTBotAware</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComponentClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a component client froma REST Bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.RESTBotAware</span>
<span class="sd">            The REST bot this component client should be bound to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ComponentClient</span>
<span class="sd">            The initialised component client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">server</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">interaction_server</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a component client froma REST Bot.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>bot</strong> (hikari.traits.RESTBotAware):
The REST bot this component client should be bound to.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ComponentClient</strong>: The initialised component client.</li>
</ul>
</div>


                            </div>
                            <div id="ComponentClient.close" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentClient.close">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">close</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the component client.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_gateway_event</span><span class="p">)</span>

        <span class="c1"># executor = self._executors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># for executor in executor.values():  # TODO: finish</span>
        <span class="c1">#     executor.close()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Close the component client.</p>
</div>


                            </div>
                            <div id="ComponentClient.open" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentClient.open">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">open</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Startup the component client.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gc</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_rest_request</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_gateway_event</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Startup the component client.</p>
</div>


                            </div>
                            <div id="ComponentClient.on_gateway_event" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentClient.on_gateway_event">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">on_gateway_event</span><span class="signature">(
    self,
    event: hikari.events.interaction_events.InteractionCreateEvent,
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_gateway_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">executor</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span> <span class="s2">&quot;This message has timed-out.&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span>
            <span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentClient.on_rest_request" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentClient.on_rest_request">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">on_rest_request</span><span class="signature">(
    self,
    interaction: hikari.interactions.component_interactions.ComponentInteraction,
    /
) -&gt; Union[hikari.api.special_endpoints.InteractionMessageBuilder, hikari.api.special_endpoints.InteractionDeferredBuilder]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_rest_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResponseT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">executor</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">executor</span><span class="o">.</span><span class="n">has_expired</span><span class="p">:</span>
                <span class="n">future</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_execute_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">,</span> <span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">))</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">[</span><span class="n">interaction</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">interaction</span><span class="o">.</span><span class="n">build_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="s2">&quot;This message has timed-out.&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentClient.add_executor" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentClient.add_executor">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_executor</span><span class="signature">(
    self: ~_ComponentClientT,
    message: Union[hikari.messages.Message, hikari.snowflakes.Snowflake, int],
    executor: <a href="yuyo/components.html#AbstractComponentExecutor">yuyo.components.AbstractComponentExecutor</a>,
    /
) -&gt; ~_ComponentClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_executor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentClientT</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span> <span class="n">executor</span><span class="p">:</span> <span class="n">AbstractComponentExecutor</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentClientT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">message</span><span class="p">)]</span> <span class="o">=</span> <span class="n">executor</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                </section>
                <section id="ComponentContext">
                                <div class="attr class">
        <a class="headerlink" href="#ComponentContext">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ComponentContext</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ComponentContext</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The general context passed around for a component trigger.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_ephemeral_default&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_has_responded&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_has_been_deferred&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_interaction&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_last_response_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_response_future&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_response_lock&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span>
        <span class="n">response_future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span> <span class="o">=</span> <span class="n">interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span> <span class="o">=</span> <span class="n">response_future</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_been_deferred</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this context&#39;s initial response has been deferred.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether this context&#39;s initial response has been deferred.</span>

<span class="sd">            This will be true if `ComponentContext.defer` has been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_responded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether an initial response has been made to this context yet.</span>

<span class="sd">        It&#39;s worth noting that a context must be either responded to or</span>
<span class="sd">        deferred within 3 seconds from it being received otherwise it&#39;ll be</span>
<span class="sd">        marked as failed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether an initial response has been made to this context yet.</span>

<span class="sd">            This will be true if either `CompontentContext.respond`,</span>
<span class="sd">            `ComponentContext.create_initial_response` or</span>
<span class="sd">            `ComponentContext.edit_initial_response` (after a deferral) has been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Object of the interaction this context is for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.ComponentInteraction</span>
<span class="sd">            The interaction this context is for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span>

    <span class="k">def</span> <span class="nf">_get_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">flags</span>

        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="k">else</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">NONE</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">defer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">defer_type</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">DeferredResponseTypesT</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Mark this context as deferred.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        defer_type : hikari.DeferredResponseTypesT</span>
<span class="sd">            The type of deferral this should be.</span>

<span class="sd">            This may either be `hikari.ResponseType.DEFERRED_MESSAGE_CREATE` to</span>
<span class="sd">            indicate that the following up call to `ComponentContext.edit_initial_response`</span>
<span class="sd">            or `ComponentContext.respond` should create a new message or</span>
<span class="sd">            `hikari.ResponseType.DEFERRED_MESSAGE_UPDATE` to indicate that the following</span>
<span class="sd">            call to the aforementioned methods should update the existing message.</span>
<span class="sd">        flags : typing.Union[hikari.UndefinedType, int, hikari.MessageFlag]</span>
<span class="sd">            The flags to set for this deferral.</span>

<span class="sd">            As of writing, the only message flag which can be set here is</span>
<span class="sd">            `hikari.MessageFlag.EPHEMERAL` which indicates that the deferred</span>
<span class="sd">            message create should be only visible by the interaction&#39;s author.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Context has already been responded to&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">build_deferred_response</span><span class="p">(</span><span class="n">defer_type</span><span class="p">)</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">defer_type</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_followup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Respond to this context with a followup message.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : hikari.UndefinedOr[typing.Any]</span>
<span class="sd">            The content to respond with.</span>

<span class="sd">            If provided, the message contents. If</span>
<span class="sd">            `hikari.undefined.UNDEFINED`, then nothing will be sent</span>
<span class="sd">            in the content. Any other value here will be cast to a</span>
<span class="sd">            `str`.</span>

<span class="sd">            If this is a `hikari.embeds.Embed` and no `embed` nor `embeds` kwarg</span>
<span class="sd">            is provided, then this will instead update the embed. This allows</span>
<span class="sd">            for simpler syntax when sending an embed alone.</span>

<span class="sd">            Likewise, if this is a `hikari.files.Resource`, then the</span>
<span class="sd">            content is instead treated as an attachment if no `attachment` and</span>
<span class="sd">            no `attachments` kwargs are provided.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        ensure_result : bool</span>
<span class="sd">            This parameter does nothing but necessary to keep the signature with `Context`.</span>
<span class="sd">        tts : hikari.UndefinedOr[bool]</span>
<span class="sd">            Whether to respond with tts/text to speech or no.</span>
<span class="sd">        reply : hikari.Undefinedor[hikari.SnowflakeishOr[hikari.PartialMessage]]</span>
<span class="sd">            Whether to reply instead of sending the content to the context.</span>
<span class="sd">        nonce : hikari.UndefinedOr[str]</span>
<span class="sd">            The nonce that validates that the message was sent.</span>
<span class="sd">        attachment : hikari.UndefinedOr[hikari.Resourceish]</span>
<span class="sd">            A singular attachment to respond with.</span>
<span class="sd">        attachments : hikari.UndefinedOr[collections.Sequence[hikari.Resourceish]]</span>
<span class="sd">            A sequence of attachments to respond with.</span>
<span class="sd">        component : hikari.undefined.UndefinedOr[hikari.api.special_endpoints.ComponentBuilder]</span>
<span class="sd">            If provided, builder object of the component to include in this message.</span>
<span class="sd">        components : hikari.undefined.UndefinedOr[typing.Sequence[hikari.api.special_endpoints.ComponentBuilder]]</span>
<span class="sd">            If provided, a sequence of the component builder objects to include</span>
<span class="sd">            in this message.</span>
<span class="sd">        embed : hikari.UndefinedOr[hikari.Embed]</span>
<span class="sd">            An embed to respond with.</span>
<span class="sd">        embeds : hikari.UndefinedOr[collections.Sequence[hikari.Embed]]</span>
<span class="sd">            A sequence of embeds to respond with.</span>
<span class="sd">        mentions_everyone : hikari.undefined.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message should parse @everyone/@here</span>
<span class="sd">            mentions.</span>
<span class="sd">        user_mentions : hikari.undefined.UndefinedOr[typing.Union[hikari.snowflakes.SnowflakeishSequence[hikari.users.PartialUser], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>
<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.snowflakes.Snowflake`, or `hikari.users.PartialUser`</span>
<span class="sd">            derivatives to enforce mentioning specific users.</span>
<span class="sd">        role_mentions : hikari.undefined.UndefinedOr[typing.Union[hikari.snowflakes.SnowflakeishSequence[hikari.guilds.PartialRole], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>
<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.snowflakes.Snowflake`, or</span>
<span class="sd">            `hikari.guilds.PartialRole` derivatives to enforce mentioning</span>
<span class="sd">            specific roles.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Attachments can be passed as many different things, to aid in</span>
<span class="sd">        convenience.</span>
<span class="sd">        * If a `pathlib.PurePath` or `str` to a valid URL, the</span>
<span class="sd">            resource at the given URL will be streamed to Discord when</span>
<span class="sd">            sending the message. Subclasses of</span>
<span class="sd">            `hikari.files.WebResource` such as</span>
<span class="sd">            `hikari.files.URL`,</span>
<span class="sd">            `hikari.messages.Attachment`,</span>
<span class="sd">            `hikari.emojis.Emoji`,</span>
<span class="sd">            `EmbedResource`, etc will also be uploaded this way.</span>
<span class="sd">            This will use bit-inception, so only a small percentage of the</span>
<span class="sd">            resource will remain in memory at any one time, thus aiding in</span>
<span class="sd">            scalability.</span>
<span class="sd">        * If a `hikari.files.Bytes` is passed, or a `str`</span>
<span class="sd">            that contains a valid data URI is passed, then this is uploaded</span>
<span class="sd">            with a randomized file name if not provided.</span>
<span class="sd">        * If a `hikari.files.File`, `pathlib.PurePath` or</span>
<span class="sd">            `str` that is an absolute or relative path to a file</span>
<span class="sd">            on your file system is passed, then this resource is uploaded</span>
<span class="sd">            as an attachment using non-blocking code internally and streamed</span>
<span class="sd">            using bit-inception where possible. This depends on the</span>
<span class="sd">            type of `concurrent.futures.Executor` that is being used for</span>
<span class="sd">            the application (default is a thread pool which supports this</span>
<span class="sd">            behaviour).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.messages.Message</span>
<span class="sd">            The message that has been created.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If more than 100 unique objects/entities are passed for</span>
<span class="sd">            `role_mentions` or `user_mentions`.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If both `attachment` and `attachments` are specified.</span>
<span class="sd">        hikari.errors.BadRequestError</span>
<span class="sd">            This may be raised in several discrete situations, such as messages</span>
<span class="sd">            being empty with no attachments or embeds; messages with more than</span>
<span class="sd">            2000 characters in them, embeds that exceed one of the many embed</span>
<span class="sd">            limits; too many attachments; attachments that are too large;</span>
<span class="sd">            invalid image URLs in embeds; if `reply` is not found or not in the</span>
<span class="sd">            same channel as `channel`; too many components.</span>
<span class="sd">        hikari.errors.UnauthorizedError</span>
<span class="sd">            If you are unauthorized to make the request (invalid/missing token).</span>
<span class="sd">        hikari.errors.ForbiddenError</span>
<span class="sd">            If you are missing the `SEND_MESSAGES` in the channel or the</span>
<span class="sd">            person you are trying to message has the DM&#39;s disabled.</span>
<span class="sd">        hikari.errors.NotFoundError</span>
<span class="sd">            If the channel is not found.</span>
<span class="sd">        hikari.errors.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.errors.RateLimitedError</span>
<span class="sd">            Usually, Hikari will handle and retry on hitting</span>
<span class="sd">            rate-limits automatically. This includes most bucket-specific</span>
<span class="sd">            rate-limits and global rate-limits. In some rare edge cases,</span>
<span class="sd">            however, Discord implements other undocumented rules for</span>
<span class="sd">            rate-limiting, such as limits per attribute. These cannot be</span>
<span class="sd">            detected or handled normally by Hikari due to their undocumented</span>
<span class="sd">            nature, and will trigger this exception if they occur.</span>
<span class="sd">        hikari.errors.InternalServerError</span>
<span class="sd">            If an internal error occurs on Discord while handling the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - Line too long</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>
            <span class="k">return</span> <span class="n">message</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">response_type</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentResponseTypesT</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Initial response has already been created&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;edit_initial_response must be used to set the initial response after a context has been deferred&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
                <span class="n">response_type</span><span class="o">=</span><span class="n">response_type</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">component</span> <span class="ow">and</span> <span class="n">components</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of component or components may be passed&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">embed</span> <span class="ow">and</span> <span class="n">embeds</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of embed or embeds may be passed&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">component</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">)</span>
                <span class="n">components</span> <span class="o">=</span> <span class="p">(</span><span class="n">component</span><span class="p">,)</span>

            <span class="k">if</span> <span class="n">embed</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">embed</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">)</span>
                <span class="n">embeds</span> <span class="o">=</span> <span class="p">(</span><span class="n">embed</span><span class="p">,)</span>

            <span class="c1"># Pyright doesn&#39;t properly support attrs and doesn&#39;t account for _ being removed from field</span>
            <span class="c1"># pre-fix in init.</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">InteractionMessageBuilder</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">response_type</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">is_tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>  <span class="c1"># type: ignore</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">response_type</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageResponseTypesT</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">response_type</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no last response&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_last_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous responses&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous known responses&quot;</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                    <span class="n">content</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>
                <span class="k">return</span> <span class="n">message</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                    <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">ensure_result</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>The general context passed around for a component trigger.</p>
</div>


                            <div id="ComponentContext.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ComponentContext</span><span class="signature">(
    *,
    ephemeral_default: bool,
    interaction: hikari.interactions.component_interactions.ComponentInteraction,
    response_future: Optional[_asyncio.Future] = None
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span>
        <span class="n">response_future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span> <span class="o">=</span> <span class="n">interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span> <span class="o">=</span> <span class="n">response_future</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentContext.has_been_deferred" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ComponentContext.has_been_deferred">#&nbsp;&nbsp</a>

        <span class="name">has_been_deferred</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this context's initial response has been deferred.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: Whether this context's initial response has been deferred.</li>
</ul>

<p>This will be true if <code><a href="#ComponentContext.defer">ComponentContext.defer</a></code> has been called.</p>
</div>


                            </div>
                            <div id="ComponentContext.has_responded" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ComponentContext.has_responded">#&nbsp;&nbsp</a>

        <span class="name">has_responded</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether an initial response has been made to this context yet.</p>

<p>It's worth noting that a context must be either responded to or
deferred within 3 seconds from it being received otherwise it'll be
marked as failed.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: Whether an initial response has been made to this context yet.</li>
</ul>

<p>This will be true if either <code>CompontentContext.respond</code>,
<code><a href="#ComponentContext.create_initial_response">ComponentContext.create_initial_response</a></code> or
<code><a href="#ComponentContext.edit_initial_response">ComponentContext.edit_initial_response</a></code> (after a deferral) has been called.</p>
</div>


                            </div>
                            <div id="ComponentContext.interaction" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ComponentContext.interaction">#&nbsp;&nbsp</a>

        <span class="name">interaction</span><span class="annotation">: hikari.interactions.component_interactions.ComponentInteraction</span>
    </div>

            <div class="docstring"><p>Object of the interaction this context is for.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.ComponentInteraction</strong>: The interaction this context is for.</li>
</ul>
</div>


                            </div>
                            <div id="ComponentContext.defer" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.defer">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">defer</span><span class="signature">(
    self,
    defer_type: Literal[&lt;ResponseType.DEFERRED_MESSAGE_CREATE: 5&gt;, 5, &lt;ResponseType.DEFERRED_MESSAGE_UPDATE: 6&gt;, 6],
    flags: Union[hikari.undefined.UndefinedType, int, hikari.messages.MessageFlag] = UNDEFINED
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">defer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">defer_type</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">DeferredResponseTypesT</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Mark this context as deferred.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        defer_type : hikari.DeferredResponseTypesT</span>
<span class="sd">            The type of deferral this should be.</span>

<span class="sd">            This may either be `hikari.ResponseType.DEFERRED_MESSAGE_CREATE` to</span>
<span class="sd">            indicate that the following up call to `ComponentContext.edit_initial_response`</span>
<span class="sd">            or `ComponentContext.respond` should create a new message or</span>
<span class="sd">            `hikari.ResponseType.DEFERRED_MESSAGE_UPDATE` to indicate that the following</span>
<span class="sd">            call to the aforementioned methods should update the existing message.</span>
<span class="sd">        flags : typing.Union[hikari.UndefinedType, int, hikari.MessageFlag]</span>
<span class="sd">            The flags to set for this deferral.</span>

<span class="sd">            As of writing, the only message flag which can be set here is</span>
<span class="sd">            `hikari.MessageFlag.EPHEMERAL` which indicates that the deferred</span>
<span class="sd">            message create should be only visible by the interaction&#39;s author.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Context has already been responded to&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">build_deferred_response</span><span class="p">(</span><span class="n">defer_type</span><span class="p">)</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">defer_type</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Mark this context as deferred.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>defer_type</strong> (hikari.DeferredResponseTypesT):
The type of deferral this should be.</p>

<p>This may either be <code>hikari.ResponseType.DEFERRED_MESSAGE_CREATE</code> to
indicate that the following up call to <code><a href="#ComponentContext.edit_initial_response">ComponentContext.edit_initial_response</a></code>
or <code><a href="#ComponentContext.respond">ComponentContext.respond</a></code> should create a new message or
<code>hikari.ResponseType.DEFERRED_MESSAGE_UPDATE</code> to indicate that the following
call to the aforementioned methods should update the existing message.</p></li>
<li><p><strong>flags</strong> (typing.Union[hikari.UndefinedType, int, hikari.MessageFlag]):
The flags to set for this deferral.</p>

<p>As of writing, the only message flag which can be set here is
<code>hikari.MessageFlag.EPHEMERAL</code> which indicates that the deferred
message create should be only visible by the interaction's author.</p></li>
</ul>
</div>


                            </div>
                            <div id="ComponentContext.create_followup" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.create_followup">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">create_followup</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    attachment: &#39;hikari.UndefinedOr[hikari.Resourceish]&#39; = UNDEFINED,
    attachments: &#39;hikari.UndefinedOr[typing.Sequence[hikari.Resourceish]]&#39; = UNDEFINED,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType] = UNDEFINED,
    components: Union[Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType] = UNDEFINED,
    embeds: Union[Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType] = UNDEFINED,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    tts: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    flags: Union[hikari.undefined.UndefinedType, int, hikari.messages.MessageFlag] = UNDEFINED
) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_followup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Respond to this context with a followup message.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : hikari.UndefinedOr[typing.Any]</span>
<span class="sd">            The content to respond with.</span>

<span class="sd">            If provided, the message contents. If</span>
<span class="sd">            `hikari.undefined.UNDEFINED`, then nothing will be sent</span>
<span class="sd">            in the content. Any other value here will be cast to a</span>
<span class="sd">            `str`.</span>

<span class="sd">            If this is a `hikari.embeds.Embed` and no `embed` nor `embeds` kwarg</span>
<span class="sd">            is provided, then this will instead update the embed. This allows</span>
<span class="sd">            for simpler syntax when sending an embed alone.</span>

<span class="sd">            Likewise, if this is a `hikari.files.Resource`, then the</span>
<span class="sd">            content is instead treated as an attachment if no `attachment` and</span>
<span class="sd">            no `attachments` kwargs are provided.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        ensure_result : bool</span>
<span class="sd">            This parameter does nothing but necessary to keep the signature with `Context`.</span>
<span class="sd">        tts : hikari.UndefinedOr[bool]</span>
<span class="sd">            Whether to respond with tts/text to speech or no.</span>
<span class="sd">        reply : hikari.Undefinedor[hikari.SnowflakeishOr[hikari.PartialMessage]]</span>
<span class="sd">            Whether to reply instead of sending the content to the context.</span>
<span class="sd">        nonce : hikari.UndefinedOr[str]</span>
<span class="sd">            The nonce that validates that the message was sent.</span>
<span class="sd">        attachment : hikari.UndefinedOr[hikari.Resourceish]</span>
<span class="sd">            A singular attachment to respond with.</span>
<span class="sd">        attachments : hikari.UndefinedOr[collections.Sequence[hikari.Resourceish]]</span>
<span class="sd">            A sequence of attachments to respond with.</span>
<span class="sd">        component : hikari.undefined.UndefinedOr[hikari.api.special_endpoints.ComponentBuilder]</span>
<span class="sd">            If provided, builder object of the component to include in this message.</span>
<span class="sd">        components : hikari.undefined.UndefinedOr[typing.Sequence[hikari.api.special_endpoints.ComponentBuilder]]</span>
<span class="sd">            If provided, a sequence of the component builder objects to include</span>
<span class="sd">            in this message.</span>
<span class="sd">        embed : hikari.UndefinedOr[hikari.Embed]</span>
<span class="sd">            An embed to respond with.</span>
<span class="sd">        embeds : hikari.UndefinedOr[collections.Sequence[hikari.Embed]]</span>
<span class="sd">            A sequence of embeds to respond with.</span>
<span class="sd">        mentions_everyone : hikari.undefined.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message should parse @everyone/@here</span>
<span class="sd">            mentions.</span>
<span class="sd">        user_mentions : hikari.undefined.UndefinedOr[typing.Union[hikari.snowflakes.SnowflakeishSequence[hikari.users.PartialUser], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>
<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.snowflakes.Snowflake`, or `hikari.users.PartialUser`</span>
<span class="sd">            derivatives to enforce mentioning specific users.</span>
<span class="sd">        role_mentions : hikari.undefined.UndefinedOr[typing.Union[hikari.snowflakes.SnowflakeishSequence[hikari.guilds.PartialRole], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>
<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.snowflakes.Snowflake`, or</span>
<span class="sd">            `hikari.guilds.PartialRole` derivatives to enforce mentioning</span>
<span class="sd">            specific roles.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Attachments can be passed as many different things, to aid in</span>
<span class="sd">        convenience.</span>
<span class="sd">        * If a `pathlib.PurePath` or `str` to a valid URL, the</span>
<span class="sd">            resource at the given URL will be streamed to Discord when</span>
<span class="sd">            sending the message. Subclasses of</span>
<span class="sd">            `hikari.files.WebResource` such as</span>
<span class="sd">            `hikari.files.URL`,</span>
<span class="sd">            `hikari.messages.Attachment`,</span>
<span class="sd">            `hikari.emojis.Emoji`,</span>
<span class="sd">            `EmbedResource`, etc will also be uploaded this way.</span>
<span class="sd">            This will use bit-inception, so only a small percentage of the</span>
<span class="sd">            resource will remain in memory at any one time, thus aiding in</span>
<span class="sd">            scalability.</span>
<span class="sd">        * If a `hikari.files.Bytes` is passed, or a `str`</span>
<span class="sd">            that contains a valid data URI is passed, then this is uploaded</span>
<span class="sd">            with a randomized file name if not provided.</span>
<span class="sd">        * If a `hikari.files.File`, `pathlib.PurePath` or</span>
<span class="sd">            `str` that is an absolute or relative path to a file</span>
<span class="sd">            on your file system is passed, then this resource is uploaded</span>
<span class="sd">            as an attachment using non-blocking code internally and streamed</span>
<span class="sd">            using bit-inception where possible. This depends on the</span>
<span class="sd">            type of `concurrent.futures.Executor` that is being used for</span>
<span class="sd">            the application (default is a thread pool which supports this</span>
<span class="sd">            behaviour).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.messages.Message</span>
<span class="sd">            The message that has been created.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If more than 100 unique objects/entities are passed for</span>
<span class="sd">            `role_mentions` or `user_mentions`.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If both `attachment` and `attachments` are specified.</span>
<span class="sd">        hikari.errors.BadRequestError</span>
<span class="sd">            This may be raised in several discrete situations, such as messages</span>
<span class="sd">            being empty with no attachments or embeds; messages with more than</span>
<span class="sd">            2000 characters in them, embeds that exceed one of the many embed</span>
<span class="sd">            limits; too many attachments; attachments that are too large;</span>
<span class="sd">            invalid image URLs in embeds; if `reply` is not found or not in the</span>
<span class="sd">            same channel as `channel`; too many components.</span>
<span class="sd">        hikari.errors.UnauthorizedError</span>
<span class="sd">            If you are unauthorized to make the request (invalid/missing token).</span>
<span class="sd">        hikari.errors.ForbiddenError</span>
<span class="sd">            If you are missing the `SEND_MESSAGES` in the channel or the</span>
<span class="sd">            person you are trying to message has the DM&#39;s disabled.</span>
<span class="sd">        hikari.errors.NotFoundError</span>
<span class="sd">            If the channel is not found.</span>
<span class="sd">        hikari.errors.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.errors.RateLimitedError</span>
<span class="sd">            Usually, Hikari will handle and retry on hitting</span>
<span class="sd">            rate-limits automatically. This includes most bucket-specific</span>
<span class="sd">            rate-limits and global rate-limits. In some rare edge cases,</span>
<span class="sd">            however, Discord implements other undocumented rules for</span>
<span class="sd">            rate-limiting, such as limits per attribute. These cannot be</span>
<span class="sd">            detected or handled normally by Hikari due to their undocumented</span>
<span class="sd">            nature, and will trigger this exception if they occur.</span>
<span class="sd">        hikari.errors.InternalServerError</span>
<span class="sd">            If an internal error occurs on Discord while handling the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - Line too long</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>
            <span class="k">return</span> <span class="n">message</span>
</pre></div>

        </details>

            <div class="docstring"><p>Respond to this context with a followup message.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>content</strong> (hikari.UndefinedOr[typing.Any]):
The content to respond with.</p>

<p>If provided, the message contents. If
<code>hikari.undefined.UNDEFINED</code>, then nothing will be sent
in the content. Any other value here will be cast to a
<code>str</code>.</p>

<p>If this is a <code>hikari.embeds.Embed</code> and no <code>embed</code> nor <code>embeds</code> kwarg
is provided, then this will instead update the embed. This allows
for simpler syntax when sending an embed alone.</p>

<p>Likewise, if this is a <code>hikari.files.Resource</code>, then the
content is instead treated as an attachment if no <code>attachment</code> and
no <code>attachments</code> kwargs are provided.</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>ensure_result</strong> (bool):
This parameter does nothing but necessary to keep the signature with <code>Context</code>.</li>
<li><strong>tts</strong> (hikari.UndefinedOr[bool]):
Whether to respond with tts/text to speech or no.</li>
<li><strong>reply</strong> (hikari.Undefinedor[hikari.SnowflakeishOr[hikari.PartialMessage]]):
Whether to reply instead of sending the content to the context.</li>
<li><strong>nonce</strong> (hikari.UndefinedOr[str]):
The nonce that validates that the message was sent.</li>
<li><strong>attachment</strong> (hikari.UndefinedOr[hikari.Resourceish]):
A singular attachment to respond with.</li>
<li><strong>attachments</strong> (hikari.UndefinedOr[collections.Sequence[hikari.Resourceish]]):
A sequence of attachments to respond with.</li>
<li><strong>component</strong> (hikari.undefined.UndefinedOr[hikari.api.special_endpoints.ComponentBuilder]):
If provided, builder object of the component to include in this message.</li>
<li><strong>components</strong> (hikari.undefined.UndefinedOr[typing.Sequence[hikari.api.special_endpoints.ComponentBuilder]]):
If provided, a sequence of the component builder objects to include
in this message.</li>
<li><strong>embed</strong> (hikari.UndefinedOr[hikari.Embed]):
An embed to respond with.</li>
<li><strong>embeds</strong> (hikari.UndefinedOr[collections.Sequence[hikari.Embed]]):
A sequence of embeds to respond with.</li>
<li><strong>mentions_everyone</strong> (hikari.undefined.UndefinedOr[bool]):
If provided, whether the message should parse @everyone/@here
mentions.</li>
<li><strong>user_mentions</strong> (hikari.undefined.UndefinedOr[typing.Union[hikari.snowflakes.SnowflakeishSequence[hikari.users.PartialUser], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.
Alternatively this may be a collection of
<code>hikari.snowflakes.Snowflake</code>, or <code>hikari.users.PartialUser</code>
derivatives to enforce mentioning specific users.</li>
<li><strong>role_mentions</strong> (hikari.undefined.UndefinedOr[typing.Union[hikari.snowflakes.SnowflakeishSequence[hikari.guilds.PartialRole], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.
Alternatively this may be a collection of
<code>hikari.snowflakes.Snowflake</code>, or
<code>hikari.guilds.PartialRole</code> derivatives to enforce mentioning
specific roles.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>Attachments can be passed as many different things, to aid in
convenience.</p>

<ul>
<li>If a <code>pathlib.PurePath</code> or <code>str</code> to a valid URL, the
resource at the given URL will be streamed to Discord when
sending the message. Subclasses of
<code>hikari.files.WebResource</code> such as
<code>hikari.files.URL</code>,
<code>hikari.messages.Attachment</code>,
<code>hikari.emojis.Emoji</code>,
<code>EmbedResource</code>, etc will also be uploaded this way.
This will use bit-inception, so only a small percentage of the
resource will remain in memory at any one time, thus aiding in
scalability.</li>
<li>If a <code>hikari.files.Bytes</code> is passed, or a <code>str</code>
that contains a valid data URI is passed, then this is uploaded
with a randomized file name if not provided.</li>
<li>If a <code>hikari.files.File</code>, <code>pathlib.PurePath</code> or
<code>str</code> that is an absolute or relative path to a file
on your file system is passed, then this resource is uploaded
as an attachment using non-blocking code internally and streamed
using bit-inception where possible. This depends on the
type of <code>concurrent.futures.Executor</code> that is being used for
the application (default is a thread pool which supports this
behaviour).</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.messages.Message</strong>: The message that has been created.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If more than 100 unique objects/entities are passed for
<code>role_mentions</code> or <code>user_mentions</code>.</li>
<li><strong>TypeError</strong>: If both <code>attachment</code> and <code>attachments</code> are specified.</li>
<li><strong>hikari.errors.BadRequestError</strong>: This may be raised in several discrete situations, such as messages
being empty with no attachments or embeds; messages with more than
2000 characters in them, embeds that exceed one of the many embed
limits; too many attachments; attachments that are too large;
invalid image URLs in embeds; if <code>reply</code> is not found or not in the
same channel as <code>channel</code>; too many components.</li>
<li><strong>hikari.errors.UnauthorizedError</strong>: If you are unauthorized to make the request (invalid/missing token).</li>
<li><strong>hikari.errors.ForbiddenError</strong>: If you are missing the <code>SEND_MESSAGES</code> in the channel or the
person you are trying to message has the DM's disabled.</li>
<li><strong>hikari.errors.NotFoundError</strong>: If the channel is not found.</li>
<li><strong>hikari.errors.RateLimitTooLongError</strong>: Raised in the event that a rate limit occurs that is
longer than <code>max_rate_limit</code> when making a request.</li>
<li><strong>hikari.errors.RateLimitedError</strong>: Usually, Hikari will handle and retry on hitting
rate-limits automatically. This includes most bucket-specific
rate-limits and global rate-limits. In some rare edge cases,
however, Discord implements other undocumented rules for
rate-limiting, such as limits per attribute. These cannot be
detected or handled normally by Hikari due to their undocumented
nature, and will trigger this exception if they occur.</li>
<li><strong>hikari.errors.InternalServerError</strong>: If an internal error occurs on Discord while handling the request.</li>
</ul>
</div>


                            </div>
                            <div id="ComponentContext.create_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.create_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">create_initial_response</span><span class="signature">(
    self,
    response_type: Literal[&lt;ResponseType.MESSAGE_CREATE: 4&gt;, 4, &lt;ResponseType.MESSAGE_UPDATE: 7&gt;, 7],
    /,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType] = UNDEFINED,
    components: Union[Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType] = UNDEFINED,
    embeds: Union[Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType] = UNDEFINED,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    flags: Union[int, hikari.messages.MessageFlag, hikari.undefined.UndefinedType] = UNDEFINED,
    tts: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">response_type</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageResponseTypesT</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">response_type</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
            <span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentContext.delete_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.delete_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">delete_initial_response</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentContext.delete_last_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.delete_last_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">delete_last_response</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no last response&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentContext.edit_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.edit_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">edit_initial_response</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    attachment: &#39;hikari.UndefinedOr[hikari.Resourceish]&#39; = UNDEFINED,
    attachments: &#39;hikari.UndefinedOr[typing.Sequence[hikari.Resourceish]]&#39; = UNDEFINED,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType] = UNDEFINED,
    components: Union[Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType] = UNDEFINED,
    embeds: Union[Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType] = UNDEFINED,
    replace_attachments: bool = False,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentContext.edit_last_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.edit_last_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">edit_last_response</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    attachment: &#39;hikari.UndefinedOr[hikari.Resourceish]&#39; = UNDEFINED,
    attachments: &#39;hikari.UndefinedOr[typing.Sequence[hikari.Resourceish]]&#39; = UNDEFINED,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType] = UNDEFINED,
    components: Union[Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType] = UNDEFINED,
    embeds: Union[Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType] = UNDEFINED,
    replace_attachments: bool = False,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_last_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous responses&quot;</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentContext.fetch_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.fetch_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">fetch_initial_response</span><span class="signature">(self) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentContext.fetch_last_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.fetch_last_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">fetch_last_response</span><span class="signature">(self) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous known responses&quot;</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentContext.respond" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentContext.respond">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">respond</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    ensure_result: bool = False,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType] = UNDEFINED,
    components: Union[Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType] = UNDEFINED,
    embeds: Union[Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType] = UNDEFINED,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; Optional[hikari.messages.Message]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                    <span class="n">content</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>
                <span class="k">return</span> <span class="n">message</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                    <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">ensure_result</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>
</pre></div>

        </details>

    

                            </div>
                </section>
                <section id="ComponentExecutor">
                                <div class="attr class">
        <a class="headerlink" href="#ComponentExecutor">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ComponentExecutor</span><wbr>(<span class="base"><a href="#AbstractComponentExecutor">yuyo.AbstractComponentExecutor</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ComponentExecutor</span><span class="p">(</span><span class="n">AbstractComponentExecutor</span><span class="p">):</span>  <span class="c1"># TODO: Not found action?</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_ephemeral_default&quot;</span><span class="p">,</span> <span class="s2">&quot;_id_to_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_last_triggered&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">,</span> <span class="s2">&quot;_timeout&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">CallbackSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ComponentExecutor</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># TODO: might be a tad bit slow</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">custom_id</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">__custom_id__</span>

                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">[</span><span class="n">custom_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">CallbackSig</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">custom_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">ComponentContext</span><span class="p">(</span>
            <span class="n">ephemeral_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span><span class="p">,</span> <span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span> <span class="n">response_future</span><span class="o">=</span><span class="n">future</span>
        <span class="p">)</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">[</span><span class="n">interaction</span><span class="o">.</span><span class="n">custom_id</span><span class="p">]</span>
        <span class="k">await</span> <span class="n">callback</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentExecutorT</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentExecutorT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSigT</span><span class="p">],</span> <span class="n">CallbackSigT</span><span class="p">]:</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">id_</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

            <div class="docstring"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p>
</div>


                            <div id="ComponentExecutor.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentExecutor.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ComponentExecutor</span><span class="signature">(
    *,
    ephemeral_default: bool = False,
    load_from_attributes: bool = True,
    timeout: datetime.timedelta = datetime.timedelta(seconds=30)
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">CallbackSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ComponentExecutor</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># TODO: might be a tad bit slow</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">custom_id</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">__custom_id__</span>

                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">[</span><span class="n">custom_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentExecutor.callbacks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ComponentExecutor.callbacks">#&nbsp;&nbsp</a>

        <span class="name">callbacks</span><span class="annotation">: Mapping[str, Callable[[<a href="yuyo/components.html#ComponentContext">yuyo.components.ComponentContext</a>], Awaitable[NoneType]]]</span>
    </div>

    

                            </div>
                            <div id="ComponentExecutor.custom_ids" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ComponentExecutor.custom_ids">#&nbsp;&nbsp</a>

        <span class="name">custom_ids</span><span class="annotation">: Collection[str]</span>
    </div>

    

                            </div>
                            <div id="ComponentExecutor.has_expired" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ComponentExecutor.has_expired">#&nbsp;&nbsp</a>

        <span class="name">has_expired</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this executor has ended.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: Whether this executor has ended.</li>
</ul>
</div>


                            </div>
                            <div id="ComponentExecutor.execute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentExecutor.execute">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">execute</span><span class="signature">(
    self,
    interaction: hikari.interactions.component_interactions.ComponentInteraction,
    /,
    *,
    future: Optional[_asyncio.Future] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">ComponentContext</span><span class="p">(</span>
            <span class="n">ephemeral_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span><span class="p">,</span> <span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span> <span class="n">response_future</span><span class="o">=</span><span class="n">future</span>
        <span class="p">)</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">[</span><span class="n">interaction</span><span class="o">.</span><span class="n">custom_id</span><span class="p">]</span>
        <span class="k">await</span> <span class="n">callback</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentExecutor.add_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentExecutor.add_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_callback</span><span class="signature">(
    self: ~_ComponentExecutorT,
    id_: str,
    callback: Callable[[<a href="yuyo/components.html#ComponentContext">yuyo.components.ComponentContext</a>], Awaitable[NoneType]],
    /
) -&gt; ~_ComponentExecutorT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentExecutorT</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentExecutorT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id_to_callback</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentExecutor.with_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentExecutor.with_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_callback</span><span class="signature">(self, id_: str, /) -&gt; Callable[[~CallbackSigT], ~CallbackSigT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSigT</span><span class="p">],</span> <span class="n">CallbackSigT</span><span class="p">]:</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">id_</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

    

                            </div>
                </section>
                <section id="ComponentPaginator">
                                <div class="attr class">
        <a class="headerlink" href="#ComponentPaginator">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ComponentPaginator</span><wbr>(<span class="base"><a href="#ActionRowExecutor">yuyo.ActionRowExecutor</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ComponentPaginator</span><span class="p">(</span><span class="n">ActionRowExecutor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard implementation of an action row executor used for pagination.</span>

<span class="sd">    This is a convenience class that allows you to easily implement a paginator.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    iterator: yuyo.pagination.IteratorT[pagination.EntryT]</span>
<span class="sd">        The iterator to paginate.</span>

<span class="sd">        This should be an iterator of tuples of `(content: hikari.UndefinedOr[str],</span>
<span class="sd">        embed: hikari.UndefinedOr[hikari.Embed])`.</span>
<span class="sd">    authors: typing.Optional[typing.Iterable[hikari.SnowflakeishOr[hikari.User]]]</span>
<span class="sd">        The authors of the entries.</span>

<span class="sd">        If None is passed here then the paginator will be public (meaning that</span>
<span class="sd">        anybody can use it).</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    ephemeral_default: bool</span>
<span class="sd">        Whether or not the responses made on contexts spawned from this paginator</span>
<span class="sd">        should default to ephemeral (meaning only the author can see them) unless</span>
<span class="sd">        `flags` is specified on the response method.</span>
<span class="sd">    triggers: typing.Collection[str]</span>
<span class="sd">        Collection of the unicode emojis that should trigger this paginator.</span>

<span class="sd">        As of current the only usable emojis are `pagination.LEFT_TRIANGLE`,</span>
<span class="sd">        `pagination.RIGHT_TRIANGLE`, `pagination.STOP_SQUARE`,</span>
<span class="sd">        `pagination.LEFT_DOUBLE_TRIANGLE` and `pagination.LEFT_RIGHT_TRIANGLE`.</span>
<span class="sd">    timeout : datetime.timedelta</span>
<span class="sd">        The amount of time to wait after the component&#39;s last execution or creation</span>
<span class="sd">        until it times out.</span>

<span class="sd">        This defaults to 30 seconds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_authors&quot;</span><span class="p">,</span> <span class="s2">&quot;_buffer&quot;</span><span class="p">,</span> <span class="s2">&quot;_index&quot;</span><span class="p">,</span> <span class="s2">&quot;_iterator&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">iterator</span><span class="p">:</span> <span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]]],</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">triggers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid value passed for `iterator`, expected an iterator but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">ephemeral_default</span><span class="o">=</span><span class="n">ephemeral_default</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="n">load_from_attributes</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">authors</span><span class="p">))</span> <span class="k">if</span> <span class="n">authors</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]]</span> <span class="o">=</span> <span class="n">iterator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_first</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_previous</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">DANGER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_disable</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">BLACK_CROSS</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_next</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_last</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">builder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a sequence of the component builders for this paginator.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Sequence[hikari.api.ComponentBuilder]</span>
<span class="sd">            The component builders for this paginator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="ow">and</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_pre_execution_error</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="p">,</span> <span class="s2">&quot;You are not allowed to use this button&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_next_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the next entry in this paginator.</span>

<span class="sd">        This is generally helpful for making the message which the paginator will be based off</span>
<span class="sd">        and will still internally store the entry and increment the position of the paginator.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        response_paginator = yuyo.ComponentPaginator(</span>
<span class="sd">            pages,</span>
<span class="sd">            authors=(ctx.author.id,)</span>
<span class="sd">        )</span>
<span class="sd">        first_response = await response_paginator.get_next_entry()</span>
<span class="sd">        assert first_response</span>
<span class="sd">        content, embed = first_response</span>
<span class="sd">        message = await ctx.respond(content=content, embed=embed, component=response_paginator, ensure_result=True)</span>
<span class="sd">        component_client.add_executor(message, response_paginator)</span>
<span class="sd">        ```</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[pagination.EntryT]</span>
<span class="sd">            The next entry in this paginator, or `None` if there are no more entries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check to see if we&#39;re behind the buffer before trying to go forward in the generator.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>

        <span class="c1"># If entry is not None then the generator&#39;s position was pushed forwards.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="ow">and</span> <span class="p">(</span><span class="n">entry</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">pagination</span><span class="o">.</span><span class="n">seek_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">entry</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_noop</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_UPDATE</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">first_entry</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="k">else</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="n">first_entry</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_UPDATE</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noop</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_previous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_UPDATE</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noop</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_disable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">defer</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">DEFERRED_MESSAGE_UPDATE</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
        <span class="k">raise</span> <span class="n">ExecutorClosed</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_last</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span>
            <span class="c1"># TODO: option to not lock on last</span>
            <span class="n">loading_component</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">build_action_row</span><span class="p">()</span>
                <span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="s2">&quot;loading&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">set_is_disabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span><span class="mi">878377505344614461</span><span class="p">)</span>
                <span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_UPDATE</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">loading_component</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="k">await</span> <span class="n">pagination</span><span class="o">.</span><span class="n">collect_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span>
                <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>
                <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="p">(),</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="p">())</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_UPDATE</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noop</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComponentContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entry</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">():</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">defer</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">DEFERRED_MESSAGE_UPDATE</span><span class="p">)</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="n">entry</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noop</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Standard implementation of an action row executor used for pagination.</p>

<p>This is a convenience class that allows you to easily implement a paginator.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>iterator</strong> (<a href="yuyo/pagination.html#IteratorT">yuyo.pagination.IteratorT</a>[pagination.EntryT]):
The iterator to paginate.</p>

<p>This should be an iterator of tuples of <code>(content: hikari.UndefinedOr[str],
embed: hikari.UndefinedOr[hikari.Embed])</code>.</p></li>
<li><p><strong>authors</strong> (typing.Optional[typing.Iterable[hikari.SnowflakeishOr[hikari.User]]]):
The authors of the entries.</p>

<p>If None is passed here then the paginator will be public (meaning that
anybody can use it).</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>ephemeral_default</strong> (bool):
Whether or not the responses made on contexts spawned from this paginator
should default to ephemeral (meaning only the author can see them) unless
<code>flags</code> is specified on the response method.</li>
<li><p><strong>triggers</strong> (typing.Collection[str]):
Collection of the unicode emojis that should trigger this paginator.</p>

<p>As of current the only usable emojis are <code>pagination.LEFT_TRIANGLE</code>,
<code>pagination.RIGHT_TRIANGLE</code>, <code>pagination.STOP_SQUARE</code>,
<code>pagination.LEFT_DOUBLE_TRIANGLE</code> and <code>pagination.LEFT_RIGHT_TRIANGLE</code>.</p></li>
<li><p><strong>timeout</strong> (datetime.timedelta):
The amount of time to wait after the component's last execution or creation
until it times out.</p>

<p>This defaults to 30 seconds.</p></li>
</ul>
</div>


                            <div id="ComponentPaginator.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentPaginator.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ComponentPaginator</span><span class="signature">(
    iterator: Union[AsyncIterator[Tuple[Union[str, hikari.undefined.UndefinedType], Union[hikari.embeds.Embed, hikari.undefined.UndefinedType]]], Iterator[Tuple[Union[str, hikari.undefined.UndefinedType], Union[hikari.embeds.Embed, hikari.undefined.UndefinedType]]]],
    *,
    authors: Optional[Iterable[Union[hikari.users.User, hikari.snowflakes.Snowflake, int]]],
    ephemeral_default: bool = False,
    triggers: Collection[str] = (&#39;&#39;, &#39;&#39;, &#39;&#39;),
    load_from_attributes: bool = False,
    timeout: datetime.timedelta = datetime.timedelta(seconds=30)
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">iterator</span><span class="p">:</span> <span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]]],</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">triggers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid value passed for `iterator`, expected an iterator but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">ephemeral_default</span><span class="o">=</span><span class="n">ephemeral_default</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="n">load_from_attributes</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">authors</span><span class="p">))</span> <span class="k">if</span> <span class="n">authors</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]]</span> <span class="o">=</span> <span class="n">iterator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_first</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_previous</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">DANGER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_disable</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">BLACK_CROSS</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_next</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">SECONDARY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_last</span><span class="p">)</span><span class="o">.</span><span class="n">set_emoji</span><span class="p">(</span>
                <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentPaginator.builder" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentPaginator.builder">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">builder</span><span class="signature">(self) -&gt; Sequence[hikari.api.special_endpoints.ComponentBuilder]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">builder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a sequence of the component builders for this paginator.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Sequence[hikari.api.ComponentBuilder]</span>
<span class="sd">            The component builders for this paginator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get a sequence of the component builders for this paginator.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Sequence[hikari.api.ComponentBuilder]</strong>: The component builders for this paginator.</li>
</ul>
</div>


                            </div>
                            <div id="ComponentPaginator.execute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentPaginator.execute">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">execute</span><span class="signature">(
    self,
    interaction: hikari.interactions.component_interactions.ComponentInteraction,
    /,
    *,
    future: _asyncio.Future = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="ow">and</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_pre_execution_error</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="p">,</span> <span class="s2">&quot;You are not allowed to use this button&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ComponentPaginator.get_next_entry" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ComponentPaginator.get_next_entry">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">get_next_entry</span><span class="signature">(
    self,
    /
) -&gt; Optional[Tuple[Union[str, hikari.undefined.UndefinedType], Union[hikari.embeds.Embed, hikari.undefined.UndefinedType]]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_next_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the next entry in this paginator.</span>

<span class="sd">        This is generally helpful for making the message which the paginator will be based off</span>
<span class="sd">        and will still internally store the entry and increment the position of the paginator.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        response_paginator = yuyo.ComponentPaginator(</span>
<span class="sd">            pages,</span>
<span class="sd">            authors=(ctx.author.id,)</span>
<span class="sd">        )</span>
<span class="sd">        first_response = await response_paginator.get_next_entry()</span>
<span class="sd">        assert first_response</span>
<span class="sd">        content, embed = first_response</span>
<span class="sd">        message = await ctx.respond(content=content, embed=embed, component=response_paginator, ensure_result=True)</span>
<span class="sd">        component_client.add_executor(message, response_paginator)</span>
<span class="sd">        ```</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[pagination.EntryT]</span>
<span class="sd">            The next entry in this paginator, or `None` if there are no more entries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check to see if we&#39;re behind the buffer before trying to go forward in the generator.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>

        <span class="c1"># If entry is not None then the generator&#39;s position was pushed forwards.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="ow">and</span> <span class="p">(</span><span class="n">entry</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">pagination</span><span class="o">.</span><span class="n">seek_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">entry</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get the next entry in this paginator.</p>

<p>This is generally helpful for making the message which the paginator will be based off
and will still internally store the entry and increment the position of the paginator.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">response_paginator</span> <span class="o">=</span> <span class="n">yuyo</span><span class="o">.</span><span class="n">ComponentPaginator</span><span class="p">(</span>
    <span class="n">pages</span><span class="p">,</span>
    <span class="n">authors</span><span class="o">=</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">id</span><span class="p">,)</span>
<span class="p">)</span>
<span class="n">first_response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">response_paginator</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">first_response</span>
<span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="n">first_response</span>
<span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">response_paginator</span><span class="p">,</span> <span class="n">ensure_result</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">component_client</span><span class="o">.</span><span class="n">add_executor</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">response_paginator</span><span class="p">)</span>
</code></pre></div>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[pagination.EntryT]</strong>: The next entry in this paginator, or <code>None</code> if there are no more entries.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ComponentExecutor">ComponentExecutor</a></dt>
                                <dd id="ComponentPaginator.callbacks" class="variable"><a href="#ComponentExecutor.callbacks">callbacks</a></dd>
                <dd id="ComponentPaginator.custom_ids" class="variable"><a href="#ComponentExecutor.custom_ids">custom_ids</a></dd>
                <dd id="ComponentPaginator.has_expired" class="variable"><a href="#ComponentExecutor.has_expired">has_expired</a></dd>
                <dd id="ComponentPaginator.add_callback" class="function"><a href="#ComponentExecutor.add_callback">add_callback</a></dd>
                <dd id="ComponentPaginator.with_callback" class="function"><a href="#ComponentExecutor.with_callback">with_callback</a></dd>

            </div>
            <div><dt><a href="#ActionRowExecutor">ActionRowExecutor</a></dt>
                                <dd id="ComponentPaginator.components" class="variable"><a href="#ActionRowExecutor.components">components</a></dd>
                <dd id="ComponentPaginator.add_component" class="function"><a href="#ActionRowExecutor.add_component">add_component</a></dd>
                <dd id="ComponentPaginator.add_button" class="function"><a href="#ActionRowExecutor.add_button">add_button</a></dd>
                <dd id="ComponentPaginator.add_select_menu" class="function"><a href="#ActionRowExecutor.add_select_menu">add_select_menu</a></dd>
                <dd id="ComponentPaginator.build" class="function"><a href="#ActionRowExecutor.build">build</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="InteractiveButtonBuilder">
                                <div class="attr class">
        <a class="headerlink" href="#InteractiveButtonBuilder">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">InteractiveButtonBuilder</span><wbr>(<span class="base">hikari.impl.special_endpoints.InteractiveButtonBuilder[~ContainerProtoT]</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">InteractiveButtonBuilder</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">InteractiveButtonBuilder</span><span class="p">[</span><span class="n">ContainerProtoT</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="n">container</span><span class="p">:</span> <span class="n">ContainerProtoT</span><span class="p">,</span> <span class="n">custom_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="c1"># pyright doesn&#39;t support attrs _ kwargs</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSig</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span>

    <span class="k">def</span> <span class="nf">add_to_container</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContainerProtoT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Builder class for interactive buttons.</p>
</div>


                            <div id="InteractiveButtonBuilder.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#InteractiveButtonBuilder.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">InteractiveButtonBuilder</span><span class="signature">(
    callback: Callable[[<a href="yuyo/components.html#ComponentContext">yuyo.components.ComponentContext</a>], Awaitable[NoneType]],
    container: ~ContainerProtoT,
    custom_id: str,
    style: hikari.messages.ButtonStyle
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="n">container</span><span class="p">:</span> <span class="n">ContainerProtoT</span><span class="p">,</span> <span class="n">custom_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ButtonStyle</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="c1"># pyright doesn&#39;t support attrs _ kwargs</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</pre></div>

        </details>

            <div class="docstring"><p>Method generated by attrs for class InteractiveButtonBuilder.</p>
</div>


                            </div>
                            <div id="InteractiveButtonBuilder.callback" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#InteractiveButtonBuilder.callback">#&nbsp;&nbsp</a>

        <span class="name">callback</span><span class="annotation">: Callable[[<a href="yuyo/components.html#ComponentContext">yuyo.components.ComponentContext</a>], Awaitable[NoneType]]</span>
    </div>

    

                            </div>
                            <div id="InteractiveButtonBuilder.add_to_container" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#InteractiveButtonBuilder.add_to_container">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_to_container</span><span class="signature">(self) -&gt; ~ContainerProtoT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_to_container</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContainerProtoT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add this button to the container component it belongs to.</p>

<p>This is used as the finalising call during chained calls.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>_ContainerT</strong>: The container component that owns this button.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>hikari.impl.special_endpoints.InteractiveButtonBuilder</dt>
                                <dd id="InteractiveButtonBuilder.custom_id" class="variable"><a href="#InteractiveButtonBuilder.custom_id">custom_id</a></dd>

            </div>
            <div><dt>hikari.impl.special_endpoints._ButtonBuilder</dt>
                                <dd id="InteractiveButtonBuilder.style" class="variable">style</dd>
                <dd id="InteractiveButtonBuilder.emoji" class="variable">emoji</dd>
                <dd id="InteractiveButtonBuilder.label" class="variable">label</dd>
                <dd id="InteractiveButtonBuilder.is_disabled" class="variable">is_disabled</dd>
                <dd id="InteractiveButtonBuilder.set_emoji" class="function">set_emoji</dd>
                <dd id="InteractiveButtonBuilder.set_label" class="function">set_label</dd>
                <dd id="InteractiveButtonBuilder.set_is_disabled" class="function">set_is_disabled</dd>
                <dd id="InteractiveButtonBuilder.build" class="function">build</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MultiComponentExecutor">
                                <div class="attr class">
        <a class="headerlink" href="#MultiComponentExecutor">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">MultiComponentExecutor</span><wbr>(<span class="base"><a href="#AbstractComponentExecutor">yuyo.AbstractComponentExecutor</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MultiComponentExecutor</span><span class="p">(</span><span class="n">AbstractComponentExecutor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multi-component implementation of a component executor.</span>

<span class="sd">    This implementation allows for multiple components to be executed as a single</span>
<span class="sd">    view.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    load_from_attributes: bool</span>
<span class="sd">        Whether this should load sub-components from its attributes.</span>

<span class="sd">        This is helpful when inheritance and `as_child_executor` are being</span>
<span class="sd">        used to declare child executors within this executor.</span>
<span class="sd">    timeout : datetime.timedelta</span>
<span class="sd">        The amount of time to wait after the component&#39;s last execution or creation</span>
<span class="sd">        until it times out.</span>

<span class="sd">        Defaults to 30 seconds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_builders&quot;</span><span class="p">,</span> <span class="s2">&quot;_executors&quot;</span><span class="p">,</span> <span class="s2">&quot;_last_triggered&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">,</span> <span class="s2">&quot;_timeout&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_builders</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">AbstractComponentExecutor</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">MultiComponentExecutor</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># TODO: might be a tad bit slow</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">__is_child_executor__</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">())</span>

                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">builders</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Component builders within this executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Sequence[hikari.api.ComponentBuilder]</span>
<span class="sd">            Seqeuence of the component builders within this executor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_builders</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">custom_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">custom_ids</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">executors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">AbstractComponentExecutor</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Child executors within this multi-executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Sequence[AbstractComponentExecutor]</span>
<span class="sd">            A sequence of the child executors within this multi-executor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span>

    <span class="k">def</span> <span class="nf">add_builder</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MultiComponentExecutorT</span><span class="p">,</span> <span class="n">builder</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MultiComponentExecutorT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a non-executable component builder to this executor.</span>

<span class="sd">        This is useful for adding components that are not meant to be executed, such as a</span>
<span class="sd">        a row of link buttons.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        builder : hikari.api.ComponentBuilder</span>
<span class="sd">            The component builder to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_builders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">builder</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_action_row</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MultiComponentExecutorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChildActionRowExecutor</span><span class="p">[</span><span class="n">_MultiComponentExecutorT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Create a builder class to add an action row to this executor.</span>

<span class="sd">        For the most part this follows the same implementation as `ActionRowExecutor`</span>
<span class="sd">        except with the added detail that `ChildActionRowExecutor.add_to_parent`</span>
<span class="sd">        must be called to add the action row to the parent executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ChildActionRowExecutor[_MultiComponentExecutorT]</span>
<span class="sd">            A builder class to add an action row to this executor.</span>

<span class="sd">            `ChildActionRowExecutor.add_to_parent` should be called to finalise</span>
<span class="sd">            the action row and will return the parent executor for chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ChildActionRowExecutor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_executor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MultiComponentExecutorT</span><span class="p">,</span> <span class="n">executor</span><span class="p">:</span> <span class="n">AbstractComponentExecutor</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MultiComponentExecutorT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a component executor to this multi-component executor.</span>

<span class="sd">        This method is internally used by the `add_{component}` methods.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        executor : AbstractComponentExecutor</span>
<span class="sd">            The component executor to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The multi-component executor instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">executor</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">for</span> <span class="n">executor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">custom_id</span> <span class="ow">in</span> <span class="n">executor</span><span class="o">.</span><span class="n">custom_ids</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Custom ID not found&quot;</span><span class="p">)</span>  <span class="c1"># TODO: do we want to respond here?</span>
</pre></div>

        </details>

            <div class="docstring"><p>Multi-component implementation of a component executor.</p>

<p>This implementation allows for multiple components to be executed as a single
view.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>load_from_attributes</strong> (bool):
Whether this should load sub-components from its attributes.</p>

<p>This is helpful when inheritance and <code><a href="#as_child_executor">as_child_executor</a></code> are being
used to declare child executors within this executor.</p></li>
<li><p><strong>timeout</strong> (datetime.timedelta):
The amount of time to wait after the component's last execution or creation
until it times out.</p>

<p>Defaults to 30 seconds.</p></li>
</ul>
</div>


                            <div id="MultiComponentExecutor.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MultiComponentExecutor.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">MultiComponentExecutor</span><span class="signature">(
    *,
    load_from_attributes: bool = False,
    timeout: datetime.timedelta = datetime.timedelta(seconds=30)
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_builders</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">AbstractComponentExecutor</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">MultiComponentExecutor</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># TODO: might be a tad bit slow</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">__is_child_executor__</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">())</span>

                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MultiComponentExecutor.builders" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MultiComponentExecutor.builders">#&nbsp;&nbsp</a>

        <span class="name">builders</span><span class="annotation">: Sequence[hikari.api.special_endpoints.ComponentBuilder]</span>
    </div>

            <div class="docstring"><p>Component builders within this executor.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Sequence[hikari.api.ComponentBuilder]</strong>: Seqeuence of the component builders within this executor.</li>
</ul>
</div>


                            </div>
                            <div id="MultiComponentExecutor.custom_ids" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MultiComponentExecutor.custom_ids">#&nbsp;&nbsp</a>

        <span class="name">custom_ids</span><span class="annotation">: Collection[str]</span>
    </div>

    

                            </div>
                            <div id="MultiComponentExecutor.executors" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MultiComponentExecutor.executors">#&nbsp;&nbsp</a>

        <span class="name">executors</span><span class="annotation">: Sequence[<a href="yuyo/components.html#AbstractComponentExecutor">yuyo.components.AbstractComponentExecutor</a>]</span>
    </div>

            <div class="docstring"><p>Child executors within this multi-executor.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Sequence[AbstractComponentExecutor]</strong>: A sequence of the child executors within this multi-executor.</li>
</ul>
</div>


                            </div>
                            <div id="MultiComponentExecutor.has_expired" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MultiComponentExecutor.has_expired">#&nbsp;&nbsp</a>

        <span class="name">has_expired</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this executor has ended.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: Whether this executor has ended.</li>
</ul>
</div>


                            </div>
                            <div id="MultiComponentExecutor.add_builder" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MultiComponentExecutor.add_builder">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_builder</span><span class="signature">(
    self: ~_MultiComponentExecutorT,
    builder: hikari.api.special_endpoints.ComponentBuilder,
    /
) -&gt; ~_MultiComponentExecutorT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_builder</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MultiComponentExecutorT</span><span class="p">,</span> <span class="n">builder</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MultiComponentExecutorT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a non-executable component builder to this executor.</span>

<span class="sd">        This is useful for adding components that are not meant to be executed, such as a</span>
<span class="sd">        a row of link buttons.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        builder : hikari.api.ComponentBuilder</span>
<span class="sd">            The component builder to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_builders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">builder</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a non-executable component builder to this executor.</p>

<p>This is useful for adding components that are not meant to be executed, such as a
a row of link buttons.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>builder</strong> (hikari.api.ComponentBuilder):
The component builder to add.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong></li>
</ul>
</div>


                            </div>
                            <div id="MultiComponentExecutor.add_action_row" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MultiComponentExecutor.add_action_row">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_action_row</span><span class="signature">(
    self: ~_MultiComponentExecutorT
) -&gt; <a href="yuyo/components.html#ChildActionRowExecutor">yuyo.components.ChildActionRowExecutor</a>[~_MultiComponentExecutorT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_action_row</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MultiComponentExecutorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChildActionRowExecutor</span><span class="p">[</span><span class="n">_MultiComponentExecutorT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Create a builder class to add an action row to this executor.</span>

<span class="sd">        For the most part this follows the same implementation as `ActionRowExecutor`</span>
<span class="sd">        except with the added detail that `ChildActionRowExecutor.add_to_parent`</span>
<span class="sd">        must be called to add the action row to the parent executor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ChildActionRowExecutor[_MultiComponentExecutorT]</span>
<span class="sd">            A builder class to add an action row to this executor.</span>

<span class="sd">            `ChildActionRowExecutor.add_to_parent` should be called to finalise</span>
<span class="sd">            the action row and will return the parent executor for chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ChildActionRowExecutor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Create a builder class to add an action row to this executor.</p>

<p>For the most part this follows the same implementation as <code><a href="#ActionRowExecutor">ActionRowExecutor</a></code>
except with the added detail that <code><a href="#ChildActionRowExecutor.add_to_parent">ChildActionRowExecutor.add_to_parent</a></code>
must be called to add the action row to the parent executor.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ChildActionRowExecutor[_MultiComponentExecutorT]</strong>: A builder class to add an action row to this executor.</li>
</ul>

<p><code><a href="#ChildActionRowExecutor.add_to_parent">ChildActionRowExecutor.add_to_parent</a></code> should be called to finalise
the action row and will return the parent executor for chained calls.</p>
</div>


                            </div>
                            <div id="MultiComponentExecutor.add_executor" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MultiComponentExecutor.add_executor">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_executor</span><span class="signature">(
    self: ~_MultiComponentExecutorT,
    executor: <a href="yuyo/components.html#AbstractComponentExecutor">yuyo.components.AbstractComponentExecutor</a>,
    /
) -&gt; ~_MultiComponentExecutorT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_executor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MultiComponentExecutorT</span><span class="p">,</span> <span class="n">executor</span><span class="p">:</span> <span class="n">AbstractComponentExecutor</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MultiComponentExecutorT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a component executor to this multi-component executor.</span>

<span class="sd">        This method is internally used by the `add_{component}` methods.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        executor : AbstractComponentExecutor</span>
<span class="sd">            The component executor to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The multi-component executor instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">executor</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a component executor to this multi-component executor.</p>

<p>This method is internally used by the <code>add_{component}</code> methods.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>executor</strong> (AbstractComponentExecutor):
The component executor to add.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The multi-component executor instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="MultiComponentExecutor.execute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MultiComponentExecutor.execute">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">execute</span><span class="signature">(
    self,
    interaction: hikari.interactions.component_interactions.ComponentInteraction,
    /,
    *,
    future: Optional[_asyncio.Future] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">for</span> <span class="n">executor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executors</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">custom_id</span> <span class="ow">in</span> <span class="n">executor</span><span class="o">.</span><span class="n">custom_ids</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="o">=</span><span class="n">future</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Custom ID not found&quot;</span><span class="p">)</span>  <span class="c1"># TODO: do we want to respond here?</span>
</pre></div>

        </details>

    

                            </div>
                </section>
                <section id="SelectMenuBuilder">
                                <div class="attr class">
        <a class="headerlink" href="#SelectMenuBuilder">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">SelectMenuBuilder</span><wbr>(<span class="base">hikari.impl.special_endpoints.SelectMenuBuilder[~ContainerProtoT]</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SelectMenuBuilder</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">SelectMenuBuilder</span><span class="p">[</span><span class="n">ContainerProtoT</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="n">container</span><span class="p">:</span> <span class="n">ContainerProtoT</span><span class="p">,</span> <span class="n">custom_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="c1"># pyright doesn&#39;t support attrs _ kwargs</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSig</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span>

    <span class="k">def</span> <span class="nf">add_to_container</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContainerProtoT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Builder class for select menus.</p>
</div>


                            <div id="SelectMenuBuilder.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SelectMenuBuilder.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">SelectMenuBuilder</span><span class="signature">(
    callback: Callable[[<a href="yuyo/components.html#ComponentContext">yuyo.components.ComponentContext</a>], Awaitable[NoneType]],
    container: ~ContainerProtoT,
    custom_id: str
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span> <span class="n">container</span><span class="p">:</span> <span class="n">ContainerProtoT</span><span class="p">,</span> <span class="n">custom_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="c1"># pyright doesn&#39;t support attrs _ kwargs</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</pre></div>

        </details>

            <div class="docstring"><p>Method generated by attrs for class SelectMenuBuilder.</p>
</div>


                            </div>
                            <div id="SelectMenuBuilder.callback" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SelectMenuBuilder.callback">#&nbsp;&nbsp</a>

        <span class="name">callback</span><span class="annotation">: Callable[[<a href="yuyo/components.html#ComponentContext">yuyo.components.ComponentContext</a>], Awaitable[NoneType]]</span>
    </div>

    

                            </div>
                            <div id="SelectMenuBuilder.add_to_container" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SelectMenuBuilder.add_to_container">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_to_container</span><span class="signature">(self) -&gt; ~ContainerProtoT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_to_container</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContainerProtoT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_to_container</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Finalise this builder by adding it to its parent container component.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>_ContainerT</strong>: The parent container component builder.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>hikari.impl.special_endpoints.SelectMenuBuilder</dt>
                                <dd id="SelectMenuBuilder.custom_id" class="variable"><a href="#SelectMenuBuilder.custom_id">custom_id</a></dd>
                <dd id="SelectMenuBuilder.is_disabled" class="variable"><a href="#SelectMenuBuilder.is_disabled">is_disabled</a></dd>
                <dd id="SelectMenuBuilder.options" class="variable"><a href="#SelectMenuBuilder.options">options</a></dd>
                <dd id="SelectMenuBuilder.placeholder" class="variable"><a href="#SelectMenuBuilder.placeholder">placeholder</a></dd>
                <dd id="SelectMenuBuilder.min_values" class="variable"><a href="#SelectMenuBuilder.min_values">min_values</a></dd>
                <dd id="SelectMenuBuilder.max_values" class="variable"><a href="#SelectMenuBuilder.max_values">max_values</a></dd>
                <dd id="SelectMenuBuilder.add_option" class="function"><a href="#SelectMenuBuilder.add_option">add_option</a></dd>
                <dd id="SelectMenuBuilder.add_raw_option" class="function"><a href="#SelectMenuBuilder.add_raw_option">add_raw_option</a></dd>
                <dd id="SelectMenuBuilder.set_is_disabled" class="function"><a href="#SelectMenuBuilder.set_is_disabled">set_is_disabled</a></dd>
                <dd id="SelectMenuBuilder.set_placeholder" class="function"><a href="#SelectMenuBuilder.set_placeholder">set_placeholder</a></dd>
                <dd id="SelectMenuBuilder.set_min_values" class="function"><a href="#SelectMenuBuilder.set_min_values">set_min_values</a></dd>
                <dd id="SelectMenuBuilder.set_max_values" class="function"><a href="#SelectMenuBuilder.set_max_values">set_max_values</a></dd>
                <dd id="SelectMenuBuilder.build" class="function"><a href="#SelectMenuBuilder.build">build</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="WaitForComponent">
                                <div class="attr class">
        <a class="headerlink" href="#WaitForComponent">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">WaitForComponent</span><wbr>(<span class="base"><a href="#AbstractComponentExecutor">yuyo.AbstractComponentExecutor</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">WaitForComponent</span><span class="p">(</span><span class="n">AbstractComponentExecutor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Component executor used to wait for a single component interaction.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    authors: typing.Optional[typing.Iterable[hikari.SnowflakeishOr[hikari.User]]]</span>
<span class="sd">        The authors of the entries.</span>

<span class="sd">        If None is passed here then the paginator will be public (meaning that</span>
<span class="sd">        anybody can use it).</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    ephemeral_default: bool</span>
<span class="sd">        Whether or not the responses made on contexts spawned from this paginator</span>
<span class="sd">        should default to ephemeral (meaning only the author can see them) unless</span>
<span class="sd">        `flags` is specified on the response method.</span>
<span class="sd">    timeout : datetime.timedelta</span>
<span class="sd">        How long this should wait for a matching component interaction until it times-out.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    responses: dict[str, str]</span>
<span class="sd">    message = await ctx.respond(&quot;hi, pick an option&quot;, components=[...])</span>
<span class="sd">    executor = yuyo.components.WaitFor(authors=(ctx.author.id,), timeout=datetime.timedelta(seconds=30))</span>
<span class="sd">    component_client.add_executor(message.id, executor)</span>

<span class="sd">    try:</span>
<span class="sd">        result = await executor.wait_for()</span>
<span class="sd">    except asyncio.TimeoutError:</span>
<span class="sd">        await ctx.respond(&quot;timed out&quot;)</span>

<span class="sd">    else:</span>
<span class="sd">        await result.respond(responses[result.interaction.custom_id])</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_authors&quot;</span><span class="p">,</span> <span class="s2">&quot;_ephemeral_default&quot;</span><span class="p">,</span> <span class="s2">&quot;_finished&quot;</span><span class="p">,</span> <span class="s2">&quot;_future&quot;</span><span class="p">,</span> <span class="s2">&quot;_made_at&quot;</span><span class="p">,</span> <span class="s2">&quot;_timeout&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]]],</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">authors</span><span class="p">))</span> <span class="k">if</span> <span class="n">authors</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ComponentContext</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_made_at</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">custom_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_made_at</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_made_at</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ComponentContext</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Wait for the next matching interaction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        asyncio.Future[ComponentContext]</span>
<span class="sd">            A future that will be resolved with the next matching interaction.</span>

<span class="sd">            This will raise `asyncio.TimeoutError` if the timeout is reached.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the executor is already being waited for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This executor is already being waited for&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_made_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_future</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="ow">and</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_pre_execution_error</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="p">,</span> <span class="s2">&quot;You are not allowed to use this button&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span>
            <span class="n">ComponentContext</span><span class="p">(</span><span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span> <span class="n">response_future</span><span class="o">=</span><span class="n">future</span><span class="p">,</span> <span class="n">ephemeral_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Component executor used to wait for a single component interaction.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>authors</strong> (typing.Optional[typing.Iterable[hikari.SnowflakeishOr[hikari.User]]]):
The authors of the entries.</p>

<p>If None is passed here then the paginator will be public (meaning that
anybody can use it).</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>ephemeral_default</strong> (bool):
Whether or not the responses made on contexts spawned from this paginator
should default to ephemeral (meaning only the author can see them) unless
<code>flags</code> is specified on the response method.</li>
<li><strong>timeout</strong> (datetime.timedelta):
How long this should wait for a matching component interaction until it times-out.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">responses</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s2">&quot;hi, pick an option&quot;</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">])</span>
<span class="n">executor</span> <span class="o">=</span> <span class="n">yuyo</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">WaitFor</span><span class="p">(</span><span class="n">authors</span><span class="o">=</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">id</span><span class="p">,),</span> <span class="n">timeout</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
<span class="n">component_client</span><span class="o">.</span><span class="n">add_executor</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">executor</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">executor</span><span class="o">.</span><span class="n">wait_for</span><span class="p">()</span>
<span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s2">&quot;timed out&quot;</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">result</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">responses</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">custom_id</span><span class="p">])</span>
</code></pre></div>
</div>


                            <div id="WaitForComponent.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#WaitForComponent.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">WaitForComponent</span><span class="signature">(
    *,
    authors: Optional[Iterable[Union[hikari.users.User, hikari.snowflakes.Snowflake, int]]],
    ephemeral_default: bool = False,
    timeout: datetime.timedelta
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]]],</span>
        <span class="n">ephemeral_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">authors</span><span class="p">))</span> <span class="k">if</span> <span class="n">authors</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span> <span class="o">=</span> <span class="n">ephemeral_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ComponentContext</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_made_at</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="WaitForComponent.custom_ids" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#WaitForComponent.custom_ids">#&nbsp;&nbsp</a>

        <span class="name">custom_ids</span><span class="annotation">: Collection[str]</span>
    </div>

    

                            </div>
                            <div id="WaitForComponent.has_expired" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#WaitForComponent.has_expired">#&nbsp;&nbsp</a>

        <span class="name">has_expired</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this executor has ended.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: Whether this executor has ended.</li>
</ul>
</div>


                            </div>
                            <div id="WaitForComponent.wait_for" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#WaitForComponent.wait_for">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">wait_for</span><span class="signature">(self) -&gt; _asyncio.Future</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ComponentContext</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Wait for the next matching interaction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        asyncio.Future[ComponentContext]</span>
<span class="sd">            A future that will be resolved with the next matching interaction.</span>

<span class="sd">            This will raise `asyncio.TimeoutError` if the timeout is reached.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the executor is already being waited for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This executor is already being waited for&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_made_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_future</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
</pre></div>

        </details>

            <div class="docstring"><p>Wait for the next matching interaction.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>asyncio.Future[ComponentContext]</strong>: A future that will be resolved with the next matching interaction.</li>
</ul>

<p>This will raise <code>asyncio.TimeoutError</code> if the timeout is reached.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>RuntimeError</strong>: If the executor is already being waited for.</li>
</ul>
</div>


                            </div>
                            <div id="WaitForComponent.execute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#WaitForComponent.execute">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">execute</span><span class="signature">(
    self,
    interaction: hikari.interactions.component_interactions.ComponentInteraction,
    /,
    *,
    future: Optional[_asyncio.Future] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ComponentInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractComponentExecutor&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="ow">and</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">_pre_execution_error</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">future</span><span class="p">,</span> <span class="s2">&quot;You are not allowed to use this button&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span>
            <span class="n">ComponentContext</span><span class="p">(</span><span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span> <span class="n">response_future</span><span class="o">=</span><span class="n">future</span><span class="p">,</span> <span class="n">ephemeral_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ephemeral_default</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                </section>
                <section id="reactions">
                                <div class="attr module"><a class="headerlink" href="#reactions">#&nbsp;&nbsp</a>
<span class="name"><a href="yuyo/reactions.html">yuyo.reactions</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Client for higher level callback based reaction menu handling.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;as_reaction_callback&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AbstractReactionHandler&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ReactionHandler&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ReactionPaginator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ReactionClient&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">hikari</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">backoff</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">pagination</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">hikari</span> <span class="kn">import</span> <span class="n">traits</span>
    <span class="kn">from</span> <span class="nn">hikari.api</span> <span class="kn">import</span> <span class="n">event_manager</span> <span class="k">as</span> <span class="n">event_manager_api</span>

    <span class="n">_ReactionHandlerT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ReactionHandlerT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;ReactionHandler&quot;</span><span class="p">)</span>
    <span class="n">_ReactionPaginatorT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ReactionPaginatorT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;ReactionPaginator&quot;</span><span class="p">)</span>
    <span class="n">_ReactionClientT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ReactionClientT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;ReactionClient&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">HandlerClosed</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="o">...</span>


<span class="k">class</span> <span class="nc">AbstractReactionHandler</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The interface for a reaction handler used with `ReactionClient`.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this handler has ended.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether this handler has ended.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">last_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;When this handler was last triggered.</span>

<span class="sd">        !!! note</span>
<span class="sd">            If it hasn&#39;t ever been triggered then this will be when it was created.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        datetime.datetime</span>
<span class="sd">            When this handler was last triggered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close this handler.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Open this handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.messages.Message</span>
<span class="sd">            The message to bind this handler to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_reaction_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Handle a reaction event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : EventT</span>
<span class="sd">            The event to handle.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        HandlerClosed</span>
<span class="sd">            If this reaction handler has been closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="n">EventT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionAddEvent</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ReactionDeleteEvent</span><span class="p">]</span>
<span class="n">CallbackSig</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">EventT</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span>
<span class="n">CallbackSigT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;CallbackSigT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">CallbackSig</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">as_reaction_callback</span><span class="p">(</span>
    <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span> <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSigT</span><span class="p">],</span> <span class="n">CallbackSigT</span><span class="p">]:</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSigT</span><span class="p">:</span>
        <span class="k">nonlocal</span> <span class="n">emoji_identifier</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
            <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

        <span class="n">callback</span><span class="o">.</span><span class="n">__emoji_identifier__</span> <span class="o">=</span> <span class="n">emoji_identifier</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">return</span> <span class="n">decorator</span>


<span class="k">class</span> <span class="nc">ReactionHandler</span><span class="p">(</span><span class="n">AbstractReactionHandler</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_authors&quot;</span><span class="p">,</span> <span class="s2">&quot;_callbacks&quot;</span><span class="p">,</span> <span class="s2">&quot;_last_triggered&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">,</span> <span class="s2">&quot;_message&quot;</span><span class="p">,</span> <span class="s2">&quot;_timeout&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">authors</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">CallbackSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>

        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ReactionHandler</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">identifier</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">__emoji_identifier__</span>

                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">authors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">AbstractSet</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Authors/owner of a enabled handler.</span>

<span class="sd">        !!! note</span>
<span class="sd">            If this is empty then the handler is considered public and</span>
<span class="sd">            any user will be able to trigger it.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.AbstractSet[hikari.snowflakes.Snowflake]</span>
<span class="sd">            A set of the owner user IDs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">frozenset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractReactionHandler&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">last_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractReactionHandler&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;How long this handler will wait since the last event before timing out.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        datetime.timedelta</span>
<span class="sd">            How long this handler will wait since the last event before timing out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="n">message</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractReactionHandler&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ReactionHandlerT</span><span class="p">,</span>
        <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">]],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ReactionHandlerT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to this reaction handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emoji_identifier: typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]</span>
<span class="sd">            Identifier of the emoji this callback is for.</span>

<span class="sd">            This should be a snowfake if this is for a custom emoji or a string</span>
<span class="sd">            if this is for a unicode emoji.</span>
<span class="sd">        callback : typing.Callable[[hikari.reaction_events.ReactionAddEvent], typing.Awaitable[None]]</span>
<span class="sd">            The callback to add.</span>

<span class="sd">            This should be a function that accepts a single parameter,</span>
<span class="sd">            which is the event that triggered this reaction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
            <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">[</span><span class="n">emoji_identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a callback from this reaction handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emoji_identifier: typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]</span>
<span class="sd">            Identifier of the emoji the callback to remove is for.</span>

<span class="sd">            This should be a snowfake if this is for a custom emoji or a string</span>
<span class="sd">            if this is for a unicode emoji.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
            <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">[</span><span class="n">emoji_identifier</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">with_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSigT</span><span class="p">],</span> <span class="n">CallbackSigT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to this reaction handler through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emoji_identifier: typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]</span>
<span class="sd">            Identifier of the emoji this callback is for.</span>

<span class="sd">            This should be a snowfake if this is for a custom emoji or a string</span>
<span class="sd">            if this is for a unicode emoji.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Callabke[[CallbackSigT], CallbackSigT]</span>
<span class="sd">            A decorator to add a callback to this reaction handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSigT</span><span class="p">:</span>
            <span class="k">nonlocal</span> <span class="n">emoji_identifier</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
                <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_reaction_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractReactionHandler&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_expired</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
            <span class="k">raise</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">user_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">emoji_id</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">emoji_name</span>
        <span class="k">assert</span> <span class="n">emoji_identifier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">method</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">method</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">_delete_message</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

        <span class="k">except</span> <span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ForbiddenError</span><span class="p">):</span>  <span class="c1"># TODO: attempt to check permissions first</span>
            <span class="k">return</span>

        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>


<span class="k">class</span> <span class="nc">ReactionPaginator</span><span class="p">(</span><span class="n">ReactionHandler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The standard implementation of `AbstractReactionHandler`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    iterator : Iterator[typing.Tuple[undefined.UndefinedOr[str], undefined.UndefinedOr[embeds.Embed]]]</span>
<span class="sd">        Either an asynchronous or synchronous iterator of the entries this</span>
<span class="sd">        should paginate through.</span>
<span class="sd">        Entry[0] represents the message&#39;s possible content and can either be</span>
<span class="sd">        `builtins.str` or `hikari.undefined.UNDEFINED` and Entry[1] represents</span>
<span class="sd">        the message&#39;s possible embed and can either be `hikari.embeds.Embed`</span>
<span class="sd">        or `hikari.undefined.UNDEFINED`.</span>
<span class="sd">    authors : typing.Iterable[hikari.snowflakes.SnowflakeishOr[hikari.users.User]]</span>
<span class="sd">        An iterable of IDs of the users who can call this paginator.</span>
<span class="sd">        If left empty then all users will be able to call this</span>
<span class="sd">        paginator.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    timeout : datetime.timedelta</span>
<span class="sd">        How long it should take for this paginator to timeout.</span>
<span class="sd">        This defaults to a timdelta of 30 seconds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_buffer&quot;</span><span class="p">,</span> <span class="s2">&quot;_index&quot;</span><span class="p">,</span> <span class="s2">&quot;_iterator&quot;</span><span class="p">,</span> <span class="s2">&quot;_triggers&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">iterator</span><span class="p">:</span> <span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]],</span>
        <span class="n">triggers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid value passed for `iterator`, expected an iterator but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">authors</span><span class="o">=</span><span class="n">authors</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]]</span> <span class="o">=</span> <span class="n">iterator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggers</span> <span class="o">=</span> <span class="n">triggers</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_first</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_previous</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_disable</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_next</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_last</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_edit_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
            <span class="c1"># Mypy makes the false assumption that this value will stay as None while this function yields.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">break</span>  <span class="c1"># type: ignore[unreachable]</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

            <span class="k">except</span> <span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ForbiddenError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">HandlerClosed</span><span class="p">()</span> <span class="kn">from</span> <span class="nn">exc</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_disable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># We create a task here rather than awaiting this to ensure the instance is marked as ended as soon as</span>
            <span class="c1"># possible.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">_delete_message</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>

        <span class="k">raise</span> <span class="n">HandlerClosed</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">first_entry</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="k">else</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">()):</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="n">first_entry</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edit_message</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_last</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="k">await</span> <span class="n">pagination</span><span class="o">.</span><span class="n">collect_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edit_message</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_next_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]:</span>
        <span class="c1"># Check to see if we&#39;re behind the buffer before trying to go forward in the generator.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>

        <span class="c1"># If entry is not None then the generator&#39;s position was pushed forwards.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="ow">and</span> <span class="p">(</span><span class="n">entry</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">pagination</span><span class="o">.</span><span class="n">seek_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">entry</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entry</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">():</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="n">entry</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edit_message</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_previous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edit_message</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_author</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ReactionPaginatorT</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ReactionPaginatorT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a author/owner to this handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user : hikari.snowflakes.SnowflakeishOr[hikari.users.User]</span>
<span class="sd">            The user to add as an owner for this handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">user</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a author/owner from this handler.</span>

<span class="sd">        !!! note</span>
<span class="sd">            If the provided user isn&#39;t already a registered owner of this paginator</span>
<span class="sd">            then this should pass silently without raising.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user : hikari.snowflakes.SnowflakeishOr[hikari.users.User]</span>
<span class="sd">            The user to remove from this handler&#39;s owners..</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">user</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">remove_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">max_backoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close this handler and deregister any previously registered message.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        remove_reactions : builtins.bool</span>
<span class="sd">            Whether this should remove the reactions that were being used to</span>
<span class="sd">            paginate through this from the previously registered message.</span>
<span class="sd">            This defaults to `builtins.False`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">remove_reactions</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
            <span class="c1"># TODO: check if we can just clear the reactions before doing this using the cache.</span>
            <span class="k">for</span> <span class="n">emoji_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triggers</span><span class="p">:</span>
                <span class="n">retry</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">remove_reaction</span><span class="p">(</span><span class="n">emoji_name</span><span class="p">)</span>

                    <span class="k">except</span> <span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ForbiddenError</span><span class="p">):</span>
                        <span class="k">return</span>

                    <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                        <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

                    <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">break</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">add_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">max_backoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">add_reactions</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">emoji_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triggers</span><span class="p">:</span>
            <span class="n">retry</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">emoji_name</span><span class="p">)</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">raise</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ForbiddenError</span><span class="p">:</span>  <span class="c1"># TODO: attempt to check permissions first</span>
                    <span class="c1"># If this is reached then we just don&#39;t have reaction permissions in the channel.</span>
                    <span class="k">return</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span> <span class="o">&gt;</span> <span class="n">max_backoff</span><span class="p">:</span>
                        <span class="k">raise</span>

                    <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">emoji_name</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span>
        <span class="n">channel_id</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">TextableChannel</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">add_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">max_backoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start this handler and link it to a bot message.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        message : typing.Optional[hikari.messages.Message]</span>
<span class="sd">            If already created, the message this handler should target.</span>
<span class="sd">            If left as `builtins.None` then this call will create a message</span>
<span class="sd">            in the channel provided when initiating the handler.</span>
<span class="sd">        add_reactions : bool</span>
<span class="sd">            Whether this should also add reactions that&#39;ll be used to paginate</span>
<span class="sd">            over this resource.</span>
<span class="sd">            This defaults to `builtins.True`.</span>

<span class="sd">        !!! note</span>
<span class="sd">            Calling this multiple times will replace the previously registered message.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.messages.Message</span>
<span class="sd">            Object of the message this handler now targets.</span>
<span class="sd">            If `message` was not supplied then this will be the object of a newly created</span>
<span class="sd">            message, otherwise this will be what was supplied as `message`.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided iterator didn&#39;t yield any content for the first message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ReactionPaginator is already running&quot;</span><span class="p">)</span>

        <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ReactionPaginator iterator yielded no pages.&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">rest</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="n">channel_id</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">embed</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span> <span class="o">&gt;</span> <span class="n">max_backoff</span><span class="p">:</span>
                    <span class="k">raise</span>

                <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">rest</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="n">channel_id</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">embed</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">add_reactions</span><span class="o">=</span><span class="n">add_reactions</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span><span class="p">,</span> <span class="n">max_backoff</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">message</span>


<span class="k">class</span> <span class="nc">ReactionClient</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A class which handles the events for multiple registered reaction handlers.</span>

<span class="sd">    .. note::</span>
<span class="sd">        For a quicker way to initialise this client from a bot, see</span>
<span class="sd">        `ReactionClient.from_gateway_bot`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rest : hikari.api.rest.RESTClient</span>
<span class="sd">        The REST client to register this reaction client with.</span>
<span class="sd">    event_manager : hikari.api.event_manager.EventManager</span>
<span class="sd">        The event manager client to register this reaction client with.</span>


<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    event_managed : bool</span>
<span class="sd">        Whether the reaction client should be automatically opened and</span>
<span class="sd">        closed based on the lifetime events dispatched by `event_managed`.</span>
<span class="sd">        This defaults to `True`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;blacklist&quot;</span><span class="p">,</span> <span class="s2">&quot;_event_manager&quot;</span><span class="p">,</span> <span class="s2">&quot;_gc_task&quot;</span><span class="p">,</span> <span class="s2">&quot;_handlers&quot;</span><span class="p">,</span> <span class="s2">&quot;_rest&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span> <span class="n">event_manager</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span> <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span> <span class="o">=</span> <span class="n">event_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">AbstractReactionHandler</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span> <span class="o">=</span> <span class="n">rest</span>

        <span class="k">if</span> <span class="n">event_managed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting_event</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping_event</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReactionClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `ReactionClient` from a gateway bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The bot to build a reaction client for.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether the reaction client should be automatically opened and</span>
<span class="sd">            closed based on the lifetime events dispatched by `bot`.</span>
<span class="sd">            This defaults to `True`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ReactionClient</span>
<span class="sd">            The reaction client for the bot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">event_manager</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span> <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_gc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">listener_id</span><span class="p">,</span> <span class="n">listener</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">listener</span><span class="o">.</span><span class="n">has_expired</span> <span class="ow">or</span> <span class="n">listener_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">listener_id</span><span class="p">]</span>
                <span class="c1"># This may slow this gc task down but the more we yield the better.</span>
                <span class="k">await</span> <span class="n">listener</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># TODO: is this a good time?</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_reaction_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionAddEvent</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ReactionDeleteEvent</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">user_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">listener</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">message_id</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">listener</span><span class="o">.</span><span class="n">on_reaction_event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">HandlerClosed</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">message_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_starting_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_stopping_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add_handler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ReactionClientT</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">paginator</span><span class="p">:</span> <span class="n">AbstractReactionHandler</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ReactionClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a reaction handler to this reaction client.</span>

<span class="sd">        !!! note</span>
<span class="sd">            This does not call `AbstractReactionHandler.open`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]</span>
<span class="sd">            The message ID to add register a reaction handler with.</span>
<span class="sd">        paginator : AbstractReactionHandler</span>
<span class="sd">            The object of the opened paginator to register in this reaction client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">message</span><span class="p">)]</span> <span class="o">=</span> <span class="n">paginator</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_handler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">AbstractReactionHandler</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a reference to a paginator registered in this reaction client.</span>

<span class="sd">        !!! note</span>
<span class="sd">            This does not call `AbstractReactionHandler.close`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]</span>
<span class="sd">            The message ID to remove a paginator for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AbstractReactionHandler</span>
<span class="sd">            The object of the registered paginator if found else `builtins.None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_handler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">AbstractReactionHandler</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Remove a paginator from this reaction client.</span>

<span class="sd">        !!! note</span>
<span class="sd">            This does not call `AbstractReactionHandler.close`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]</span>
<span class="sd">            The message ID to remove a paginator for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AbstractReactionHandler</span>
<span class="sd">            The object of the registered paginator if found else `builtins.None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_try_unsubscribe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="n">event_manager_api</span><span class="o">.</span><span class="n">EventT</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">event_manager_api</span><span class="o">.</span><span class="n">CallbackT</span><span class="p">[</span><span class="n">event_manager_api</span><span class="o">.</span><span class="n">EventT</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">LookupError</span><span class="p">):</span>
            <span class="c1"># TODO: add logging here</span>
            <span class="k">pass</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close this client by unregistering any tasks and event listeners registered by `ReactionClient.open`.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionAddEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionDeleteEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
            <span class="n">listeners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">listener</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start this client by registering the required tasks and event listeners for it to function.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gc</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">())</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionAddEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionDeleteEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Client for higher level callback based reaction menu handling.</p>
</div>


                </section>
                <section id="as_reaction_callback">
                            <div class="attr function"><a class="headerlink" href="#as_reaction_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_reaction_callback</span><span class="signature">(
    emoji_identifier: Union[hikari.emojis.CustomEmoji, hikari.snowflakes.Snowflake, int, str],
    /
) -&gt; Callable[[~CallbackSigT], ~CallbackSigT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_reaction_callback</span><span class="p">(</span>
    <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span> <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSigT</span><span class="p">],</span> <span class="n">CallbackSigT</span><span class="p">]:</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSigT</span><span class="p">:</span>
        <span class="k">nonlocal</span> <span class="n">emoji_identifier</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
            <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

        <span class="n">callback</span><span class="o">.</span><span class="n">__emoji_identifier__</span> <span class="o">=</span> <span class="n">emoji_identifier</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

    

                </section>
                <section id="AbstractReactionHandler">
                                <div class="attr class">
        <a class="headerlink" href="#AbstractReactionHandler">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">AbstractReactionHandler</span><wbr>(<span class="base">abc.ABC</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AbstractReactionHandler</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The interface for a reaction handler used with `ReactionClient`.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this handler has ended.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether this handler has ended.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">last_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;When this handler was last triggered.</span>

<span class="sd">        !!! note</span>
<span class="sd">            If it hasn&#39;t ever been triggered then this will be when it was created.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        datetime.datetime</span>
<span class="sd">            When this handler was last triggered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close this handler.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Open this handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.messages.Message</span>
<span class="sd">            The message to bind this handler to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_reaction_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Handle a reaction event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : EventT</span>
<span class="sd">            The event to handle.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        HandlerClosed</span>
<span class="sd">            If this reaction handler has been closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

        </details>

            <div class="docstring"><p>The interface for a reaction handler used with <code><a href="#ReactionClient">ReactionClient</a></code>.</p>
</div>


                            <div id="AbstractReactionHandler.has_expired" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#AbstractReactionHandler.has_expired">#&nbsp;&nbsp</a>

        <span class="name">has_expired</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this handler has ended.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: Whether this handler has ended.</li>
</ul>
</div>


                            </div>
                            <div id="AbstractReactionHandler.last_triggered" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#AbstractReactionHandler.last_triggered">#&nbsp;&nbsp</a>

        <span class="name">last_triggered</span><span class="annotation">: datetime.datetime</span>
    </div>

            <div class="docstring"><p>When this handler was last triggered.</p>

<p>!!! note
    If it hasn't ever been triggered then this will be when it was created.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>datetime.datetime</strong>: When this handler was last triggered.</li>
</ul>
</div>


                            </div>
                            <div id="AbstractReactionHandler.close" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#AbstractReactionHandler.close">#&nbsp;&nbsp</a>

                <div class="decorator">@abc.abstractmethod</div>

            <span class="def">async def</span>
            <span class="name">close</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close this handler.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

        </details>

            <div class="docstring"><p>Close this handler.</p>
</div>


                            </div>
                            <div id="AbstractReactionHandler.open" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#AbstractReactionHandler.open">#&nbsp;&nbsp</a>

                <div class="decorator">@abc.abstractmethod</div>

            <span class="def">async def</span>
            <span class="name">open</span><span class="signature">(self, message: hikari.messages.Message, /) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Open this handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.messages.Message</span>
<span class="sd">            The message to bind this handler to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

        </details>

            <div class="docstring"><p>Open this handler.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>message</strong> (hikari.messages.Message):
The message to bind this handler to.</li>
</ul>
</div>


                            </div>
                            <div id="AbstractReactionHandler.on_reaction_event" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#AbstractReactionHandler.on_reaction_event">#&nbsp;&nbsp</a>

                <div class="decorator">@abc.abstractmethod</div>

            <span class="def">async def</span>
            <span class="name">on_reaction_event</span><span class="signature">(
    self,
    event: Union[hikari.events.reaction_events.ReactionAddEvent, hikari.events.reaction_events.ReactionDeleteEvent],
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_reaction_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Handle a reaction event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : EventT</span>
<span class="sd">            The event to handle.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        HandlerClosed</span>
<span class="sd">            If this reaction handler has been closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>

        </details>

            <div class="docstring"><p>Handle a reaction event.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event</strong> (EventT):
The event to handle.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>HandlerClosed</strong>: If this reaction handler has been closed.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="ReactionHandler">
                                <div class="attr class">
        <a class="headerlink" href="#ReactionHandler">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ReactionHandler</span><wbr>(<span class="base"><a href="#AbstractReactionHandler">yuyo.AbstractReactionHandler</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ReactionHandler</span><span class="p">(</span><span class="n">AbstractReactionHandler</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_authors&quot;</span><span class="p">,</span> <span class="s2">&quot;_callbacks&quot;</span><span class="p">,</span> <span class="s2">&quot;_last_triggered&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">,</span> <span class="s2">&quot;_message&quot;</span><span class="p">,</span> <span class="s2">&quot;_timeout&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">authors</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">CallbackSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>

        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ReactionHandler</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">identifier</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">__emoji_identifier__</span>

                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">authors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">AbstractSet</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Authors/owner of a enabled handler.</span>

<span class="sd">        !!! note</span>
<span class="sd">            If this is empty then the handler is considered public and</span>
<span class="sd">            any user will be able to trigger it.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.AbstractSet[hikari.snowflakes.Snowflake]</span>
<span class="sd">            A set of the owner user IDs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">frozenset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractReactionHandler&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">last_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractReactionHandler&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;How long this handler will wait since the last event before timing out.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        datetime.timedelta</span>
<span class="sd">            How long this handler will wait since the last event before timing out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="n">message</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractReactionHandler&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ReactionHandlerT</span><span class="p">,</span>
        <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">]],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ReactionHandlerT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to this reaction handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emoji_identifier: typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]</span>
<span class="sd">            Identifier of the emoji this callback is for.</span>

<span class="sd">            This should be a snowfake if this is for a custom emoji or a string</span>
<span class="sd">            if this is for a unicode emoji.</span>
<span class="sd">        callback : typing.Callable[[hikari.reaction_events.ReactionAddEvent], typing.Awaitable[None]]</span>
<span class="sd">            The callback to add.</span>

<span class="sd">            This should be a function that accepts a single parameter,</span>
<span class="sd">            which is the event that triggered this reaction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
            <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">[</span><span class="n">emoji_identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a callback from this reaction handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emoji_identifier: typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]</span>
<span class="sd">            Identifier of the emoji the callback to remove is for.</span>

<span class="sd">            This should be a snowfake if this is for a custom emoji or a string</span>
<span class="sd">            if this is for a unicode emoji.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
            <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">[</span><span class="n">emoji_identifier</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">with_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSigT</span><span class="p">],</span> <span class="n">CallbackSigT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to this reaction handler through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emoji_identifier: typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]</span>
<span class="sd">            Identifier of the emoji this callback is for.</span>

<span class="sd">            This should be a snowfake if this is for a custom emoji or a string</span>
<span class="sd">            if this is for a unicode emoji.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Callabke[[CallbackSigT], CallbackSigT]</span>
<span class="sd">            A decorator to add a callback to this reaction handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSigT</span><span class="p">:</span>
            <span class="k">nonlocal</span> <span class="n">emoji_identifier</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
                <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_reaction_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractReactionHandler&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_expired</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
            <span class="k">raise</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">user_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">emoji_id</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">emoji_name</span>
        <span class="k">assert</span> <span class="n">emoji_identifier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">method</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">method</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>The interface for a reaction handler used with <code><a href="#ReactionClient">ReactionClient</a></code>.</p>
</div>


                            <div id="ReactionHandler.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionHandler.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ReactionHandler</span><span class="signature">(
    *,
    authors: Iterable[Union[hikari.users.User, hikari.snowflakes.Snowflake, int]] = (),
    timeout: datetime.timedelta = datetime.timedelta(seconds=30),
    load_from_attributes: bool = True
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">authors</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">CallbackSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timeout</span> <span class="o">=</span> <span class="n">timeout</span>

        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ReactionHandler</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">identifier</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">__emoji_identifier__</span>

                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ReactionHandler.authors" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ReactionHandler.authors">#&nbsp;&nbsp</a>

        <span class="name">authors</span><span class="annotation">: AbstractSet[hikari.snowflakes.Snowflake]</span>
    </div>

            <div class="docstring"><p>Authors/owner of a enabled handler.</p>

<p>!!! note
    If this is empty then the handler is considered public and
    any user will be able to trigger it.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.AbstractSet[hikari.snowflakes.Snowflake]</strong>: A set of the owner user IDs.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionHandler.has_expired" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ReactionHandler.has_expired">#&nbsp;&nbsp</a>

        <span class="name">has_expired</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this handler has ended.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: Whether this handler has ended.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionHandler.last_triggered" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ReactionHandler.last_triggered">#&nbsp;&nbsp</a>

        <span class="name">last_triggered</span><span class="annotation">: datetime.datetime</span>
    </div>

            <div class="docstring"><p>When this handler was last triggered.</p>

<p>!!! note
    If it hasn't ever been triggered then this will be when it was created.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>datetime.datetime</strong>: When this handler was last triggered.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionHandler.timeout" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ReactionHandler.timeout">#&nbsp;&nbsp</a>

        <span class="name">timeout</span><span class="annotation">: datetime.timedelta</span>
    </div>

            <div class="docstring"><p>How long this handler will wait since the last event before timing out.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>datetime.timedelta</strong>: How long this handler will wait since the last event before timing out.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionHandler.open" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionHandler.open">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">open</span><span class="signature">(self, message: hikari.messages.Message, /) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="n">message</span>
</pre></div>

        </details>

            <div class="docstring"><p>Open this handler.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>message</strong> (hikari.messages.Message):
The message to bind this handler to.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionHandler.close" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionHandler.close">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">close</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractReactionHandler&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

        </details>

            <div class="docstring"><p>Close this handler.</p>
</div>


                            </div>
                            <div id="ReactionHandler.add_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionHandler.add_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_callback</span><span class="signature">(
    self: ~_ReactionHandlerT,
    emoji_identifier: Union[str, hikari.emojis.CustomEmoji, hikari.snowflakes.Snowflake, int],
    callback: Callable[[Union[hikari.events.reaction_events.ReactionAddEvent, hikari.events.reaction_events.ReactionDeleteEvent]], Awaitable[NoneType]],
    /
) -&gt; ~_ReactionHandlerT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ReactionHandlerT</span><span class="p">,</span>
        <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">]],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ReactionHandlerT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to this reaction handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emoji_identifier: typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]</span>
<span class="sd">            Identifier of the emoji this callback is for.</span>

<span class="sd">            This should be a snowfake if this is for a custom emoji or a string</span>
<span class="sd">            if this is for a unicode emoji.</span>
<span class="sd">        callback : typing.Callable[[hikari.reaction_events.ReactionAddEvent], typing.Awaitable[None]]</span>
<span class="sd">            The callback to add.</span>

<span class="sd">            This should be a function that accepts a single parameter,</span>
<span class="sd">            which is the event that triggered this reaction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
            <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">[</span><span class="n">emoji_identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a callback to this reaction handler.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>emoji_identifier</strong> (typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]):
Identifier of the emoji this callback is for.</p>

<p>This should be a snowfake if this is for a custom emoji or a string
if this is for a unicode emoji.</p></li>
<li><p><strong>callback</strong> (typing.Callable[[hikari.reaction_events.ReactionAddEvent], typing.Awaitable[None]]):
The callback to add.</p>

<p>This should be a function that accepts a single parameter,
which is the event that triggered this reaction.</p></li>
</ul>
</div>


                            </div>
                            <div id="ReactionHandler.remove_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionHandler.remove_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_callback</span><span class="signature">(
    self,
    emoji_identifier: Union[str, hikari.emojis.CustomEmoji, hikari.snowflakes.Snowflake, int],
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a callback from this reaction handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emoji_identifier: typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]</span>
<span class="sd">            Identifier of the emoji the callback to remove is for.</span>

<span class="sd">            This should be a snowfake if this is for a custom emoji or a string</span>
<span class="sd">            if this is for a unicode emoji.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
            <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="p">[</span><span class="n">emoji_identifier</span><span class="p">]</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a callback from this reaction handler.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>emoji_identifier</strong> (typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]):
Identifier of the emoji the callback to remove is for.</p>

<p>This should be a snowfake if this is for a custom emoji or a string
if this is for a unicode emoji.</p></li>
</ul>
</div>


                            </div>
                            <div id="ReactionHandler.with_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionHandler.with_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_callback</span><span class="signature">(
    self,
    emoji_identifier: Union[str, hikari.emojis.CustomEmoji, hikari.snowflakes.Snowflake, int],
    /
) -&gt; Callable[[~CallbackSigT], ~CallbackSigT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">emoji_identifier</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSigT</span><span class="p">],</span> <span class="n">CallbackSigT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Add a callback to this reaction handler through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        emoji_identifier: typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]</span>
<span class="sd">            Identifier of the emoji this callback is for.</span>

<span class="sd">            This should be a snowfake if this is for a custom emoji or a string</span>
<span class="sd">            if this is for a unicode emoji.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Callabke[[CallbackSigT], CallbackSigT]</span>
<span class="sd">            A decorator to add a callback to this reaction handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSigT</span><span class="p">:</span>
            <span class="k">nonlocal</span> <span class="n">emoji_identifier</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CustomEmoji</span><span class="p">):</span>
                <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">emoji_identifier</span><span class="o">.</span><span class="n">id</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a callback to this reaction handler through a decorator call.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>emoji_identifier</strong> (typing.Union[str, hikari.snowflakes..SnowflakeishOr[hikari.emojis.CustomEmoji]]):
Identifier of the emoji this callback is for.</p>

<p>This should be a snowfake if this is for a custom emoji or a string
if this is for a unicode emoji.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Callabke[[CallbackSigT], CallbackSigT]</strong>: A decorator to add a callback to this reaction handler.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionHandler.on_reaction_event" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionHandler.on_reaction_event">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">on_reaction_event</span><span class="signature">(
    self,
    event: Union[hikari.events.reaction_events.ReactionAddEvent, hikari.events.reaction_events.ReactionDeleteEvent],
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_reaction_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractReactionHandler&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_expired</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">())</span>
            <span class="k">raise</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">user_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">emoji_identifier</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">emoji_id</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">emoji_name</span>
        <span class="k">assert</span> <span class="n">emoji_identifier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">emoji_identifier</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">method</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">method</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_triggered</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Handle a reaction event.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event</strong> (EventT):
The event to handle.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>HandlerClosed</strong>: If this reaction handler has been closed.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="ReactionPaginator">
                                <div class="attr class">
        <a class="headerlink" href="#ReactionPaginator">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ReactionPaginator</span><wbr>(<span class="base"><a href="#ReactionHandler">yuyo.ReactionHandler</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ReactionPaginator</span><span class="p">(</span><span class="n">ReactionHandler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The standard implementation of `AbstractReactionHandler`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    iterator : Iterator[typing.Tuple[undefined.UndefinedOr[str], undefined.UndefinedOr[embeds.Embed]]]</span>
<span class="sd">        Either an asynchronous or synchronous iterator of the entries this</span>
<span class="sd">        should paginate through.</span>
<span class="sd">        Entry[0] represents the message&#39;s possible content and can either be</span>
<span class="sd">        `builtins.str` or `hikari.undefined.UNDEFINED` and Entry[1] represents</span>
<span class="sd">        the message&#39;s possible embed and can either be `hikari.embeds.Embed`</span>
<span class="sd">        or `hikari.undefined.UNDEFINED`.</span>
<span class="sd">    authors : typing.Iterable[hikari.snowflakes.SnowflakeishOr[hikari.users.User]]</span>
<span class="sd">        An iterable of IDs of the users who can call this paginator.</span>
<span class="sd">        If left empty then all users will be able to call this</span>
<span class="sd">        paginator.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    timeout : datetime.timedelta</span>
<span class="sd">        How long it should take for this paginator to timeout.</span>
<span class="sd">        This defaults to a timdelta of 30 seconds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_buffer&quot;</span><span class="p">,</span> <span class="s2">&quot;_index&quot;</span><span class="p">,</span> <span class="s2">&quot;_iterator&quot;</span><span class="p">,</span> <span class="s2">&quot;_triggers&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">iterator</span><span class="p">:</span> <span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]],</span>
        <span class="n">triggers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid value passed for `iterator`, expected an iterator but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">authors</span><span class="o">=</span><span class="n">authors</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]]</span> <span class="o">=</span> <span class="n">iterator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggers</span> <span class="o">=</span> <span class="n">triggers</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_first</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_previous</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_disable</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_next</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_last</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_edit_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
            <span class="c1"># Mypy makes the false assumption that this value will stay as None while this function yields.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">break</span>  <span class="c1"># type: ignore[unreachable]</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

            <span class="k">except</span> <span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ForbiddenError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">HandlerClosed</span><span class="p">()</span> <span class="kn">from</span> <span class="nn">exc</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_disable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># We create a task here rather than awaiting this to ensure the instance is marked as ended as soon as</span>
            <span class="c1"># possible.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">_delete_message</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>

        <span class="k">raise</span> <span class="n">HandlerClosed</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">first_entry</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="k">else</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">()):</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="n">first_entry</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edit_message</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_last</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="k">await</span> <span class="n">pagination</span><span class="o">.</span><span class="n">collect_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edit_message</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_next_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]:</span>
        <span class="c1"># Check to see if we&#39;re behind the buffer before trying to go forward in the generator.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>

        <span class="c1"># If entry is not None then the generator&#39;s position was pushed forwards.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="ow">and</span> <span class="p">(</span><span class="n">entry</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">pagination</span><span class="o">.</span><span class="n">seek_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">entry</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entry</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">():</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="n">entry</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edit_message</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_previous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">EventT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">embed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edit_message</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_author</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ReactionPaginatorT</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ReactionPaginatorT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a author/owner to this handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user : hikari.snowflakes.SnowflakeishOr[hikari.users.User]</span>
<span class="sd">            The user to add as an owner for this handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">user</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a author/owner from this handler.</span>

<span class="sd">        !!! note</span>
<span class="sd">            If the provided user isn&#39;t already a registered owner of this paginator</span>
<span class="sd">            then this should pass silently without raising.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user : hikari.snowflakes.SnowflakeishOr[hikari.users.User]</span>
<span class="sd">            The user to remove from this handler&#39;s owners..</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">user</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">remove_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">max_backoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close this handler and deregister any previously registered message.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        remove_reactions : builtins.bool</span>
<span class="sd">            Whether this should remove the reactions that were being used to</span>
<span class="sd">            paginate through this from the previously registered message.</span>
<span class="sd">            This defaults to `builtins.False`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">remove_reactions</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
            <span class="c1"># TODO: check if we can just clear the reactions before doing this using the cache.</span>
            <span class="k">for</span> <span class="n">emoji_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triggers</span><span class="p">:</span>
                <span class="n">retry</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">remove_reaction</span><span class="p">(</span><span class="n">emoji_name</span><span class="p">)</span>

                    <span class="k">except</span> <span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ForbiddenError</span><span class="p">):</span>
                        <span class="k">return</span>

                    <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                        <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

                    <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">break</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">add_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">max_backoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">add_reactions</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">emoji_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triggers</span><span class="p">:</span>
            <span class="n">retry</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">emoji_name</span><span class="p">)</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">raise</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ForbiddenError</span><span class="p">:</span>  <span class="c1"># TODO: attempt to check permissions first</span>
                    <span class="c1"># If this is reached then we just don&#39;t have reaction permissions in the channel.</span>
                    <span class="k">return</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span> <span class="o">&gt;</span> <span class="n">max_backoff</span><span class="p">:</span>
                        <span class="k">raise</span>

                    <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">emoji_name</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span>
        <span class="n">channel_id</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">TextableChannel</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">add_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">max_backoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start this handler and link it to a bot message.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        message : typing.Optional[hikari.messages.Message]</span>
<span class="sd">            If already created, the message this handler should target.</span>
<span class="sd">            If left as `builtins.None` then this call will create a message</span>
<span class="sd">            in the channel provided when initiating the handler.</span>
<span class="sd">        add_reactions : bool</span>
<span class="sd">            Whether this should also add reactions that&#39;ll be used to paginate</span>
<span class="sd">            over this resource.</span>
<span class="sd">            This defaults to `builtins.True`.</span>

<span class="sd">        !!! note</span>
<span class="sd">            Calling this multiple times will replace the previously registered message.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.messages.Message</span>
<span class="sd">            Object of the message this handler now targets.</span>
<span class="sd">            If `message` was not supplied then this will be the object of a newly created</span>
<span class="sd">            message, otherwise this will be what was supplied as `message`.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided iterator didn&#39;t yield any content for the first message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ReactionPaginator is already running&quot;</span><span class="p">)</span>

        <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ReactionPaginator iterator yielded no pages.&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">rest</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="n">channel_id</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">embed</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span> <span class="o">&gt;</span> <span class="n">max_backoff</span><span class="p">:</span>
                    <span class="k">raise</span>

                <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">rest</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="n">channel_id</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">embed</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">add_reactions</span><span class="o">=</span><span class="n">add_reactions</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span><span class="p">,</span> <span class="n">max_backoff</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">message</span>
</pre></div>

        </details>

            <div class="docstring"><p>The standard implementation of <code><a href="#AbstractReactionHandler">AbstractReactionHandler</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>iterator</strong> (Iterator[typing.Tuple[undefined.UndefinedOr[str], undefined.UndefinedOr[embeds.Embed]]]):
Either an asynchronous or synchronous iterator of the entries this
should paginate through.
Entry[0] represents the message's possible content and can either be
<code>builtins.str</code> or <code>hikari.undefined.UNDEFINED</code> and Entry[1] represents
the message's possible embed and can either be <code>hikari.embeds.Embed</code>
or <code>hikari.undefined.UNDEFINED</code>.</li>
<li><strong>authors</strong> (typing.Iterable[hikari.snowflakes.SnowflakeishOr[hikari.users.User]]):
An iterable of IDs of the users who can call this paginator.
If left empty then all users will be able to call this
paginator.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>timeout</strong> (datetime.timedelta):
How long it should take for this paginator to timeout.
This defaults to a timdelta of 30 seconds.</li>
</ul>
</div>


                            <div id="ReactionPaginator.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionPaginator.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ReactionPaginator</span><span class="signature">(
    iterator: Union[AsyncIterator[Tuple[Union[str, hikari.undefined.UndefinedType], Union[hikari.embeds.Embed, hikari.undefined.UndefinedType]]], Iterator[Tuple[Union[str, hikari.undefined.UndefinedType], Union[hikari.embeds.Embed, hikari.undefined.UndefinedType]]]],
    *,
    authors: Iterable[Union[hikari.users.User, hikari.snowflakes.Snowflake, int]],
    triggers: Collection[str] = (&#39;&#39;, &#39;&#39;, &#39;&#39;),
    timeout: datetime.timedelta = datetime.timedelta(seconds=30)
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">iterator</span><span class="p">:</span> <span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">authors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]],</span>
        <span class="n">triggers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span><span class="p">,</span>
            <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid value passed for `iterator`, expected an iterator but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">authors</span><span class="o">=</span><span class="n">authors</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">load_from_attributes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">IteratorT</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]]</span> <span class="o">=</span> <span class="n">iterator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggers</span> <span class="o">=</span> <span class="n">triggers</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_DOUBLE_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_first</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">LEFT_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_previous</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">STOP_SQUARE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_disable</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_next</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span> <span class="ow">in</span> <span class="n">triggers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">pagination</span><span class="o">.</span><span class="n">RIGHT_DOUBLE_TRIANGLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_last</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ReactionPaginator.get_next_entry" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionPaginator.get_next_entry">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">get_next_entry</span><span class="signature">(
    self,
    /
) -&gt; Optional[Tuple[Union[str, hikari.undefined.UndefinedType], Union[hikari.embeds.Embed, hikari.undefined.UndefinedType]]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_next_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pagination</span><span class="o">.</span><span class="n">EntryT</span><span class="p">]:</span>
        <span class="c1"># Check to see if we&#39;re behind the buffer before trying to go forward in the generator.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span>

        <span class="c1"># If entry is not None then the generator&#39;s position was pushed forwards.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span> <span class="ow">and</span> <span class="p">(</span><span class="n">entry</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">pagination</span><span class="o">.</span><span class="n">seek_iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterator</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">entry</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ReactionPaginator.add_author" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionPaginator.add_author">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_author</span><span class="signature">(
    self: ~_ReactionPaginatorT,
    user: Union[hikari.users.User, hikari.snowflakes.Snowflake, int],
    /
) -&gt; ~_ReactionPaginatorT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_author</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ReactionPaginatorT</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ReactionPaginatorT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a author/owner to this handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user : hikari.snowflakes.SnowflakeishOr[hikari.users.User]</span>
<span class="sd">            The user to add as an owner for this handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">user</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a author/owner to this handler.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>user</strong> (hikari.snowflakes.SnowflakeishOr[hikari.users.User]):
The user to add as an owner for this handler.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionPaginator.remove_author" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionPaginator.remove_author">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_author</span><span class="signature">(
    self,
    user: Union[hikari.users.User, hikari.snowflakes.Snowflake, int],
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a author/owner from this handler.</span>

<span class="sd">        !!! note</span>
<span class="sd">            If the provided user isn&#39;t already a registered owner of this paginator</span>
<span class="sd">            then this should pass silently without raising.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user : hikari.snowflakes.SnowflakeishOr[hikari.users.User]</span>
<span class="sd">            The user to remove from this handler&#39;s owners..</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">user</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a author/owner from this handler.</p>

<p>!!! note
    If the provided user isn't already a registered owner of this paginator
    then this should pass silently without raising.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>user</strong> (hikari.snowflakes.SnowflakeishOr[hikari.users.User]):
The user to remove from this handler's owners..</li>
</ul>
</div>


                            </div>
                            <div id="ReactionPaginator.close" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionPaginator.close">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">close</span><span class="signature">(
    self,
    *,
    remove_reactions: bool = False,
    max_retries: int = 5,
    max_backoff: float = 2.0
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">remove_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">max_backoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close this handler and deregister any previously registered message.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        remove_reactions : builtins.bool</span>
<span class="sd">            Whether this should remove the reactions that were being used to</span>
<span class="sd">            paginate through this from the previously registered message.</span>
<span class="sd">            This defaults to `builtins.False`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">remove_reactions</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
            <span class="c1"># TODO: check if we can just clear the reactions before doing this using the cache.</span>
            <span class="k">for</span> <span class="n">emoji_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triggers</span><span class="p">:</span>
                <span class="n">retry</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">remove_reaction</span><span class="p">(</span><span class="n">emoji_name</span><span class="p">)</span>

                    <span class="k">except</span> <span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ForbiddenError</span><span class="p">):</span>
                        <span class="k">return</span>

                    <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                        <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

                    <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">break</span>
</pre></div>

        </details>

            <div class="docstring"><p>Close this handler and deregister any previously registered message.</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>remove_reactions</strong> (builtins.bool):
Whether this should remove the reactions that were being used to
paginate through this from the previously registered message.
This defaults to <code>builtins.False</code>.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionPaginator.open" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionPaginator.open">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">open</span><span class="signature">(
    self,
    message: hikari.messages.Message,
    /,
    *,
    add_reactions: bool = True,
    max_retries: int = 5,
    max_backoff: float = 2.0
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">add_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">max_backoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">add_reactions</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">emoji_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triggers</span><span class="p">:</span>
            <span class="n">retry</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">emoji_name</span><span class="p">)</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">raise</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ForbiddenError</span><span class="p">:</span>  <span class="c1"># TODO: attempt to check permissions first</span>
                    <span class="c1"># If this is reached then we just don&#39;t have reaction permissions in the channel.</span>
                    <span class="k">return</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span> <span class="o">&gt;</span> <span class="n">max_backoff</span><span class="p">:</span>
                        <span class="k">raise</span>

                    <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

                <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">add_reaction</span><span class="p">(</span><span class="n">emoji_name</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Open this handler.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>message</strong> (hikari.messages.Message):
The message to bind this handler to.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionPaginator.create_message" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionPaginator.create_message">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">create_message</span><span class="signature">(
    self,
    rest: hikari.api.rest.RESTClient,
    channel_id: Union[hikari.channels.TextableChannel, hikari.snowflakes.Snowflake, int],
    /,
    *,
    add_reactions: bool = True,
    max_retries: int = 5,
    max_backoff: float = 2.0
) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span>
        <span class="n">channel_id</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">TextableChannel</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">add_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">max_backoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start this handler and link it to a bot message.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        message : typing.Optional[hikari.messages.Message]</span>
<span class="sd">            If already created, the message this handler should target.</span>
<span class="sd">            If left as `builtins.None` then this call will create a message</span>
<span class="sd">            in the channel provided when initiating the handler.</span>
<span class="sd">        add_reactions : bool</span>
<span class="sd">            Whether this should also add reactions that&#39;ll be used to paginate</span>
<span class="sd">            over this resource.</span>
<span class="sd">            This defaults to `builtins.True`.</span>

<span class="sd">        !!! note</span>
<span class="sd">            Calling this multiple times will replace the previously registered message.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.messages.Message</span>
<span class="sd">            Object of the message this handler now targets.</span>
<span class="sd">            If `message` was not supplied then this will be the object of a newly created</span>
<span class="sd">            message, otherwise this will be what was supplied as `message`.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided iterator didn&#39;t yield any content for the first message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ReactionPaginator is already running&quot;</span><span class="p">)</span>

        <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_entry</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ReactionPaginator iterator yielded no pages.&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">rest</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="n">channel_id</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">embed</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span> <span class="o">&gt;</span> <span class="n">max_backoff</span><span class="p">:</span>
                    <span class="k">raise</span>

                <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="n">rest</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="n">channel_id</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">embed</span><span class="o">=</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">add_reactions</span><span class="o">=</span><span class="n">add_reactions</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span><span class="p">,</span> <span class="n">max_backoff</span><span class="o">=</span><span class="n">max_backoff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">message</span>
</pre></div>

        </details>

            <div class="docstring"><p>Start this handler and link it to a bot message.</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>message</strong> (typing.Optional[hikari.messages.Message]):
If already created, the message this handler should target.
If left as <code>builtins.None</code> then this call will create a message
in the channel provided when initiating the handler.</li>
<li><strong>add_reactions</strong> (bool):
Whether this should also add reactions that'll be used to paginate
over this resource.
This defaults to <code>builtins.True</code>.</li>
<li><strong>!!! note</strong>: Calling this multiple times will replace the previously registered message.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.messages.Message</strong>: Object of the message this handler now targets.
If <code>message</code> was not supplied then this will be the object of a newly created
message, otherwise this will be what was supplied as <code>message</code>.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the provided iterator didn't yield any content for the first message.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ReactionHandler">ReactionHandler</a></dt>
                                <dd id="ReactionPaginator.authors" class="variable"><a href="#ReactionHandler.authors">authors</a></dd>
                <dd id="ReactionPaginator.has_expired" class="variable"><a href="#ReactionHandler.has_expired">has_expired</a></dd>
                <dd id="ReactionPaginator.last_triggered" class="variable"><a href="#ReactionHandler.last_triggered">last_triggered</a></dd>
                <dd id="ReactionPaginator.timeout" class="variable"><a href="#ReactionHandler.timeout">timeout</a></dd>
                <dd id="ReactionPaginator.add_callback" class="function"><a href="#ReactionHandler.add_callback">add_callback</a></dd>
                <dd id="ReactionPaginator.remove_callback" class="function"><a href="#ReactionHandler.remove_callback">remove_callback</a></dd>
                <dd id="ReactionPaginator.with_callback" class="function"><a href="#ReactionHandler.with_callback">with_callback</a></dd>
                <dd id="ReactionPaginator.on_reaction_event" class="function"><a href="#ReactionHandler.on_reaction_event">on_reaction_event</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ReactionClient">
                                <div class="attr class">
        <a class="headerlink" href="#ReactionClient">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ReactionClient</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ReactionClient</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A class which handles the events for multiple registered reaction handlers.</span>

<span class="sd">    .. note::</span>
<span class="sd">        For a quicker way to initialise this client from a bot, see</span>
<span class="sd">        `ReactionClient.from_gateway_bot`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rest : hikari.api.rest.RESTClient</span>
<span class="sd">        The REST client to register this reaction client with.</span>
<span class="sd">    event_manager : hikari.api.event_manager.EventManager</span>
<span class="sd">        The event manager client to register this reaction client with.</span>


<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    event_managed : bool</span>
<span class="sd">        Whether the reaction client should be automatically opened and</span>
<span class="sd">        closed based on the lifetime events dispatched by `event_managed`.</span>
<span class="sd">        This defaults to `True`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;blacklist&quot;</span><span class="p">,</span> <span class="s2">&quot;_event_manager&quot;</span><span class="p">,</span> <span class="s2">&quot;_gc_task&quot;</span><span class="p">,</span> <span class="s2">&quot;_handlers&quot;</span><span class="p">,</span> <span class="s2">&quot;_rest&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span> <span class="n">event_manager</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span> <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span> <span class="o">=</span> <span class="n">event_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">AbstractReactionHandler</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span> <span class="o">=</span> <span class="n">rest</span>

        <span class="k">if</span> <span class="n">event_managed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting_event</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping_event</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReactionClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `ReactionClient` from a gateway bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The bot to build a reaction client for.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether the reaction client should be automatically opened and</span>
<span class="sd">            closed based on the lifetime events dispatched by `bot`.</span>
<span class="sd">            This defaults to `True`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ReactionClient</span>
<span class="sd">            The reaction client for the bot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">event_manager</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span> <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_gc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">listener_id</span><span class="p">,</span> <span class="n">listener</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">listener</span><span class="o">.</span><span class="n">has_expired</span> <span class="ow">or</span> <span class="n">listener_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">listener_id</span><span class="p">]</span>
                <span class="c1"># This may slow this gc task down but the more we yield the better.</span>
                <span class="k">await</span> <span class="n">listener</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># TODO: is this a good time?</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_reaction_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionAddEvent</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">ReactionDeleteEvent</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">user_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">listener</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">message_id</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">listener</span><span class="o">.</span><span class="n">on_reaction_event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">HandlerClosed</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">message_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_starting_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_stopping_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add_handler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ReactionClientT</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">paginator</span><span class="p">:</span> <span class="n">AbstractReactionHandler</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ReactionClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a reaction handler to this reaction client.</span>

<span class="sd">        !!! note</span>
<span class="sd">            This does not call `AbstractReactionHandler.open`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]</span>
<span class="sd">            The message ID to add register a reaction handler with.</span>
<span class="sd">        paginator : AbstractReactionHandler</span>
<span class="sd">            The object of the opened paginator to register in this reaction client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">message</span><span class="p">)]</span> <span class="o">=</span> <span class="n">paginator</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_handler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">AbstractReactionHandler</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a reference to a paginator registered in this reaction client.</span>

<span class="sd">        !!! note</span>
<span class="sd">            This does not call `AbstractReactionHandler.close`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]</span>
<span class="sd">            The message ID to remove a paginator for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AbstractReactionHandler</span>
<span class="sd">            The object of the registered paginator if found else `builtins.None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove_handler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">AbstractReactionHandler</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Remove a paginator from this reaction client.</span>

<span class="sd">        !!! note</span>
<span class="sd">            This does not call `AbstractReactionHandler.close`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]</span>
<span class="sd">            The message ID to remove a paginator for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AbstractReactionHandler</span>
<span class="sd">            The object of the registered paginator if found else `builtins.None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_try_unsubscribe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="n">event_manager_api</span><span class="o">.</span><span class="n">EventT</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">event_manager_api</span><span class="o">.</span><span class="n">CallbackT</span><span class="p">[</span><span class="n">event_manager_api</span><span class="o">.</span><span class="n">EventT</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">LookupError</span><span class="p">):</span>
            <span class="c1"># TODO: add logging here</span>
            <span class="k">pass</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close this client by unregistering any tasks and event listeners registered by `ReactionClient.open`.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionAddEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionDeleteEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
            <span class="n">listeners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">listener</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start this client by registering the required tasks and event listeners for it to function.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gc</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">())</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionAddEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionDeleteEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>A class which handles the events for multiple registered reaction handlers.</p>

<p><em>Note:</em>
For a quicker way to initialise this client from a bot, see
<code><a href="#ReactionClient.from_gateway_bot">ReactionClient.from_gateway_bot</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>rest</strong> (hikari.api.rest.RESTClient):
The REST client to register this reaction client with.</li>
<li><strong>event_manager</strong> (hikari.api.event_manager.EventManager):
The event manager client to register this reaction client with.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>event_managed</strong> (bool):
Whether the reaction client should be automatically opened and
closed based on the lifetime events dispatched by <code>event_managed</code>.
This defaults to <code>True</code>.</li>
</ul>
</div>


                            <div id="ReactionClient.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionClient.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ReactionClient</span><span class="signature">(
    *,
    rest: hikari.api.rest.RESTClient,
    event_manager: hikari.api.event_manager.EventManager,
    event_managed: bool = True
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span> <span class="n">event_manager</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span> <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span> <span class="o">=</span> <span class="n">event_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">AbstractReactionHandler</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span> <span class="o">=</span> <span class="n">rest</span>

        <span class="k">if</span> <span class="n">event_managed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting_event</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping_event</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ReactionClient.blacklist" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ReactionClient.blacklist">#&nbsp;&nbsp</a>

        <span class="name">blacklist</span><span class="annotation">: List[hikari.snowflakes.Snowflake]</span>
    </div>

    

                            </div>
                            <div id="ReactionClient.from_gateway_bot" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionClient.from_gateway_bot">#&nbsp;&nbsp</a>

                <div class="decorator">@classmethod</div>

            <span class="def">def</span>
            <span class="name">from_gateway_bot</span><span class="signature">(
    cls,
    bot: hikari.traits.GatewayBotAware,
    /,
    *,
    event_managed: bool = True
) -&gt; <a href="yuyo/reactions.html#ReactionClient">yuyo.reactions.ReactionClient</a></span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReactionClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `ReactionClient` from a gateway bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The bot to build a reaction client for.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether the reaction client should be automatically opened and</span>
<span class="sd">            closed based on the lifetime events dispatched by `bot`.</span>
<span class="sd">            This defaults to `True`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ReactionClient</span>
<span class="sd">            The reaction client for the bot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">event_manager</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span> <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a <code><a href="#ReactionClient">ReactionClient</a></code> from a gateway bot.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>bot</strong> (hikari.traits.GatewayBotAware):
The bot to build a reaction client for.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>event_managed</strong> (bool):
Whether the reaction client should be automatically opened and
closed based on the lifetime events dispatched by <code>bot</code>.
This defaults to <code>True</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ReactionClient</strong>: The reaction client for the bot.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionClient.is_closed" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ReactionClient.is_closed">#&nbsp;&nbsp</a>

        <span class="name">is_closed</span><span class="annotation">: bool</span>
    </div>

    

                            </div>
                            <div id="ReactionClient.add_handler" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionClient.add_handler">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_handler</span><span class="signature">(
    self: ~_ReactionClientT,
    message: Union[hikari.messages.Message, hikari.snowflakes.Snowflake, int],
    /,
    paginator: <a href="yuyo/reactions.html#AbstractReactionHandler">yuyo.reactions.AbstractReactionHandler</a>
) -&gt; ~_ReactionClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_handler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ReactionClientT</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">paginator</span><span class="p">:</span> <span class="n">AbstractReactionHandler</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ReactionClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a reaction handler to this reaction client.</span>

<span class="sd">        !!! note</span>
<span class="sd">            This does not call `AbstractReactionHandler.open`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]</span>
<span class="sd">            The message ID to add register a reaction handler with.</span>
<span class="sd">        paginator : AbstractReactionHandler</span>
<span class="sd">            The object of the opened paginator to register in this reaction client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">message</span><span class="p">)]</span> <span class="o">=</span> <span class="n">paginator</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a reaction handler to this reaction client.</p>

<p>!!! note
    This does not call <code><a href="#AbstractReactionHandler.open">AbstractReactionHandler.open</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>message</strong> (hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]):
The message ID to add register a reaction handler with.</li>
<li><strong>paginator</strong> (AbstractReactionHandler):
The object of the opened paginator to register in this reaction client.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionClient.get_handler" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionClient.get_handler">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_handler</span><span class="signature">(
    self,
    message: Union[hikari.messages.Message, hikari.snowflakes.Snowflake, int],
    /
) -&gt; Optional[<a href="yuyo/reactions.html#AbstractReactionHandler">yuyo.reactions.AbstractReactionHandler</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_handler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">AbstractReactionHandler</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a reference to a paginator registered in this reaction client.</span>

<span class="sd">        !!! note</span>
<span class="sd">            This does not call `AbstractReactionHandler.close`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]</span>
<span class="sd">            The message ID to remove a paginator for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AbstractReactionHandler</span>
<span class="sd">            The object of the registered paginator if found else `builtins.None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get a reference to a paginator registered in this reaction client.</p>

<p>!!! note
    This does not call <code><a href="#AbstractReactionHandler.close">AbstractReactionHandler.close</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>message</strong> (hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]):
The message ID to remove a paginator for.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>AbstractReactionHandler</strong>: The object of the registered paginator if found else <code>builtins.None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionClient.remove_handler" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionClient.remove_handler">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_handler</span><span class="signature">(
    self,
    message: Union[hikari.messages.Message, hikari.snowflakes.Snowflake, int],
    /
) -&gt; Optional[<a href="yuyo/reactions.html#AbstractReactionHandler">yuyo.reactions.AbstractReactionHandler</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_handler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">AbstractReactionHandler</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Remove a paginator from this reaction client.</span>

<span class="sd">        !!! note</span>
<span class="sd">            This does not call `AbstractReactionHandler.close`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]</span>
<span class="sd">            The message ID to remove a paginator for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AbstractReactionHandler</span>
<span class="sd">            The object of the registered paginator if found else `builtins.None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a paginator from this reaction client.</p>

<p>!!! note
    This does not call <code><a href="#AbstractReactionHandler.close">AbstractReactionHandler.close</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>message</strong> (hikari.snowflakes.SnowflakeishOr[hikari.messages.Message]):
The message ID to remove a paginator for.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>AbstractReactionHandler</strong>: The object of the registered paginator if found else <code>builtins.None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="ReactionClient.close" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionClient.close">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">close</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close this client by unregistering any tasks and event listeners registered by `ReactionClient.open`.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionAddEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionDeleteEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
            <span class="n">listeners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">listener</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Close this client by unregistering any tasks and event listeners registered by <code><a href="#ReactionClient.open">ReactionClient.open</a></code>.</p>
</div>


                            </div>
                            <div id="ReactionClient.open" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ReactionClient.open">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">open</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start this client by registering the required tasks and event listeners for it to function.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gc_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gc</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">())</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionAddEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_event_manager</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">ReactionDeleteEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reaction_event</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Start this client by registering the required tasks and event listeners for it to function.</p>
</div>


                            </div>
                </section>
                <section id="pagination">
                                <div class="attr module"><a class="headerlink" href="#pagination">#&nbsp;&nbsp</a>
<span class="name"><a href="yuyo/pagination.html">yuyo.pagination</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Utilities used for quick pagination handling within reaction and component executors.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;async_paginate_string&quot;</span><span class="p">,</span> <span class="s2">&quot;sync_paginate_string&quot;</span><span class="p">,</span> <span class="s2">&quot;paginate_string&quot;</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">collections.abc</span> <span class="k">as</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">hikari</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;A type hint used to represent the type handled by an iterator.&quot;&quot;&quot;</span>

<span class="n">DefaultT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;DefaultT&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;A type hint used to represent a &quot;default&quot; argument provided to a function.&quot;&quot;&quot;</span>


<span class="n">EntryT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span>
<span class="sd">&quot;&quot;&quot;A type hint used to represent a paginator entry.</span>

<span class="sd">This should be a tuple of the string message content or `hikari.undefined.UNDEFINED`</span>
<span class="sd">to the message&#39;s embed if set else `hikari.undefined.UNDEFINED`.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">LEFT_DOUBLE_TRIANGLE</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">(</span>
    <span class="s2">&quot;</span><span class="se">\N{BLACK LEFT-POINTING DOUBLE TRIANGLE WITH VERTICAL BAR}\N{VARIATION SELECTOR-16}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;The emoji used to go back to the first entry.&quot;&quot;&quot;</span>
<span class="n">LEFT_TRIANGLE</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">(</span>
    <span class="s2">&quot;</span><span class="se">\N{BLACK LEFT-POINTING TRIANGLE}\N{VARIATION SELECTOR-16}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;The emoji used to go back an entry.&quot;&quot;&quot;</span>
<span class="n">STOP_SQUARE</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">(</span>
    <span class="s2">&quot;</span><span class="se">\N{BLACK SQUARE FOR STOP}\N{VARIATION SELECTOR-16}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;The emoji used to close a menu in a reaction context.&quot;&quot;&quot;</span>
<span class="n">RIGHT_TRIANGLE</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">(</span>
    <span class="s2">&quot;</span><span class="se">\N{BLACK RIGHT-POINTING TRIANGLE}\N{VARIATION SELECTOR-16}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;The emoji used to continue to the next entry.&quot;&quot;&quot;</span>
<span class="n">RIGHT_DOUBLE_TRIANGLE</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">(</span>
    <span class="s2">&quot;</span><span class="se">\N{BLACK RIGHT-POINTING DOUBLE TRIANGLE WITH VERTICAL BAR}\N{VARIATION SELECTOR-16}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;The emoji used for the lesser-enabled skip to last entry button.&quot;&quot;&quot;</span>
<span class="n">BLACK_CROSS</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UnicodeEmoji</span><span class="p">(</span>
    <span class="s2">&quot;</span><span class="se">\N{HEAVY MULTIPLICATION X}\N{VARIATION SELECTOR-16}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;The emoji used to close a menu in a component context.&quot;&quot;&quot;</span>


<span class="n">IteratorT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">T</span><span class="p">]]</span>
<span class="sd">&quot;&quot;&quot;A type hint used in places where both iterators and async-iterators are supported.&quot;&quot;&quot;</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">collect_iterator</span><span class="p">(</span><span class="n">iterator</span><span class="p">:</span> <span class="n">IteratorT</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Collect the rest of an async or sync iterator into a mutable sequence.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    iterator : typing.union[typing.AsyncIterator[ValueT], typing.Iterator[ValueT]]</span>
<span class="sd">        The iterator to collect. This iterator may be asynchronous or synchronous.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ValueT</span>
<span class="sd">        A sequence of the remaining values in the iterator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">value</span> <span class="k">async</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span><span class="si">!r}</span><span class="s2"> is not a valid iterator&quot;</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">seek_iterator</span><span class="p">(</span><span class="n">iterator</span><span class="p">:</span> <span class="n">IteratorT</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">DefaultT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">DefaultT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get the next value in an async or sync iterator.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">):</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">seek_async_iterator</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">seek_sync_iterator</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span><span class="si">!r}</span><span class="s2"> is not a valid iterator&quot;</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">seek_async_iterator</span><span class="p">(</span><span class="n">iterator</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">DefaultT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">DefaultT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get the next value in an async iterator.&quot;&quot;&quot;</span>
    <span class="k">async</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">return</span> <span class="n">default</span>


<span class="k">def</span> <span class="nf">seek_sync_iterator</span><span class="p">(</span><span class="n">iterator</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">DefaultT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">DefaultT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get the next value in an async iterator.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">async_paginate_string</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">char_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="n">line_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">wrapper</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Lazily paginate an iterator of lines.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lines : typing.AsyncIterator[builtins.str]</span>
<span class="sd">        The asynchronous iterator of lines to paginate.</span>
<span class="sd">    char_limit : builtins.int</span>
<span class="sd">        The limit for how many characters should be included per yielded page.</span>
<span class="sd">        This defaults to 2000</span>
<span class="sd">    line_limit : builtins.int</span>
<span class="sd">        The limit for how many lines should be included per yielded page.</span>
<span class="sd">        This defaults to 25.</span>
<span class="sd">    wrapper : typing.Optional[builtins.str]</span>
<span class="sd">        A wrapper for each yielded page. This should leave &quot;{}&quot; in it</span>
<span class="sd">        to be replaced by the page&#39;s content.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    typing.AsyncIterator[typing.Tuple[builtins.str, builtins.int]]</span>
<span class="sd">        An async iterator of page tuples (string context to int zero-based index).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">wrapper</span><span class="p">:</span>
        <span class="n">char_limit</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

    <span class="c1"># As this is incremented before yielding and zero-index we have to start at -1.</span>
    <span class="n">page_number</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">page_size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">page</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">line</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">seek_async_iterator</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If the page is already populated and adding the current line would bring it over one of the predefined limits</span>
        <span class="c1"># then we want to yield this page.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">page</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">line_limit</span> <span class="ow">or</span> <span class="n">page</span> <span class="ow">and</span> <span class="n">page_size</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">char_limit</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">))</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">),</span> <span class="p">(</span><span class="n">page_number</span> <span class="o">:=</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">page</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">page_size</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># If the current line doesn&#39;t fit into a page then we need to split it up into sub-pages to yield and can</span>
        <span class="c1"># assume the previous page was yielded.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">char_limit</span><span class="p">:</span>
            <span class="n">sub_pages</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span>
                <span class="n">line</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">char_limit</span><span class="p">,</span> <span class="n">drop_whitespace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">break_on_hyphens</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">expand_tabs</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

            <span class="c1"># If the last page could possible fit into a page with other lines then we add it to the next page</span>
            <span class="c1"># to avoid sending small terraced pages.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_pages</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">char_limit</span><span class="p">:</span>
                <span class="n">sub_line</span> <span class="o">=</span> <span class="n">sub_pages</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">page_size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_line</span><span class="p">)</span>
                <span class="n">page</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_line</span><span class="p">)</span>

            <span class="c1"># yield all the sub-lines at once.</span>
            <span class="k">for</span> <span class="n">sub_line</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">sub_pages</span><span class="p">)</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="n">sub_pages</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">sub_line</span><span class="p">,</span> <span class="p">(</span><span class="n">page_number</span> <span class="o">:=</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Otherwise it should be added to the next page.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">page_size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">page</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="c1"># This catches the likely dangling page after iteration ends.</span>
    <span class="k">if</span> <span class="n">page</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">))</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">),</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">sync_paginate_string</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">char_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="n">line_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">wrapper</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Lazily paginate an iterator of lines.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lines : typing.Iterator[builtins.str]</span>
<span class="sd">        The iterator of lines to paginate.</span>
<span class="sd">    char_limit : builtins.int</span>
<span class="sd">        The limit for how many characters should be included per yielded page.</span>
<span class="sd">        This defaults to 2000</span>
<span class="sd">    line_limit : builtins.int</span>
<span class="sd">        The limit for how many lines should be included per yielded page.</span>
<span class="sd">        This defaults to 25.</span>
<span class="sd">    wrapper : typing.Optional[builtins.str]</span>
<span class="sd">        A wrapper for each yielded page. This should leave &quot;{}&quot; in it</span>
<span class="sd">        to be replaced by the page&#39;s content.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    typing.Iterator[typing.Tuple[builtins.str, builtins.int]]</span>
<span class="sd">        An iterator of page tuples (string context to int zero-based index).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">wrapper</span><span class="p">:</span>
        <span class="n">char_limit</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

    <span class="c1"># As this is incremented before yielding and zero-index we have to start at -1.</span>
    <span class="n">page_number</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">page_size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">page</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">line</span> <span class="o">:=</span> <span class="n">seek_sync_iterator</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If the page is already populated and adding the current line would bring it over one of the predefined limits</span>
        <span class="c1"># then we want to yield this page.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">page</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">line_limit</span> <span class="ow">or</span> <span class="n">page</span> <span class="ow">and</span> <span class="n">page_size</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">char_limit</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">))</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">),</span> <span class="p">(</span><span class="n">page_number</span> <span class="o">:=</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">page</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">page_size</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># If the current line doesn&#39;t fit into a page then we need to split it up into sub-pages to yield and can</span>
        <span class="c1"># assume the previous page was yielded.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">char_limit</span><span class="p">:</span>
            <span class="n">sub_pages</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span>
                <span class="n">line</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">char_limit</span><span class="p">,</span> <span class="n">drop_whitespace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">break_on_hyphens</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">expand_tabs</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

            <span class="c1"># If the last page could possible fit into a page with other lines then we add it to the next page</span>
            <span class="c1"># to avoid sending small terraced pages.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_pages</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">char_limit</span><span class="p">:</span>
                <span class="n">sub_line</span> <span class="o">=</span> <span class="n">sub_pages</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">page_size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_line</span><span class="p">)</span>
                <span class="n">page</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_line</span><span class="p">)</span>

            <span class="c1"># yield all the sub-lines at once.</span>
            <span class="k">for</span> <span class="n">sub_line</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">sub_pages</span><span class="p">)</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="n">sub_pages</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">sub_line</span><span class="p">,</span> <span class="p">(</span><span class="n">page_number</span> <span class="o">:=</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Otherwise it should be added to the next page.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">page_size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">page</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="c1"># This catches the likely dangling page after iteration ends.</span>
    <span class="k">if</span> <span class="n">page</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">))</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">),</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">paginate_string</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">char_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="n">line_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">wrapper</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="o">...</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">paginate_string</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">char_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="n">line_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">wrapper</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="o">...</span>


<span class="k">def</span> <span class="nf">paginate_string</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">IteratorT</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">char_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="n">line_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">wrapper</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IteratorT</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Lazily paginate an iterator of lines.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lines : typing.union[typing.AsyncIterator[builtins.str], typing.Iterator[builtins.str]]</span>
<span class="sd">        The iterator of lines to paginate. This iterator may be asynchronous or synchronous.</span>
<span class="sd">    char_limit : builtins.int</span>
<span class="sd">        The limit for how many characters should be included per yielded page.</span>
<span class="sd">        This defaults to 2000</span>
<span class="sd">    line_limit : builtins.int</span>
<span class="sd">        The limit for how many lines should be included per yielded page.</span>
<span class="sd">        This defaults to 25.</span>
<span class="sd">    wrapper : typing.Optional[builtins.str]</span>
<span class="sd">        A wrapper for each yielded page. This should leave &quot;{}&quot; in it</span>
<span class="sd">        to be replaced by the page&#39;s content.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    typing.Union[AsyncIterator[typing.Tuple[builtins.str, builtins.int]], typing.Iterator[typing.Tuple[builtins.str, builtins.int]]]</span>
<span class="sd">        An iterator of page tuples (string context to int zero-based index).</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501  - line too long</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">async_paginate_string</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">char_limit</span><span class="o">=</span><span class="n">char_limit</span><span class="p">,</span> <span class="n">line_limit</span><span class="o">=</span><span class="n">line_limit</span><span class="p">,</span> <span class="n">wrapper</span><span class="o">=</span><span class="n">wrapper</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sync_paginate_string</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">char_limit</span><span class="o">=</span><span class="n">char_limit</span><span class="p">,</span> <span class="n">line_limit</span><span class="o">=</span><span class="n">line_limit</span><span class="p">,</span> <span class="n">wrapper</span><span class="o">=</span><span class="n">wrapper</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Utilities used for quick pagination handling within reaction and component executors.</p>
</div>


                </section>
                <section id="async_paginate_string">
                            <div class="attr function"><a class="headerlink" href="#async_paginate_string">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">async_paginate_string</span><span class="signature">(
    lines: AsyncIterator[str],
    *,
    char_limit: int = 2000,
    line_limit: int = 25,
    wrapper: Optional[str] = None
) -&gt; AsyncIterator[Tuple[str, int]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">async_paginate_string</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">char_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="n">line_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">wrapper</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Lazily paginate an iterator of lines.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lines : typing.AsyncIterator[builtins.str]</span>
<span class="sd">        The asynchronous iterator of lines to paginate.</span>
<span class="sd">    char_limit : builtins.int</span>
<span class="sd">        The limit for how many characters should be included per yielded page.</span>
<span class="sd">        This defaults to 2000</span>
<span class="sd">    line_limit : builtins.int</span>
<span class="sd">        The limit for how many lines should be included per yielded page.</span>
<span class="sd">        This defaults to 25.</span>
<span class="sd">    wrapper : typing.Optional[builtins.str]</span>
<span class="sd">        A wrapper for each yielded page. This should leave &quot;{}&quot; in it</span>
<span class="sd">        to be replaced by the page&#39;s content.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    typing.AsyncIterator[typing.Tuple[builtins.str, builtins.int]]</span>
<span class="sd">        An async iterator of page tuples (string context to int zero-based index).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">wrapper</span><span class="p">:</span>
        <span class="n">char_limit</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

    <span class="c1"># As this is incremented before yielding and zero-index we have to start at -1.</span>
    <span class="n">page_number</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">page_size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">page</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">line</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">seek_async_iterator</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If the page is already populated and adding the current line would bring it over one of the predefined limits</span>
        <span class="c1"># then we want to yield this page.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">page</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">line_limit</span> <span class="ow">or</span> <span class="n">page</span> <span class="ow">and</span> <span class="n">page_size</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">char_limit</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">))</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">),</span> <span class="p">(</span><span class="n">page_number</span> <span class="o">:=</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">page</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">page_size</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># If the current line doesn&#39;t fit into a page then we need to split it up into sub-pages to yield and can</span>
        <span class="c1"># assume the previous page was yielded.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">char_limit</span><span class="p">:</span>
            <span class="n">sub_pages</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span>
                <span class="n">line</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">char_limit</span><span class="p">,</span> <span class="n">drop_whitespace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">break_on_hyphens</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">expand_tabs</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

            <span class="c1"># If the last page could possible fit into a page with other lines then we add it to the next page</span>
            <span class="c1"># to avoid sending small terraced pages.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_pages</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">char_limit</span><span class="p">:</span>
                <span class="n">sub_line</span> <span class="o">=</span> <span class="n">sub_pages</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">page_size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_line</span><span class="p">)</span>
                <span class="n">page</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_line</span><span class="p">)</span>

            <span class="c1"># yield all the sub-lines at once.</span>
            <span class="k">for</span> <span class="n">sub_line</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">sub_pages</span><span class="p">)</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="n">sub_pages</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">sub_line</span><span class="p">,</span> <span class="p">(</span><span class="n">page_number</span> <span class="o">:=</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Otherwise it should be added to the next page.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">page_size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">page</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="c1"># This catches the likely dangling page after iteration ends.</span>
    <span class="k">if</span> <span class="n">page</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">))</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">),</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>

        </details>

            <div class="docstring"><p>Lazily paginate an iterator of lines.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lines</strong> (typing.AsyncIterator[builtins.str]):
The asynchronous iterator of lines to paginate.</li>
<li><strong>char_limit</strong> (builtins.int):
The limit for how many characters should be included per yielded page.
This defaults to 2000</li>
<li><strong>line_limit</strong> (builtins.int):
The limit for how many lines should be included per yielded page.
This defaults to 25.</li>
<li><strong>wrapper</strong> (typing.Optional[builtins.str]):
A wrapper for each yielded page. This should leave "{}" in it
to be replaced by the page's content.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.AsyncIterator[typing.Tuple[builtins.str, builtins.int]]</strong>: An async iterator of page tuples (string context to int zero-based index).</li>
</ul>
</div>


                </section>
                <section id="sync_paginate_string">
                            <div class="attr function"><a class="headerlink" href="#sync_paginate_string">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sync_paginate_string</span><span class="signature">(
    lines: Iterator[str],
    *,
    char_limit: int = 2000,
    line_limit: int = 25,
    wrapper: Optional[str] = None
) -&gt; Iterator[Tuple[str, int]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sync_paginate_string</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">char_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="n">line_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">wrapper</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Lazily paginate an iterator of lines.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lines : typing.Iterator[builtins.str]</span>
<span class="sd">        The iterator of lines to paginate.</span>
<span class="sd">    char_limit : builtins.int</span>
<span class="sd">        The limit for how many characters should be included per yielded page.</span>
<span class="sd">        This defaults to 2000</span>
<span class="sd">    line_limit : builtins.int</span>
<span class="sd">        The limit for how many lines should be included per yielded page.</span>
<span class="sd">        This defaults to 25.</span>
<span class="sd">    wrapper : typing.Optional[builtins.str]</span>
<span class="sd">        A wrapper for each yielded page. This should leave &quot;{}&quot; in it</span>
<span class="sd">        to be replaced by the page&#39;s content.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    typing.Iterator[typing.Tuple[builtins.str, builtins.int]]</span>
<span class="sd">        An iterator of page tuples (string context to int zero-based index).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">wrapper</span><span class="p">:</span>
        <span class="n">char_limit</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

    <span class="c1"># As this is incremented before yielding and zero-index we have to start at -1.</span>
    <span class="n">page_number</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">page_size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">page</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">line</span> <span class="o">:=</span> <span class="n">seek_sync_iterator</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If the page is already populated and adding the current line would bring it over one of the predefined limits</span>
        <span class="c1"># then we want to yield this page.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">page</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">line_limit</span> <span class="ow">or</span> <span class="n">page</span> <span class="ow">and</span> <span class="n">page_size</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">char_limit</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">))</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">),</span> <span class="p">(</span><span class="n">page_number</span> <span class="o">:=</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">page</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">page_size</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># If the current line doesn&#39;t fit into a page then we need to split it up into sub-pages to yield and can</span>
        <span class="c1"># assume the previous page was yielded.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">char_limit</span><span class="p">:</span>
            <span class="n">sub_pages</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span>
                <span class="n">line</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">char_limit</span><span class="p">,</span> <span class="n">drop_whitespace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">break_on_hyphens</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">expand_tabs</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

            <span class="c1"># If the last page could possible fit into a page with other lines then we add it to the next page</span>
            <span class="c1"># to avoid sending small terraced pages.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_pages</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">char_limit</span><span class="p">:</span>
                <span class="n">sub_line</span> <span class="o">=</span> <span class="n">sub_pages</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">page_size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_line</span><span class="p">)</span>
                <span class="n">page</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_line</span><span class="p">)</span>

            <span class="c1"># yield all the sub-lines at once.</span>
            <span class="k">for</span> <span class="n">sub_line</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">sub_pages</span><span class="p">)</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="n">sub_pages</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">sub_line</span><span class="p">,</span> <span class="p">(</span><span class="n">page_number</span> <span class="o">:=</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Otherwise it should be added to the next page.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">page_size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">page</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="c1"># This catches the likely dangling page after iteration ends.</span>
    <span class="k">if</span> <span class="n">page</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">))</span> <span class="k">if</span> <span class="n">wrapper</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">page</span><span class="p">),</span> <span class="n">page_number</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>

        </details>

            <div class="docstring"><p>Lazily paginate an iterator of lines.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lines</strong> (typing.Iterator[builtins.str]):
The iterator of lines to paginate.</li>
<li><strong>char_limit</strong> (builtins.int):
The limit for how many characters should be included per yielded page.
This defaults to 2000</li>
<li><strong>line_limit</strong> (builtins.int):
The limit for how many lines should be included per yielded page.
This defaults to 25.</li>
<li><strong>wrapper</strong> (typing.Optional[builtins.str]):
A wrapper for each yielded page. This should leave "{}" in it
to be replaced by the page's content.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Iterator[typing.Tuple[builtins.str, builtins.int]]</strong>: An iterator of page tuples (string context to int zero-based index).</li>
</ul>
</div>


                </section>
                <section id="paginate_string">
                            <div class="attr function"><a class="headerlink" href="#paginate_string">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">paginate_string</span><span class="signature">(
    lines: Union[AsyncIterator[str], Iterator[str]],
    *,
    char_limit: int = 2000,
    line_limit: int = 25,
    wrapper: Optional[str] = None
) -&gt; Union[AsyncIterator[Tuple[str, int]], Iterator[Tuple[str, int]]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">paginate_string</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">:</span> <span class="n">IteratorT</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">char_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="n">line_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">wrapper</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IteratorT</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Lazily paginate an iterator of lines.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lines : typing.union[typing.AsyncIterator[builtins.str], typing.Iterator[builtins.str]]</span>
<span class="sd">        The iterator of lines to paginate. This iterator may be asynchronous or synchronous.</span>
<span class="sd">    char_limit : builtins.int</span>
<span class="sd">        The limit for how many characters should be included per yielded page.</span>
<span class="sd">        This defaults to 2000</span>
<span class="sd">    line_limit : builtins.int</span>
<span class="sd">        The limit for how many lines should be included per yielded page.</span>
<span class="sd">        This defaults to 25.</span>
<span class="sd">    wrapper : typing.Optional[builtins.str]</span>
<span class="sd">        A wrapper for each yielded page. This should leave &quot;{}&quot; in it</span>
<span class="sd">        to be replaced by the page&#39;s content.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    typing.Union[AsyncIterator[typing.Tuple[builtins.str, builtins.int]], typing.Iterator[typing.Tuple[builtins.str, builtins.int]]]</span>
<span class="sd">        An iterator of page tuples (string context to int zero-based index).</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501  - line too long</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">async_paginate_string</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">char_limit</span><span class="o">=</span><span class="n">char_limit</span><span class="p">,</span> <span class="n">line_limit</span><span class="o">=</span><span class="n">line_limit</span><span class="p">,</span> <span class="n">wrapper</span><span class="o">=</span><span class="n">wrapper</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sync_paginate_string</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">char_limit</span><span class="o">=</span><span class="n">char_limit</span><span class="p">,</span> <span class="n">line_limit</span><span class="o">=</span><span class="n">line_limit</span><span class="p">,</span> <span class="n">wrapper</span><span class="o">=</span><span class="n">wrapper</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Lazily paginate an iterator of lines.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lines</strong> (typing.union[typing.AsyncIterator[builtins.str], typing.Iterator[builtins.str]]):
The iterator of lines to paginate. This iterator may be asynchronous or synchronous.</li>
<li><strong>char_limit</strong> (builtins.int):
The limit for how many characters should be included per yielded page.
This defaults to 2000</li>
<li><strong>line_limit</strong> (builtins.int):
The limit for how many lines should be included per yielded page.
This defaults to 25.</li>
<li><strong>wrapper</strong> (typing.Optional[builtins.str]):
A wrapper for each yielded page. This should leave "{}" in it
to be replaced by the page's content.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Union[AsyncIterator[typing.Tuple[builtins.str, builtins.int]], typing.Iterator[typing.Tuple[builtins.str, builtins.int]]]</strong>: An iterator of page tuples (string context to int zero-based index).</li>
</ul>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">(${doc.parameters.join(", ")})</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>